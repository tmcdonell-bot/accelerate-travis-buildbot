<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE BangPatterns, ScopedTypeVariables #-}</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- Module    : Statistics.Distribution</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- Copyright : (c) 2009 Bryan O'Sullivan</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- License   : BSD3</span><span>
</span><a name="line-7"></a><span class="hs-comment">--</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Maintainer  : bos@serpentine.com</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Stability   : experimental</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Portability : portable</span><span>
</span><a name="line-11"></a><span class="hs-comment">--</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- Type classes for probability distributions</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Statistics</span><span class="hs-operator">.</span><span class="hs-identifier">Distribution</span><span>
</span><a name="line-15"></a><span>    </span><span class="hs-special">(</span><span>
</span><a name="line-16"></a><span>      </span><span class="hs-comment">-- * Type classes</span><span>
</span><a name="line-17"></a><span>      </span><a href="Statistics.Distribution.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Statistics.Distribution.html#DiscreteDistr"><span class="hs-identifier hs-type">DiscreteDistr</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Statistics.Distribution.html#ContDistr"><span class="hs-identifier hs-type">ContDistr</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span>      </span><span class="hs-comment">-- ** Distribution statistics</span><span>
</span><a name="line-21"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Statistics.Distribution.html#MaybeMean"><span class="hs-identifier hs-type">MaybeMean</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Statistics.Distribution.html#Mean"><span class="hs-identifier hs-type">Mean</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Statistics.Distribution.html#MaybeVariance"><span class="hs-identifier hs-type">MaybeVariance</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Statistics.Distribution.html#Variance"><span class="hs-identifier hs-type">Variance</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Statistics.Distribution.html#MaybeEntropy"><span class="hs-identifier hs-type">MaybeEntropy</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Statistics.Distribution.html#Entropy"><span class="hs-identifier hs-type">Entropy</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Statistics.Distribution.html#FromSample"><span class="hs-identifier hs-type">FromSample</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span>      </span><span class="hs-comment">-- ** Random number generation</span><span>
</span><a name="line-29"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Statistics.Distribution.html#ContGen"><span class="hs-identifier hs-type">ContGen</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Statistics.Distribution.html#DiscreteGen"><span class="hs-identifier hs-type">DiscreteGen</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Statistics.Distribution.html#genContinuous"><span class="hs-identifier hs-var">genContinuous</span></a><span>
</span><a name="line-32"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Statistics.Distribution.html#genContinous"><span class="hs-identifier hs-var">genContinous</span></a><span>
</span><a name="line-33"></a><span>      </span><span class="hs-comment">-- * Helper functions</span><span>
</span><a name="line-34"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Statistics.Distribution.html#findRoot"><span class="hs-identifier hs-var">findRoot</span></a><span>
</span><a name="line-35"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Statistics.Distribution.html#sumProbabilities"><span class="hs-identifier hs-var">sumProbabilities</span></a><span>
</span><a name="line-36"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Primitive</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">PrimMonad</span><span class="hs-special">,</span><span class="hs-identifier hs-type">PrimState</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sum</span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><a href="Statistics.Function.html"><span class="hs-identifier">Statistics</span><span class="hs-operator">.</span><span class="hs-identifier">Function</span></a><span> </span><span class="hs-special">(</span><a href="Statistics.Function.html#square"><span class="hs-identifier hs-var">square</span></a><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span> </span><a href="Statistics.Sample.Internal.html"><span class="hs-identifier">Statistics</span><span class="hs-operator">.</span><span class="hs-identifier">Sample</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span></a><span> </span><span class="hs-special">(</span><a href="Statistics.Sample.Internal.html#sum"><span class="hs-identifier hs-var">sum</span></a><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Random</span><span class="hs-operator">.</span><span class="hs-identifier">MWC</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Gen</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">uniform</span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Vector</span><span class="hs-operator">.</span><span class="hs-identifier">Unboxed</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">U</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Vector</span><span class="hs-operator">.</span><span class="hs-identifier">Generic</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">G</span><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-comment">-- | Type class common to all distributions. Only c.d.f. could be</span><span>
</span><a name="line-49"></a><span class="hs-comment">-- defined for both discrete and continuous distributions.</span><span>
</span><a name="line-50"></a><span class="hs-keyword">class</span><span> </span><a name="Distribution"><a href="Statistics.Distribution.html#Distribution"><span class="hs-identifier">Distribution</span></a></a><span> </span><a name="local-6989586621679170391"><a href="#local-6989586621679170391"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-51"></a><span>    </span><span class="hs-comment">-- | Cumulative distribution function.  The probability that a</span><span>
</span><a name="line-52"></a><span>    </span><span class="hs-comment">-- random variable /X/ is less or equal than /x/,</span><span>
</span><a name="line-53"></a><span>    </span><span class="hs-comment">-- i.e. P(/X/&amp;#8804;/x/). Cumulative should be defined for</span><span>
</span><a name="line-54"></a><span>    </span><span class="hs-comment">-- infinities as well:</span><span>
</span><a name="line-55"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-56"></a><span>    </span><span class="hs-comment">-- &gt; cumulative d +&#8734; = 1</span><span>
</span><a name="line-57"></a><span>    </span><span class="hs-comment">-- &gt; cumulative d -&#8734; = 0</span><span>
</span><a name="line-58"></a><span>    </span><span class="hs-identifier">cumulative</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679170391"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span>    </span><span class="hs-comment">-- | One's complement of cumulative distibution:</span><span>
</span><a name="line-61"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-62"></a><span>    </span><span class="hs-comment">-- &gt; complCumulative d x = 1 - cumulative d x</span><span>
</span><a name="line-63"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-64"></a><span>    </span><span class="hs-comment">-- It's useful when one is interested in P(/X/&gt;/x/) and</span><span>
</span><a name="line-65"></a><span>    </span><span class="hs-comment">-- expression on the right side begin to lose precision. This</span><span>
</span><a name="line-66"></a><span>    </span><span class="hs-comment">-- function have default implementation but implementors are</span><span>
</span><a name="line-67"></a><span>    </span><span class="hs-comment">-- encouraged to provide more precise implementation.</span><span>
</span><a name="line-68"></a><span>    </span><span class="hs-identifier">complCumulative</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679170391"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-69"></a><span>    </span><a name="local-8214565720323945273"><a href="Statistics.Distribution.html#complCumulative"><span class="hs-identifier">complCumulative</span></a></a><span> </span><a name="local-6989586621679170392"><a href="#local-6989586621679170392"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679170393"><a href="#local-6989586621679170393"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="Statistics.Distribution.html#cumulative"><span class="hs-identifier hs-var">cumulative</span></a><span> </span><a href="#local-6989586621679170392"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679170393"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-comment">-- | Discrete probability distribution.</span><span>
</span><a name="line-72"></a><span class="hs-keyword">class</span><span> </span><a href="Statistics.Distribution.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a><span>  </span><a href="#local-6989586621679170388"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="DiscreteDistr"><a href="Statistics.Distribution.html#DiscreteDistr"><span class="hs-identifier">DiscreteDistr</span></a></a><span> </span><a name="local-6989586621679170388"><a href="#local-6989586621679170388"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-73"></a><span>    </span><span class="hs-comment">-- | Probability of n-th outcome.</span><span>
</span><a name="line-74"></a><span>    </span><span class="hs-identifier">probability</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679170388"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-75"></a><span>    </span><a name="local-8214565720323945269"><a href="Statistics.Distribution.html#probability"><span class="hs-identifier">probability</span></a></a><span> </span><a name="local-6989586621679170389"><a href="#local-6989586621679170389"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">exp</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Statistics.Distribution.html#logProbability"><span class="hs-identifier hs-var">logProbability</span></a><span> </span><a href="#local-6989586621679170389"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span>    </span><span class="hs-comment">-- | Logarithm of probability of n-th outcome</span><span>
</span><a name="line-78"></a><span>    </span><span class="hs-identifier">logProbability</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679170388"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-79"></a><span>    </span><a name="local-8214565720323945270"><a href="Statistics.Distribution.html#logProbability"><span class="hs-identifier">logProbability</span></a></a><span> </span><a name="local-6989586621679170390"><a href="#local-6989586621679170390"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">log</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Statistics.Distribution.html#probability"><span class="hs-identifier hs-var">probability</span></a><span> </span><a href="#local-6989586621679170390"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-comment">-- | Continuous probability distributuion.</span><span>
</span><a name="line-83"></a><span class="hs-comment">--</span><span>
</span><a name="line-84"></a><span class="hs-comment">--   Minimal complete definition is 'quantile' and either 'density' or</span><span>
</span><a name="line-85"></a><span class="hs-comment">--   'logDensity'.</span><span>
</span><a name="line-86"></a><span class="hs-keyword">class</span><span> </span><a href="Statistics.Distribution.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a><span> </span><a href="#local-6989586621679170383"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="ContDistr"><a href="Statistics.Distribution.html#ContDistr"><span class="hs-identifier">ContDistr</span></a></a><span> </span><a name="local-6989586621679170383"><a href="#local-6989586621679170383"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-87"></a><span>    </span><span class="hs-comment">-- | Probability density function. Probability that random</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-comment">-- variable /X/ lies in the infinitesimal interval</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-comment">-- [/x/,/x+/&amp;#948;/x/) equal to /density(x)/&amp;#8901;&amp;#948;/x/</span><span>
</span><a name="line-90"></a><span>    </span><span class="hs-identifier">density</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679170383"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-91"></a><span>    </span><a name="local-8214565720323945264"><a href="Statistics.Distribution.html#density"><span class="hs-identifier">density</span></a></a><span> </span><a name="local-6989586621679170384"><a href="#local-6989586621679170384"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">exp</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Statistics.Distribution.html#logDensity"><span class="hs-identifier hs-var">logDensity</span></a><span> </span><a href="#local-6989586621679170384"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span>    </span><span class="hs-comment">-- | Inverse of the cumulative distribution function. The value</span><span>
</span><a name="line-94"></a><span>    </span><span class="hs-comment">-- /x/ for which P(/X/&amp;#8804;/x/) = /p/. If probability is outside</span><span>
</span><a name="line-95"></a><span>    </span><span class="hs-comment">-- of [0,1] range function should call 'error'</span><span>
</span><a name="line-96"></a><span>    </span><span class="hs-identifier">quantile</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679170383"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span>    </span><span class="hs-comment">-- | 1-complement of @quantile@:</span><span>
</span><a name="line-99"></a><span>    </span><span class="hs-comment">--</span><span>
</span><a name="line-100"></a><span>    </span><span class="hs-comment">-- &gt; complQuantile x &#8801; quantile (1 - x)</span><span>
</span><a name="line-101"></a><span>    </span><span class="hs-identifier">complQuantile</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679170383"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-102"></a><span>    </span><a name="local-8214565720323945266"><a href="Statistics.Distribution.html#complQuantile"><span class="hs-identifier">complQuantile</span></a></a><span> </span><a name="local-6989586621679170385"><a href="#local-6989586621679170385"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679170386"><a href="#local-6989586621679170386"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Statistics.Distribution.html#quantile"><span class="hs-identifier hs-var">quantile</span></a><span> </span><a href="#local-6989586621679170385"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679170386"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span>    </span><span class="hs-comment">-- | Natural logarithm of density.</span><span>
</span><a name="line-105"></a><span>    </span><span class="hs-identifier">logDensity</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679170383"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-106"></a><span>    </span><a name="local-8214565720323945267"><a href="Statistics.Distribution.html#logDensity"><span class="hs-identifier">logDensity</span></a></a><span> </span><a name="local-6989586621679170387"><a href="#local-6989586621679170387"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">log</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Statistics.Distribution.html#density"><span class="hs-identifier hs-var">density</span></a><span> </span><a href="#local-6989586621679170387"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-107"></a><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span class="hs-comment">-- | Type class for distributions with mean. 'maybeMean' should return</span><span>
</span><a name="line-110"></a><span class="hs-comment">--   'Nothing' if it's undefined for current value of data</span><span>
</span><a name="line-111"></a><span class="hs-keyword">class</span><span> </span><a href="Statistics.Distribution.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a><span> </span><a href="#local-6989586621679170382"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="MaybeMean"><a href="Statistics.Distribution.html#MaybeMean"><span class="hs-identifier">MaybeMean</span></a></a><span> </span><a name="local-6989586621679170382"><a href="#local-6989586621679170382"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-112"></a><span>    </span><span class="hs-identifier">maybeMean</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679170382"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-comment">-- | Type class for distributions with mean. If distribution have</span><span>
</span><a name="line-115"></a><span class="hs-comment">--   finite mean for all valid values of parameters it should be</span><span>
</span><a name="line-116"></a><span class="hs-comment">--   instance of this type class.</span><span>
</span><a name="line-117"></a><span class="hs-keyword">class</span><span> </span><a href="Statistics.Distribution.html#MaybeMean"><span class="hs-identifier hs-type">MaybeMean</span></a><span> </span><a href="#local-6989586621679170381"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="Mean"><a href="Statistics.Distribution.html#Mean"><span class="hs-identifier">Mean</span></a></a><span> </span><a name="local-6989586621679170381"><a href="#local-6989586621679170381"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-118"></a><span>    </span><span class="hs-identifier">mean</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679170381"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-comment">-- | Type class for distributions with variance. If variance is</span><span>
</span><a name="line-123"></a><span class="hs-comment">--   undefined for some parameter values both 'maybeVariance' and</span><span>
</span><a name="line-124"></a><span class="hs-comment">--   'maybeStdDev' should return Nothing.</span><span>
</span><a name="line-125"></a><span class="hs-comment">--</span><span>
</span><a name="line-126"></a><span class="hs-comment">--   Minimal complete definition is 'maybeVariance' or 'maybeStdDev'</span><span>
</span><a name="line-127"></a><span class="hs-keyword">class</span><span> </span><a href="Statistics.Distribution.html#MaybeMean"><span class="hs-identifier hs-type">MaybeMean</span></a><span> </span><a href="#local-6989586621679170378"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="MaybeVariance"><a href="Statistics.Distribution.html#MaybeVariance"><span class="hs-identifier">MaybeVariance</span></a></a><span> </span><a name="local-6989586621679170378"><a href="#local-6989586621679170378"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-128"></a><span>    </span><span class="hs-identifier">maybeVariance</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679170378"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-129"></a><span>    </span><a name="local-8214565720323945257"><a href="Statistics.Distribution.html#maybeVariance"><span class="hs-identifier">maybeVariance</span></a></a><span> </span><a name="local-6989586621679170379"><a href="#local-6989586621679170379"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679170380"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679170380"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679170380"><a href="#local-6989586621679170380"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Statistics.Distribution.html#maybeStdDev"><span class="hs-identifier hs-var">maybeStdDev</span></a><span> </span><a href="#local-6989586621679170379"><span class="hs-identifier hs-var">d</span></a><span>
</span><a name="line-130"></a><span>    </span><span class="hs-identifier">maybeStdDev</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679170378"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-131"></a><span>    </span><a name="local-8214565720323945258"><a href="Statistics.Distribution.html#maybeStdDev"><span class="hs-identifier">maybeStdDev</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Statistics.Distribution.html#maybeVariance"><span class="hs-identifier hs-var">maybeVariance</span></a><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-comment">-- | Type class for distributions with variance. If distibution have</span><span>
</span><a name="line-134"></a><span class="hs-comment">--   finite variance for all valid parameter values it should be</span><span>
</span><a name="line-135"></a><span class="hs-comment">--   instance of this type class.</span><span>
</span><a name="line-136"></a><span class="hs-comment">--</span><span>
</span><a name="line-137"></a><span class="hs-comment">--   Minimal complete definition is 'variance' or 'stdDev'</span><span>
</span><a name="line-138"></a><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><a href="Statistics.Distribution.html#Mean"><span class="hs-identifier hs-type">Mean</span></a><span> </span><a href="#local-6989586621679170376"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><span> </span><a href="Statistics.Distribution.html#MaybeVariance"><span class="hs-identifier hs-type">MaybeVariance</span></a><span> </span><a href="#local-6989586621679170376"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="Variance"><a href="Statistics.Distribution.html#Variance"><span class="hs-identifier">Variance</span></a></a><span> </span><a name="local-6989586621679170376"><a href="#local-6989586621679170376"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-139"></a><span>    </span><span class="hs-identifier">variance</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679170376"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-140"></a><span>    </span><a name="local-8214565720323945254"><a href="Statistics.Distribution.html#variance"><span class="hs-identifier">variance</span></a></a><span> </span><a name="local-6989586621679170377"><a href="#local-6989586621679170377"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Statistics.Function.html#square"><span class="hs-identifier hs-var">square</span></a><span> </span><span class="hs-special">(</span><a href="Statistics.Distribution.html#stdDev"><span class="hs-identifier hs-var">stdDev</span></a><span> </span><a href="#local-6989586621679170377"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-141"></a><span>    </span><span class="hs-identifier">stdDev</span><span>   </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679170376"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-142"></a><span>    </span><a name="local-8214565720323945255"><a href="Statistics.Distribution.html#stdDev"><span class="hs-identifier">stdDev</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Statistics.Distribution.html#variance"><span class="hs-identifier hs-var">variance</span></a><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-comment">-- | Type class for distributions with entropy, meaning Shannon entropy</span><span>
</span><a name="line-145"></a><span class="hs-comment">--   in the case of a discrete distribution, or differential entropy in the</span><span>
</span><a name="line-146"></a><span class="hs-comment">--   case of a continuous one.  'maybeEntropy' should return 'Nothing' if</span><span>
</span><a name="line-147"></a><span class="hs-comment">--   entropy is undefined for the chosen parameter values.</span><span>
</span><a name="line-148"></a><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><a href="Statistics.Distribution.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a><span> </span><a href="#local-6989586621679170375"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="MaybeEntropy"><a href="Statistics.Distribution.html#MaybeEntropy"><span class="hs-identifier">MaybeEntropy</span></a></a><span> </span><a name="local-6989586621679170375"><a href="#local-6989586621679170375"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-149"></a><span>  </span><span class="hs-comment">-- | Returns the entropy of a distribution, in nats, if such is defined.</span><span>
</span><a name="line-150"></a><span>  </span><span class="hs-identifier">maybeEntropy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679170375"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-comment">-- | Type class for distributions with entropy, meaning Shannon</span><span>
</span><a name="line-153"></a><span class="hs-comment">--   entropy in the case of a discrete distribution, or differential</span><span>
</span><a name="line-154"></a><span class="hs-comment">--   entropy in the case of a continuous one.  If the distribution has</span><span>
</span><a name="line-155"></a><span class="hs-comment">--   well-defined entropy for all valid parameter values then it</span><span>
</span><a name="line-156"></a><span class="hs-comment">--   should be an instance of this type class.</span><span>
</span><a name="line-157"></a><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><a href="Statistics.Distribution.html#MaybeEntropy"><span class="hs-identifier hs-type">MaybeEntropy</span></a><span> </span><a href="#local-6989586621679170374"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="Entropy"><a href="Statistics.Distribution.html#Entropy"><span class="hs-identifier">Entropy</span></a></a><span> </span><a name="local-6989586621679170374"><a href="#local-6989586621679170374"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-158"></a><span>  </span><span class="hs-comment">-- | Returns the entropy of a distribution, in nats.</span><span>
</span><a name="line-159"></a><span>  </span><span class="hs-identifier">entropy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679170374"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-160"></a><span>
</span><a name="line-161"></a><span class="hs-comment">-- | Generate discrete random variates which have given</span><span>
</span><a name="line-162"></a><span class="hs-comment">--   distribution.</span><span>
</span><a name="line-163"></a><span class="hs-keyword">class</span><span> </span><a href="Statistics.Distribution.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a><span> </span><a href="#local-6989586621679170372"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="ContGen"><a href="Statistics.Distribution.html#ContGen"><span class="hs-identifier">ContGen</span></a></a><span> </span><a name="local-6989586621679170372"><a href="#local-6989586621679170372"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-164"></a><span>  </span><span class="hs-identifier">genContVar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">PrimMonad</span><span> </span><a href="#local-6989586621679170373"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679170372"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Gen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">PrimState</span><span> </span><a href="#local-6989586621679170373"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679170373"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span class="hs-comment">-- | Generate discrete random variates which have given</span><span>
</span><a name="line-167"></a><span class="hs-comment">--   distribution. 'ContGen' is superclass because it's always possible</span><span>
</span><a name="line-168"></a><span class="hs-comment">--   to generate real-valued variates from integer values</span><span>
</span><a name="line-169"></a><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><a href="Statistics.Distribution.html#DiscreteDistr"><span class="hs-identifier hs-type">DiscreteDistr</span></a><span> </span><a href="#local-6989586621679170370"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><span> </span><a href="Statistics.Distribution.html#ContGen"><span class="hs-identifier hs-type">ContGen</span></a><span> </span><a href="#local-6989586621679170370"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="DiscreteGen"><a href="Statistics.Distribution.html#DiscreteGen"><span class="hs-identifier">DiscreteGen</span></a></a><span> </span><a name="local-6989586621679170370"><a href="#local-6989586621679170370"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-170"></a><span>  </span><span class="hs-identifier">genDiscreteVar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">PrimMonad</span><span> </span><a href="#local-6989586621679170371"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679170370"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Gen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">PrimState</span><span> </span><a href="#local-6989586621679170371"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679170371"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-comment">-- | Estimate distribution from sample. First parameter in sample is</span><span>
</span><a name="line-173"></a><span class="hs-comment">--   distribution type and second is element type.</span><span>
</span><a name="line-174"></a><span class="hs-keyword">class</span><span> </span><a name="FromSample"><a href="Statistics.Distribution.html#FromSample"><span class="hs-identifier">FromSample</span></a></a><span> </span><a name="local-6989586621679170367"><a href="#local-6989586621679170367"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679170368"><a href="#local-6989586621679170368"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-175"></a><span>  </span><span class="hs-comment">-- | Estimate distribution from sample. Returns nothing is there's</span><span>
</span><a name="line-176"></a><span>  </span><span class="hs-comment">--   not enough data to estimate or sample clearly doesn't come from</span><span>
</span><a name="line-177"></a><span>  </span><span class="hs-comment">--   distribution in question. For example if there's negative</span><span>
</span><a name="line-178"></a><span>  </span><span class="hs-comment">--   samples in exponential distribution.</span><span>
</span><a name="line-179"></a><span>  </span><span class="hs-identifier">fromSample</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">G</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-6989586621679170369"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679170368"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679170369"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679170368"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679170367"><span class="hs-identifier hs-type">d</span></a><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span class="hs-comment">-- | Generate variates from continuous distribution using inverse</span><span>
</span><a name="line-183"></a><span class="hs-comment">--   transform rule.</span><span>
</span><a name="line-184"></a><span class="hs-identifier">genContinuous</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Statistics.Distribution.html#ContDistr"><span class="hs-identifier hs-type">ContDistr</span></a><span> </span><a href="#local-6989586621679170398"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PrimMonad</span><span> </span><a href="#local-6989586621679170399"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679170398"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Gen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">PrimState</span><span> </span><a href="#local-6989586621679170399"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679170399"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-185"></a><a name="genContinuous"><a href="Statistics.Distribution.html#genContinuous"><span class="hs-identifier">genContinuous</span></a></a><span> </span><a name="local-6989586621679170400"><a href="#local-6989586621679170400"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679170401"><a href="#local-6989586621679170401"><span class="hs-identifier">gen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-186"></a><span>  </span><a name="local-6989586621679170402"><a href="#local-6989586621679170402"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">uniform</span><span> </span><a href="#local-6989586621679170401"><span class="hs-identifier hs-var">gen</span></a><span>
</span><a name="line-187"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="Statistics.Distribution.html#quantile"><span class="hs-identifier hs-var">quantile</span></a><span> </span><a href="#local-6989586621679170400"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679170402"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-comment">-- | Backwards compatibility with genContinuous.</span><span>
</span><a name="line-190"></a><span class="hs-identifier">genContinous</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Statistics.Distribution.html#ContDistr"><span class="hs-identifier hs-type">ContDistr</span></a><span> </span><a href="#local-6989586621679170396"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">PrimMonad</span><span> </span><a href="#local-6989586621679170397"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679170396"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Gen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">PrimState</span><span> </span><a href="#local-6989586621679170397"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679170397"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-191"></a><a name="genContinous"><a href="Statistics.Distribution.html#genContinous"><span class="hs-identifier">genContinous</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Statistics.Distribution.html#genContinuous"><span class="hs-identifier hs-var">genContinuous</span></a><span>
</span><a name="line-192"></a><span class="hs-pragma">{-# DEPRECATED genContinous &quot;Use genContinuous&quot; #-}</span><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span class="hs-keyword">data</span><span> </span><a name="P"><a href="Statistics.Distribution.html#P"><span class="hs-identifier">P</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="P"><a href="Statistics.Distribution.html#P"><span class="hs-identifier">P</span></a></a><span> </span><span class="hs-pragma">{-# UNPACK #-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-pragma">{-# UNPACK #-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-comment">-- | Approximate the value of /X/ for which P(/x/&gt;/X/)=/p/.</span><span>
</span><a name="line-197"></a><span class="hs-comment">--</span><span>
</span><a name="line-198"></a><span class="hs-comment">-- This method uses a combination of Newton-Raphson iteration and</span><span>
</span><a name="line-199"></a><span class="hs-comment">-- bisection with the given guess as a starting point.  The upper and</span><span>
</span><a name="line-200"></a><span class="hs-comment">-- lower bounds specify the interval in which the probability</span><span>
</span><a name="line-201"></a><span class="hs-comment">-- distribution reaches the value /p/.</span><span>
</span><a name="line-202"></a><span class="hs-identifier">findRoot</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Statistics.Distribution.html#ContDistr"><span class="hs-identifier hs-type">ContDistr</span></a><span> </span><a href="#local-6989586621679170395"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-203"></a><span>            </span><a href="#local-6989586621679170395"><span class="hs-identifier hs-type">d</span></a><span>                   </span><span class="hs-comment">-- ^ Distribution</span><span>
</span><a name="line-204"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>              </span><span class="hs-comment">-- ^ Probability /p/</span><span>
</span><a name="line-205"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>              </span><span class="hs-comment">-- ^ Initial guess</span><span>
</span><a name="line-206"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>              </span><span class="hs-comment">-- ^ Lower bound on interval</span><span>
</span><a name="line-207"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>              </span><span class="hs-comment">-- ^ Upper bound on interval</span><span>
</span><a name="line-208"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-209"></a><a name="findRoot"><a href="Statistics.Distribution.html#findRoot"><span class="hs-identifier">findRoot</span></a></a><span> </span><a name="local-6989586621679170403"><a href="#local-6989586621679170403"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679170404"><a href="#local-6989586621679170404"><span class="hs-identifier">prob</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679170405"><span class="hs-identifier hs-var">loop</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-210"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-211"></a><span>    </span><a name="local-6989586621679170405"><a href="#local-6989586621679170405"><span class="hs-identifier">loop</span></a></a><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a name="local-6989586621679170408"><a href="#local-6989586621679170408"><span class="hs-identifier">i</span></a></a><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679170409"><a href="#local-6989586621679170409"><span class="hs-identifier">dx</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679170410"><a href="#local-6989586621679170410"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679170411"><a href="#local-6989586621679170411"><span class="hs-identifier">lo</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679170412"><a href="#local-6989586621679170412"><span class="hs-identifier">hi</span></a></a><span>
</span><a name="line-212"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679170409"><span class="hs-identifier hs-var">dx</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679170406"><span class="hs-identifier hs-var">accuracy</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679170408"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679170407"><span class="hs-identifier hs-var">maxIters</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679170410"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-213"></a><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679170405"><span class="hs-identifier hs-var">loop</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679170408"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679170419"><span class="hs-identifier hs-var">dx''</span></a><span> </span><a href="#local-6989586621679170420"><span class="hs-identifier hs-var">x''</span></a><span> </span><a href="#local-6989586621679170414"><span class="hs-identifier hs-var">lo'</span></a><span> </span><a href="#local-6989586621679170415"><span class="hs-identifier hs-var">hi'</span></a><span>
</span><a name="line-214"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-215"></a><span>        </span><a name="local-6989586621679170413"><a href="#local-6989586621679170413"><span class="hs-identifier">err</span></a></a><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="Statistics.Distribution.html#cumulative"><span class="hs-identifier hs-var">cumulative</span></a><span> </span><a href="#local-6989586621679170403"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679170410"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679170404"><span class="hs-identifier hs-var">prob</span></a><span>
</span><a name="line-216"></a><span>        </span><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-var">P</span></a><span> </span><a name="local-6989586621679170414"><a href="#local-6989586621679170414"><span class="hs-identifier">lo'</span></a></a><span> </span><a name="local-6989586621679170415"><a href="#local-6989586621679170415"><span class="hs-identifier">hi'</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679170413"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-var">P</span></a><span> </span><a href="#local-6989586621679170410"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679170412"><span class="hs-identifier hs-var">hi</span></a><span>
</span><a name="line-217"></a><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-var">P</span></a><span> </span><a href="#local-6989586621679170411"><span class="hs-identifier hs-var">lo</span></a><span> </span><a href="#local-6989586621679170410"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-218"></a><span>        </span><a name="local-6989586621679170416"><a href="#local-6989586621679170416"><span class="hs-identifier">pdf</span></a></a><span>                   </span><span class="hs-glyph">=</span><span> </span><a href="Statistics.Distribution.html#density"><span class="hs-identifier hs-var">density</span></a><span> </span><a href="#local-6989586621679170403"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679170410"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-219"></a><span>        </span><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-var">P</span></a><span> </span><a name="local-6989586621679170417"><a href="#local-6989586621679170417"><span class="hs-identifier">dx'</span></a></a><span> </span><a name="local-6989586621679170418"><a href="#local-6989586621679170418"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679170416"><span class="hs-identifier hs-var">pdf</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-var">P</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679170413"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679170416"><span class="hs-identifier hs-var">pdf</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679170410"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679170409"><span class="hs-identifier hs-var">dx</span></a><span class="hs-special">)</span><span>
</span><a name="line-220"></a><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-var">P</span></a><span> </span><a href="#local-6989586621679170409"><span class="hs-identifier hs-var">dx</span></a><span> </span><a href="#local-6989586621679170410"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-221"></a><span>        </span><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-var">P</span></a><span> </span><a name="local-6989586621679170419"><a href="#local-6989586621679170419"><span class="hs-identifier">dx''</span></a></a><span> </span><a name="local-6989586621679170420"><a href="#local-6989586621679170420"><span class="hs-identifier">x''</span></a></a><span>
</span><a name="line-222"></a><span>            </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679170418"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679170414"><span class="hs-identifier hs-var">lo'</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679170418"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679170415"><span class="hs-identifier hs-var">hi'</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679170416"><span class="hs-identifier hs-var">pdf</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679170421"><a href="#local-6989586621679170421"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679170414"><span class="hs-identifier hs-var">lo'</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679170415"><span class="hs-identifier hs-var">hi'</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-223"></a><span>                                                 </span><span class="hs-keyword">in</span><span>  </span><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-var">P</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679170421"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679170410"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679170421"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-224"></a><span>            </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>                        </span><span class="hs-glyph">=</span><span> </span><a href="Statistics.Distribution.html#P"><span class="hs-identifier hs-var">P</span></a><span> </span><a href="#local-6989586621679170417"><span class="hs-identifier hs-var">dx'</span></a><span> </span><a href="#local-6989586621679170418"><span class="hs-identifier hs-var">x'</span></a><span>
</span><a name="line-225"></a><span>    </span><a name="local-6989586621679170406"><a href="#local-6989586621679170406"><span class="hs-identifier">accuracy</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1e-15</span><span>
</span><a name="line-226"></a><span>    </span><a name="local-6989586621679170407"><a href="#local-6989586621679170407"><span class="hs-identifier">maxIters</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">150</span><span>
</span><a name="line-227"></a><span>
</span><a name="line-228"></a><span class="hs-comment">-- | Sum probabilities in inclusive interval.</span><span>
</span><a name="line-229"></a><span class="hs-identifier">sumProbabilities</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Statistics.Distribution.html#DiscreteDistr"><span class="hs-identifier hs-type">DiscreteDistr</span></a><span> </span><a href="#local-6989586621679170394"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679170394"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-230"></a><a name="sumProbabilities"><a href="Statistics.Distribution.html#sumProbabilities"><span class="hs-identifier">sumProbabilities</span></a></a><span> </span><a name="local-6989586621679170422"><a href="#local-6989586621679170422"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679170423"><a href="#local-6989586621679170423"><span class="hs-identifier">low</span></a></a><span> </span><a name="local-6989586621679170424"><a href="#local-6989586621679170424"><span class="hs-identifier">hi</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-231"></a><span>  </span><span class="hs-comment">-- Return value is forced to be less than 1 to guard againist roundoff errors.</span><span>
</span><a name="line-232"></a><span>  </span><span class="hs-comment">-- ATTENTION! this check should be removed for testing or it could mask bugs.</span><span>
</span><a name="line-233"></a><span>  </span><span class="hs-identifier hs-var">min</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Statistics.Sample.Internal.html#sum"><span class="hs-identifier hs-var">sum</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">U</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Statistics.Distribution.html#probability"><span class="hs-identifier hs-var">probability</span></a><span> </span><a href="#local-6989586621679170422"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">U</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">enumFromTo</span><span> </span><a href="#local-6989586621679170423"><span class="hs-identifier hs-var">low</span></a><span> </span><a href="#local-6989586621679170424"><span class="hs-identifier hs-var">hi</span></a><span>
</span><a name="line-234"></a></pre></body></html>