<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds  #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies     #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE TypeOperators    #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE ViewPatterns     #-}</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- Module      : Data.Array.Accelerate.Language</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Copyright   : [2008..2016] Manuel M T Chakravarty, Gabriele Keller</span><span>
</span><a name="line-9"></a><span class="hs-comment">--               [2009..2016] Trevor L. McDonell</span><span>
</span><a name="line-10"></a><span class="hs-comment">--               [2014..2014] Frederik M. Madsen</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- License     : BSD3</span><span>
</span><a name="line-12"></a><span class="hs-comment">--</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- Maintainer  : Manuel M T Chakravarty &lt;chak@cse.unsw.edu.au&gt;</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- Stability   : experimental</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- Portability : non-portable (GHC extensions)</span><span>
</span><a name="line-16"></a><span class="hs-comment">--</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- We use the dictionary view of overloaded operations (such as arithmetic and</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- bit manipulation) to reify such expressions.  With non-overloaded</span><span>
</span><a name="line-19"></a><span class="hs-comment">-- operations (such as, the logical connectives) and partially overloaded</span><span>
</span><a name="line-20"></a><span class="hs-comment">-- operations (such as comparisons), we use the standard operator names with a</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- \'*\' attached.  We keep the standard alphanumeric names as they can be</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- easily qualified.</span><span>
</span><a name="line-23"></a><span class="hs-comment">--</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Array</span><span class="hs-operator">.</span><span class="hs-identifier">Accelerate</span><span class="hs-operator">.</span><span class="hs-identifier">Language</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span>  </span><span class="hs-comment">-- * Array and scalar expressions</span><span>
</span><a name="line-28"></a><span>  </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span class="hs-special">,</span><span>                            </span><span class="hs-comment">-- re-exporting from 'Smart'</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span>  </span><span class="hs-comment">-- * Scalar introduction</span><span>
</span><a name="line-31"></a><span>  </span><a href="Data.Array.Accelerate.Smart.html#constant"><span class="hs-identifier hs-var">constant</span></a><span class="hs-special">,</span><span>                                 </span><span class="hs-comment">-- re-exporting from 'Smart'</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span>  </span><span class="hs-comment">-- * Array construction</span><span>
</span><a name="line-34"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#use"><span class="hs-identifier hs-var">use</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#unit"><span class="hs-identifier hs-var">unit</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#replicate"><span class="hs-identifier hs-var">replicate</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#generate"><span class="hs-identifier hs-var">generate</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span>  </span><span class="hs-comment">-- * Shape manipulation</span><span>
</span><a name="line-37"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#reshape"><span class="hs-identifier hs-var">reshape</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span>  </span><span class="hs-comment">-- * Extraction of sub-arrays</span><span>
</span><a name="line-40"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#slice"><span class="hs-identifier hs-var">slice</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span>  </span><span class="hs-comment">-- * Map-like functions</span><span>
</span><a name="line-43"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#map"><span class="hs-identifier hs-var">map</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span>  </span><span class="hs-comment">-- * Sequence collection</span><span>
</span><a name="line-46"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#collect"><span class="hs-identifier hs-var">collect</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span>  </span><span class="hs-comment">-- * Sequence producers</span><span>
</span><a name="line-49"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#streamIn"><span class="hs-identifier hs-var">streamIn</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#toSeq"><span class="hs-identifier hs-var">toSeq</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span>  </span><span class="hs-comment">-- * Sequence transducers</span><span>
</span><a name="line-52"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#mapSeq"><span class="hs-identifier hs-var">mapSeq</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#zipWithSeq"><span class="hs-identifier hs-var">zipWithSeq</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#scanSeq"><span class="hs-identifier hs-var">scanSeq</span></a><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span>  </span><span class="hs-comment">-- * Sequence consumers</span><span>
</span><a name="line-55"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#foldSeq"><span class="hs-identifier hs-var">foldSeq</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#foldSeqFlatten"><span class="hs-identifier hs-var">foldSeqFlatten</span></a><span class="hs-special">,</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span>  </span><span class="hs-comment">-- * Reductions</span><span>
</span><a name="line-58"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#fold"><span class="hs-identifier hs-var">fold</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#fold1"><span class="hs-identifier hs-var">fold1</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#foldSeg"><span class="hs-identifier hs-var">foldSeg</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#fold1Seg"><span class="hs-identifier hs-var">fold1Seg</span></a><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span>  </span><span class="hs-comment">-- * Scan functions</span><span>
</span><a name="line-61"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#scanl"><span class="hs-identifier hs-var">scanl</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#scanl%27"><span class="hs-identifier hs-var">scanl'</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#scanl1"><span class="hs-identifier hs-var">scanl1</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#scanr"><span class="hs-identifier hs-var">scanr</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#scanr%27"><span class="hs-identifier hs-var">scanr'</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#scanr1"><span class="hs-identifier hs-var">scanr1</span></a><span class="hs-special">,</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span>  </span><span class="hs-comment">-- * Permutations</span><span>
</span><a name="line-64"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#permute"><span class="hs-identifier hs-var">permute</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#backpermute"><span class="hs-identifier hs-var">backpermute</span></a><span class="hs-special">,</span><span>
</span><a name="line-65"></a><span>
</span><a name="line-66"></a><span>  </span><span class="hs-comment">-- * Stencil operations</span><span>
</span><a name="line-67"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#stencil"><span class="hs-identifier hs-var">stencil</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#stencil2"><span class="hs-identifier hs-var">stencil2</span></a><span class="hs-special">,</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span>  </span><span class="hs-comment">-- ** Stencil specification</span><span>
</span><a name="line-70"></a><span>  </span><a href="Data.Array.Accelerate.Type.html#Boundary"><span class="hs-identifier hs-type">Boundary</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Stencil"><span class="hs-identifier hs-type">Stencil</span></a><span class="hs-special">,</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span>  </span><span class="hs-comment">-- ** Common stencil types</span><span>
</span><a name="line-73"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#Stencil3"><span class="hs-identifier hs-type">Stencil3</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5"><span class="hs-identifier hs-type">Stencil5</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil7"><span class="hs-identifier hs-type">Stencil7</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil9"><span class="hs-identifier hs-type">Stencil9</span></a><span class="hs-special">,</span><span>
</span><a name="line-74"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#Stencil3x3"><span class="hs-identifier hs-type">Stencil3x3</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5x3"><span class="hs-identifier hs-type">Stencil5x3</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3x5"><span class="hs-identifier hs-type">Stencil3x5</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5x5"><span class="hs-identifier hs-type">Stencil5x5</span></a><span class="hs-special">,</span><span>
</span><a name="line-75"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#Stencil3x3x3"><span class="hs-identifier hs-type">Stencil3x3x3</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5x3x3"><span class="hs-identifier hs-type">Stencil5x3x3</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3x5x3"><span class="hs-identifier hs-type">Stencil3x5x3</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3x3x5"><span class="hs-identifier hs-type">Stencil3x3x5</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5x5x3"><span class="hs-identifier hs-type">Stencil5x5x3</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5x3x5"><span class="hs-identifier hs-type">Stencil5x3x5</span></a><span class="hs-special">,</span><span>
</span><a name="line-76"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#Stencil3x5x5"><span class="hs-identifier hs-type">Stencil3x5x5</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5x5x5"><span class="hs-identifier hs-type">Stencil5x5x5</span></a><span class="hs-special">,</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span>  </span><span class="hs-comment">-- * Foreign functions</span><span>
</span><a name="line-79"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#foreignAcc"><span class="hs-identifier hs-var">foreignAcc</span></a><span class="hs-special">,</span><span>
</span><a name="line-80"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#foreignExp"><span class="hs-identifier hs-var">foreignExp</span></a><span class="hs-special">,</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span>  </span><span class="hs-comment">-- * Pipelining</span><span>
</span><a name="line-83"></a><span>  </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Language.html#%3E-%3E"><span class="hs-operator hs-var">&gt;-&gt;</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span>  </span><span class="hs-comment">-- * Index construction and destruction</span><span>
</span><a name="line-86"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#indexHead"><span class="hs-identifier hs-var">indexHead</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#indexTail"><span class="hs-identifier hs-var">indexTail</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#toIndex"><span class="hs-identifier hs-var">toIndex</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#fromIndex"><span class="hs-identifier hs-var">fromIndex</span></a><span class="hs-special">,</span><span>
</span><a name="line-87"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#intersect"><span class="hs-identifier hs-var">intersect</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#union"><span class="hs-identifier hs-var">union</span></a><span class="hs-special">,</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span>  </span><span class="hs-comment">-- * Flow-control</span><span>
</span><a name="line-90"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#acond"><span class="hs-identifier hs-var">acond</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#awhile"><span class="hs-identifier hs-var">awhile</span></a><span class="hs-special">,</span><span>
</span><a name="line-91"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#cond"><span class="hs-identifier hs-var">cond</span></a><span class="hs-special">,</span><span>  </span><a href="Data.Array.Accelerate.Language.html#while"><span class="hs-identifier hs-var">while</span></a><span class="hs-special">,</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span>  </span><span class="hs-comment">-- * Array operations with a scalar result</span><span>
</span><a name="line-94"></a><span>  </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Language.html#%21%21"><span class="hs-operator hs-var">!!</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#shape"><span class="hs-identifier hs-var">shape</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#size"><span class="hs-identifier hs-var">size</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#shapeSize"><span class="hs-identifier hs-var">shapeSize</span></a><span class="hs-special">,</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span>  </span><span class="hs-comment">-- * Numeric functions</span><span>
</span><a name="line-97"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#subtract"><span class="hs-identifier hs-var">subtract</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#even"><span class="hs-identifier hs-var">even</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#odd"><span class="hs-identifier hs-var">odd</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#gcd"><span class="hs-identifier hs-var">gcd</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#lcm"><span class="hs-identifier hs-var">lcm</span></a><span class="hs-special">,</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span>  </span><span class="hs-comment">-- * Conversions</span><span>
</span><a name="line-100"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#ord"><span class="hs-identifier hs-var">ord</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#chr"><span class="hs-identifier hs-var">chr</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#boolToInt"><span class="hs-identifier hs-var">boolToInt</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#bitcast"><span class="hs-identifier hs-var">bitcast</span></a><span class="hs-special">,</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span>  </span><span class="hs-comment">-- * Constants</span><span>
</span><a name="line-103"></a><span>  </span><a href="Data.Array.Accelerate.Language.html#ignore"><span class="hs-identifier hs-var">ignore</span></a><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">-- friends</span><span>
</span><a name="line-108"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Array</span><span class="hs-operator">.</span><span class="hs-identifier">Accelerate</span><span class="hs-operator">.</span><span class="hs-identifier">Array</span><span class="hs-operator">.</span><span class="hs-identifier">Sugar</span></a><span>                </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#ignore"><span class="hs-identifier hs-var">ignore</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#shape"><span class="hs-identifier hs-var">shape</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#size"><span class="hs-identifier hs-var">size</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#toIndex"><span class="hs-identifier hs-var">toIndex</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#fromIndex"><span class="hs-identifier hs-var">fromIndex</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#intersect"><span class="hs-identifier hs-var">intersect</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#union"><span class="hs-identifier hs-var">union</span></a><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Array.Accelerate.Classes.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Array</span><span class="hs-operator">.</span><span class="hs-identifier">Accelerate</span><span class="hs-operator">.</span><span class="hs-identifier">Classes</span></a><span>
</span><a name="line-110"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Array.Accelerate.Smart.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Array</span><span class="hs-operator">.</span><span class="hs-identifier">Accelerate</span><span class="hs-operator">.</span><span class="hs-identifier">Smart</span></a><span>
</span><a name="line-111"></a><span class="hs-keyword">import</span><span> </span><a href="Data.Array.Accelerate.Type.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Array</span><span class="hs-operator">.</span><span class="hs-identifier">Accelerate</span><span class="hs-operator">.</span><span class="hs-identifier">Type</span></a><span>
</span><a name="line-112"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Array</span><span class="hs-operator">.</span><span class="hs-identifier">Accelerate</span><span class="hs-operator">.</span><span class="hs-identifier">Array</span><span class="hs-operator">.</span><span class="hs-identifier">Sugar</span></a><span>      </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Sugar</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-comment">-- standard libraries</span><span>
</span><a name="line-115"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span>                                          </span><span class="hs-special">(</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">$</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">-- Array introduction</span><span>
</span><a name="line-119"></a><span class="hs-comment">-- ------------------</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-comment">-- | Array inlet: makes an array available for processing using the Accelerate</span><span>
</span><a name="line-122"></a><span class="hs-comment">-- language.</span><span>
</span><a name="line-123"></a><span class="hs-comment">--</span><span>
</span><a name="line-124"></a><span class="hs-comment">-- Depending upon the backend used to execute array computations, this may</span><span>
</span><a name="line-125"></a><span class="hs-comment">-- trigger (asynchronous) data transfer.</span><span>
</span><a name="line-126"></a><span class="hs-comment">--</span><span>
</span><a name="line-127"></a><span class="hs-identifier">use</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Arrays"><span class="hs-identifier hs-type">Arrays</span></a><span> </span><a href="#local-1630500147"><span class="hs-identifier hs-type">arrays</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1630500147"><span class="hs-identifier hs-type">arrays</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500147"><span class="hs-identifier hs-type">arrays</span></a><span>
</span><a name="line-128"></a><a name="use"><a href="Data.Array.Accelerate.Language.html#use"><span class="hs-identifier">use</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Use"><span class="hs-identifier hs-var">Use</span></a><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span class="hs-comment">-- | Scalar inlet: injects a scalar (or a tuple of scalars) into a singleton</span><span>
</span><a name="line-131"></a><span class="hs-comment">-- array for use in the Accelerate language.</span><span>
</span><a name="line-132"></a><span class="hs-comment">--</span><span>
</span><a name="line-133"></a><span class="hs-identifier">unit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500146"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500146"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a><span> </span><a href="#local-1630500146"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-134"></a><a name="unit"><a href="Data.Array.Accelerate.Language.html#unit"><span class="hs-identifier">unit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Unit"><span class="hs-identifier hs-var">Unit</span></a><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-comment">-- | Replicate an array across one or more dimensions as specified by the</span><span>
</span><a name="line-137"></a><span class="hs-comment">-- /generalised/ array index provided as the first argument.</span><span>
</span><a name="line-138"></a><span class="hs-comment">--</span><span>
</span><a name="line-139"></a><span class="hs-comment">-- For example, assuming 'arr' is a vector (one-dimensional array),</span><span>
</span><a name="line-140"></a><span class="hs-comment">--</span><span>
</span><a name="line-141"></a><span class="hs-comment">-- &gt; replicate (lift (Z :. (2::Int) :. All :. (3::Int))) arr</span><span>
</span><a name="line-142"></a><span class="hs-comment">--</span><span>
</span><a name="line-143"></a><span class="hs-comment">-- yields a three dimensional array, where 'arr' is replicated twice across the</span><span>
</span><a name="line-144"></a><span class="hs-comment">-- first and three times across the third dimension.</span><span>
</span><a name="line-145"></a><span class="hs-comment">--</span><span>
</span><a name="line-146"></a><span class="hs-identifier">replicate</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Slice"><span class="hs-identifier hs-type">Slice</span></a><span> </span><a href="#local-1630500144"><span class="hs-identifier hs-type">slix</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500145"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500144"><span class="hs-identifier hs-type">slix</span></a><span>
</span><a name="line-148"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#SliceShape"><span class="hs-identifier hs-type">SliceShape</span></a><span> </span><a href="#local-1630500144"><span class="hs-identifier hs-type">slix</span></a><span class="hs-special">)</span><span> </span><a href="#local-1630500145"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#FullShape"><span class="hs-identifier hs-type">FullShape</span></a><span>  </span><a href="#local-1630500144"><span class="hs-identifier hs-type">slix</span></a><span class="hs-special">)</span><span> </span><a href="#local-1630500145"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-150"></a><a name="replicate"><a href="Data.Array.Accelerate.Language.html#replicate"><span class="hs-identifier">replicate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Replicate"><span class="hs-identifier hs-var">Replicate</span></a><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-comment">-- | Construct a new array by applying a function to each index.</span><span>
</span><a name="line-153"></a><span class="hs-comment">--</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- For example, the following will generate a one-dimensional array</span><span>
</span><a name="line-155"></a><span class="hs-comment">-- (`Vector`) of three floating point numbers:</span><span>
</span><a name="line-156"></a><span class="hs-comment">--</span><span>
</span><a name="line-157"></a><span class="hs-comment">-- &gt; generate (index1 3) (\_ -&gt; 1.2)</span><span>
</span><a name="line-158"></a><span class="hs-comment">--</span><span>
</span><a name="line-159"></a><span class="hs-comment">-- Or, equivalently:</span><span>
</span><a name="line-160"></a><span class="hs-comment">--</span><span>
</span><a name="line-161"></a><span class="hs-comment">-- &gt; generate (constant (Z :. (3::Int))) (\_ -&gt; 1.2)</span><span>
</span><a name="line-162"></a><span class="hs-comment">--</span><span>
</span><a name="line-163"></a><span class="hs-comment">-- Finally, the following will create an array equivalent to '[1..10]':</span><span>
</span><a name="line-164"></a><span class="hs-comment">--</span><span>
</span><a name="line-165"></a><span class="hs-comment">-- &gt; generate (index1 10) $ \ ix -&gt;</span><span>
</span><a name="line-166"></a><span class="hs-comment">-- &gt;          let (Z :. i) = unlift ix</span><span>
</span><a name="line-167"></a><span class="hs-comment">-- &gt;          in fromIntegral i</span><span>
</span><a name="line-168"></a><span class="hs-comment">--</span><span>
</span><a name="line-169"></a><span class="hs-comment">-- [/NOTE:/]</span><span>
</span><a name="line-170"></a><span class="hs-comment">--</span><span>
</span><a name="line-171"></a><span class="hs-comment">-- Using 'generate', it is possible to introduce nested data parallelism, which</span><span>
</span><a name="line-172"></a><span class="hs-comment">-- will cause the program to fail.</span><span>
</span><a name="line-173"></a><span class="hs-comment">--</span><span>
</span><a name="line-174"></a><span class="hs-comment">-- If the index given by the scalar function is then used to dispatch further</span><span>
</span><a name="line-175"></a><span class="hs-comment">-- parallel work, whose result is returned into 'Exp' terms by array indexing</span><span>
</span><a name="line-176"></a><span class="hs-comment">-- operations such as (`!`) or `the`, the program will fail with the error:</span><span>
</span><a name="line-177"></a><span class="hs-comment">-- '.\/Data\/Array\/Accelerate\/Trafo\/Sharing.hs:447 (convertSharingExp): inconsistent valuation \@ shared \'Exp\' tree ...'.</span><span>
</span><a name="line-178"></a><span class="hs-comment">--</span><span>
</span><a name="line-179"></a><span class="hs-identifier">generate</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500142"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500143"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-180"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500142"><span class="hs-identifier hs-type">ix</span></a><span>
</span><a name="line-181"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500142"><span class="hs-identifier hs-type">ix</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500143"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-182"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500142"><span class="hs-identifier hs-type">ix</span></a><span> </span><a href="#local-1630500143"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-183"></a><a name="generate"><a href="Data.Array.Accelerate.Language.html#generate"><span class="hs-identifier">generate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Generate"><span class="hs-identifier hs-var">Generate</span></a><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span class="hs-comment">-- Shape manipulation</span><span>
</span><a name="line-186"></a><span class="hs-comment">-- ------------------</span><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-comment">-- | Change the shape of an array without altering its contents. The 'size' of</span><span>
</span><a name="line-189"></a><span class="hs-comment">-- the source and result arrays must be identical.</span><span>
</span><a name="line-190"></a><span class="hs-comment">--</span><span>
</span><a name="line-191"></a><span class="hs-comment">-- &gt; precondition: size ix == size ix'</span><span>
</span><a name="line-192"></a><span class="hs-comment">--</span><span>
</span><a name="line-193"></a><span class="hs-identifier">reshape</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500139"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500140"><span class="hs-identifier hs-type">ix'</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500141"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-194"></a><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500139"><span class="hs-identifier hs-type">ix</span></a><span>
</span><a name="line-195"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500140"><span class="hs-identifier hs-type">ix'</span></a><span> </span><a href="#local-1630500141"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-196"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500139"><span class="hs-identifier hs-type">ix</span></a><span> </span><a href="#local-1630500141"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-197"></a><a name="reshape"><a href="Data.Array.Accelerate.Language.html#reshape"><span class="hs-identifier">reshape</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Reshape"><span class="hs-identifier hs-var">Reshape</span></a><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-comment">-- Extraction of sub-arrays</span><span>
</span><a name="line-200"></a><span class="hs-comment">-- ------------------------</span><span>
</span><a name="line-201"></a><span>
</span><a name="line-202"></a><span class="hs-comment">-- | Index an array with a /generalised/ array index, supplied as the</span><span>
</span><a name="line-203"></a><span class="hs-comment">-- second argument. The result is a new array (possibly a singleton)</span><span>
</span><a name="line-204"></a><span class="hs-comment">-- containing the selected dimensions (`All`s) in their entirety.</span><span>
</span><a name="line-205"></a><span class="hs-comment">--</span><span>
</span><a name="line-206"></a><span class="hs-comment">-- This can be used to /cut out/ entire dimensions.  The opposite of</span><span>
</span><a name="line-207"></a><span class="hs-comment">-- `replicate`.  For example, if 'mat' is a two dimensional array, the</span><span>
</span><a name="line-208"></a><span class="hs-comment">-- following will select a specific row and yield a one dimensional</span><span>
</span><a name="line-209"></a><span class="hs-comment">-- result:</span><span>
</span><a name="line-210"></a><span class="hs-comment">--</span><span>
</span><a name="line-211"></a><span class="hs-comment">-- &gt; slice mat (lift (Z :. (2::Int) :. All))</span><span>
</span><a name="line-212"></a><span class="hs-comment">--</span><span>
</span><a name="line-213"></a><span class="hs-comment">-- A fully specified index (with no `All`s) would return a single element (zero</span><span>
</span><a name="line-214"></a><span class="hs-comment">-- dimensional array).</span><span>
</span><a name="line-215"></a><span class="hs-comment">--</span><span>
</span><a name="line-216"></a><span class="hs-identifier">slice</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Slice"><span class="hs-identifier hs-type">Slice</span></a><span> </span><a href="#local-1630500137"><span class="hs-identifier hs-type">slix</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500138"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-217"></a><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#FullShape"><span class="hs-identifier hs-type">FullShape</span></a><span> </span><a href="#local-1630500137"><span class="hs-identifier hs-type">slix</span></a><span class="hs-special">)</span><span> </span><a href="#local-1630500138"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-218"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500137"><span class="hs-identifier hs-type">slix</span></a><span>
</span><a name="line-219"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#SliceShape"><span class="hs-identifier hs-type">SliceShape</span></a><span> </span><a href="#local-1630500137"><span class="hs-identifier hs-type">slix</span></a><span class="hs-special">)</span><span> </span><a href="#local-1630500138"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-220"></a><a name="slice"><a href="Data.Array.Accelerate.Language.html#slice"><span class="hs-identifier">slice</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Slice"><span class="hs-identifier hs-var">Slice</span></a><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span class="hs-comment">-- Map-like functions</span><span>
</span><a name="line-223"></a><span class="hs-comment">-- ------------------</span><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span class="hs-comment">-- | Apply the given function element-wise to the given array.</span><span>
</span><a name="line-226"></a><span class="hs-comment">--</span><span>
</span><a name="line-227"></a><span class="hs-identifier">map</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500134"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500135"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500136"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-228"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500135"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500136"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-229"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500134"><span class="hs-identifier hs-type">ix</span></a><span> </span><a href="#local-1630500135"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-230"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500134"><span class="hs-identifier hs-type">ix</span></a><span> </span><a href="#local-1630500136"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-231"></a><a name="map"><a href="Data.Array.Accelerate.Language.html#map"><span class="hs-identifier">map</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Map"><span class="hs-identifier hs-var">Map</span></a><span>
</span><a name="line-232"></a><span>
</span><a name="line-233"></a><span class="hs-comment">-- | Apply the given binary function element-wise to the two arrays.  The extent of the resulting</span><span>
</span><a name="line-234"></a><span class="hs-comment">-- array is the intersection of the extents of the two source arrays.</span><span>
</span><a name="line-235"></a><span class="hs-comment">--</span><span>
</span><a name="line-236"></a><span class="hs-identifier">zipWith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500130"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500131"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500132"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500133"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-237"></a><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500131"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500132"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500133"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-238"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500130"><span class="hs-identifier hs-type">ix</span></a><span> </span><a href="#local-1630500131"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-239"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500130"><span class="hs-identifier hs-type">ix</span></a><span> </span><a href="#local-1630500132"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-240"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500130"><span class="hs-identifier hs-type">ix</span></a><span> </span><a href="#local-1630500133"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-241"></a><a name="zipWith"><a href="Data.Array.Accelerate.Language.html#zipWith"><span class="hs-identifier">zipWith</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#ZipWith"><span class="hs-identifier hs-var">ZipWith</span></a><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span class="hs-comment">-- Reductions</span><span>
</span><a name="line-244"></a><span class="hs-comment">-- ----------</span><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span class="hs-comment">-- | Reduction of the innermost dimension of an array of arbitrary rank.  The</span><span>
</span><a name="line-247"></a><span class="hs-comment">-- first argument needs to be an /associative/ function to enable an efficient</span><span>
</span><a name="line-248"></a><span class="hs-comment">-- parallel implementation.</span><span>
</span><a name="line-249"></a><span class="hs-comment">--</span><span>
</span><a name="line-250"></a><span class="hs-identifier">fold</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500128"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500129"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-251"></a><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500129"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500129"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500129"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-252"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500129"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-253"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><span class="hs-special">(</span><a href="#local-1630500128"><span class="hs-identifier hs-type">ix</span></a><span class="hs-operator">:.</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><a href="#local-1630500129"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-254"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500128"><span class="hs-identifier hs-type">ix</span></a><span> </span><a href="#local-1630500129"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-255"></a><a name="fold"><a href="Data.Array.Accelerate.Language.html#fold"><span class="hs-identifier">fold</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span>
</span><a name="line-256"></a><span>
</span><a name="line-257"></a><span class="hs-comment">-- | Variant of 'fold' that requires the reduced array to be non-empty and</span><span>
</span><a name="line-258"></a><span class="hs-comment">-- doesn't need an default value.  The first argument needs to be an</span><span>
</span><a name="line-259"></a><span class="hs-comment">-- /associative/ function to enable an efficient parallel implementation.</span><span>
</span><a name="line-260"></a><span class="hs-comment">--</span><span>
</span><a name="line-261"></a><span class="hs-identifier">fold1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500126"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500127"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-262"></a><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500127"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500127"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500127"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-263"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><span class="hs-special">(</span><a href="#local-1630500126"><span class="hs-identifier hs-type">ix</span></a><span class="hs-operator">:.</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><a href="#local-1630500127"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-264"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500126"><span class="hs-identifier hs-type">ix</span></a><span> </span><a href="#local-1630500127"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-265"></a><a name="fold1"><a href="Data.Array.Accelerate.Language.html#fold1"><span class="hs-identifier">fold1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Fold1"><span class="hs-identifier hs-var">Fold1</span></a><span>
</span><a name="line-266"></a><span>
</span><a name="line-267"></a><span class="hs-comment">-- | Segmented reduction along the innermost dimension.  Performs one individual</span><span>
</span><a name="line-268"></a><span class="hs-comment">-- reduction per segment of the source array.  These reductions proceed in</span><span>
</span><a name="line-269"></a><span class="hs-comment">-- parallel.</span><span>
</span><a name="line-270"></a><span class="hs-comment">--</span><span>
</span><a name="line-271"></a><span class="hs-comment">-- The source array must have at least rank 1.  The 'Segments' array determines</span><span>
</span><a name="line-272"></a><span class="hs-comment">-- the lengths of the logical sub-arrays, each of which is folded separately.</span><span>
</span><a name="line-273"></a><span class="hs-comment">--</span><span>
</span><a name="line-274"></a><span class="hs-identifier">foldSeg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500123"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500124"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500125"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Type.html#IsIntegral"><span class="hs-identifier hs-type">IsIntegral</span></a><span> </span><a href="#local-1630500125"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-275"></a><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500124"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500124"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500124"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-276"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500124"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-277"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><span class="hs-special">(</span><a href="#local-1630500123"><span class="hs-identifier hs-type">ix</span></a><span class="hs-operator">:.</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><a href="#local-1630500124"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-278"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Segments"><span class="hs-identifier hs-type">Segments</span></a><span> </span><a href="#local-1630500125"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-279"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><span class="hs-special">(</span><a href="#local-1630500123"><span class="hs-identifier hs-type">ix</span></a><span class="hs-operator">:.</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><a href="#local-1630500124"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-280"></a><a name="foldSeg"><a href="Data.Array.Accelerate.Language.html#foldSeg"><span class="hs-identifier">foldSeg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24%24"><span class="hs-operator hs-var">$$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#FoldSeg"><span class="hs-identifier hs-var">FoldSeg</span></a><span>
</span><a name="line-281"></a><span>
</span><a name="line-282"></a><span class="hs-comment">-- | Variant of 'foldSeg' that requires /all/ segments of the reduced array to</span><span>
</span><a name="line-283"></a><span class="hs-comment">-- be non-empty and doesn't need a default value.</span><span>
</span><a name="line-284"></a><span class="hs-comment">--</span><span>
</span><a name="line-285"></a><span class="hs-comment">-- The source array must have at least rank 1. The 'Segments' array determines</span><span>
</span><a name="line-286"></a><span class="hs-comment">-- the lengths of the logical sub-arrays, each of which is folded separately.</span><span>
</span><a name="line-287"></a><span class="hs-comment">--</span><span>
</span><a name="line-288"></a><span class="hs-identifier">fold1Seg</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500120"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500121"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500122"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Type.html#IsIntegral"><span class="hs-identifier hs-type">IsIntegral</span></a><span> </span><a href="#local-1630500122"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500121"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500121"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500121"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-290"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><span class="hs-special">(</span><a href="#local-1630500120"><span class="hs-identifier hs-type">ix</span></a><span class="hs-operator">:.</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><a href="#local-1630500121"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-291"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Segments"><span class="hs-identifier hs-type">Segments</span></a><span> </span><a href="#local-1630500122"><span class="hs-identifier hs-type">i</span></a><span class="hs-special">)</span><span>
</span><a name="line-292"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><span class="hs-special">(</span><a href="#local-1630500120"><span class="hs-identifier hs-type">ix</span></a><span class="hs-operator">:.</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><a href="#local-1630500121"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-293"></a><a name="fold1Seg"><a href="Data.Array.Accelerate.Language.html#fold1Seg"><span class="hs-identifier">fold1Seg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Fold1Seg"><span class="hs-identifier hs-var">Fold1Seg</span></a><span>
</span><a name="line-294"></a><span>
</span><a name="line-295"></a><span class="hs-comment">-- Scan functions</span><span>
</span><a name="line-296"></a><span class="hs-comment">-- --------------</span><span>
</span><a name="line-297"></a><span>
</span><a name="line-298"></a><span class="hs-comment">-- | Data.List style left-to-right scan, but with the additional restriction</span><span>
</span><a name="line-299"></a><span class="hs-comment">-- that the first argument needs to be an /associative/ function to enable an</span><span>
</span><a name="line-300"></a><span class="hs-comment">-- efficient parallel implementation. The initial value (second argument) may be</span><span>
</span><a name="line-301"></a><span class="hs-comment">-- arbitrary.</span><span>
</span><a name="line-302"></a><span class="hs-comment">--</span><span>
</span><a name="line-303"></a><span class="hs-identifier">scanl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500119"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-304"></a><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500119"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500119"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500119"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-305"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500119"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-306"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Vector"><span class="hs-identifier hs-type">Vector</span></a><span> </span><a href="#local-1630500119"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-307"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Vector"><span class="hs-identifier hs-type">Vector</span></a><span> </span><a href="#local-1630500119"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-308"></a><a name="scanl"><a href="Data.Array.Accelerate.Language.html#scanl"><span class="hs-identifier">scanl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Scanl"><span class="hs-identifier hs-var">Scanl</span></a><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span class="hs-comment">-- | Variant of 'scanl', where the final result of the reduction is returned</span><span>
</span><a name="line-311"></a><span class="hs-comment">-- separately. Denotationally, we have</span><span>
</span><a name="line-312"></a><span class="hs-comment">--</span><span>
</span><a name="line-313"></a><span class="hs-comment">-- &gt; scanl' f e arr = (init res, unit (res!len))</span><span>
</span><a name="line-314"></a><span class="hs-comment">-- &gt;   where</span><span>
</span><a name="line-315"></a><span class="hs-comment">-- &gt;     len = shape arr</span><span>
</span><a name="line-316"></a><span class="hs-comment">-- &gt;     res = scanl f e arr</span><span>
</span><a name="line-317"></a><span class="hs-comment">--</span><span>
</span><a name="line-318"></a><span class="hs-identifier">scanl'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500118"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-319"></a><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500118"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500118"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500118"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-320"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500118"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-321"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Vector"><span class="hs-identifier hs-type">Vector</span></a><span> </span><a href="#local-1630500118"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-322"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Vector"><span class="hs-identifier hs-type">Vector</span></a><span> </span><a href="#local-1630500118"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a><span> </span><a href="#local-1630500118"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-323"></a><a name="scanl%27"><a href="Data.Array.Accelerate.Language.html#scanl%27"><span class="hs-identifier">scanl'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#unatup2"><span class="hs-identifier hs-var">unatup2</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Scanl%27"><span class="hs-identifier hs-var">Scanl'</span></a><span>
</span><a name="line-324"></a><span>
</span><a name="line-325"></a><span class="hs-comment">-- | Data.List style left-to-right scan without an initial value (aka inclusive</span><span>
</span><a name="line-326"></a><span class="hs-comment">-- scan).  Again, the first argument needs to be an /associative/ function.</span><span>
</span><a name="line-327"></a><span class="hs-comment">-- Denotationally, we have</span><span>
</span><a name="line-328"></a><span class="hs-comment">--</span><span>
</span><a name="line-329"></a><span class="hs-comment">-- &gt; scanl1 f e arr = tail (scanl f e arr)</span><span>
</span><a name="line-330"></a><span class="hs-comment">--</span><span>
</span><a name="line-331"></a><span class="hs-identifier">scanl1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500117"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-332"></a><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500117"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500117"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500117"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-333"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Vector"><span class="hs-identifier hs-type">Vector</span></a><span> </span><a href="#local-1630500117"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-334"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Vector"><span class="hs-identifier hs-type">Vector</span></a><span> </span><a href="#local-1630500117"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-335"></a><a name="scanl1"><a href="Data.Array.Accelerate.Language.html#scanl1"><span class="hs-identifier">scanl1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Scanl1"><span class="hs-identifier hs-var">Scanl1</span></a><span>
</span><a name="line-336"></a><span>
</span><a name="line-337"></a><span class="hs-comment">-- | Right-to-left variant of 'scanl'.</span><span>
</span><a name="line-338"></a><span class="hs-comment">--</span><span>
</span><a name="line-339"></a><span class="hs-identifier">scanr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500116"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-340"></a><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500116"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500116"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500116"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-341"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500116"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-342"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Vector"><span class="hs-identifier hs-type">Vector</span></a><span> </span><a href="#local-1630500116"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-343"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Vector"><span class="hs-identifier hs-type">Vector</span></a><span> </span><a href="#local-1630500116"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-344"></a><a name="scanr"><a href="Data.Array.Accelerate.Language.html#scanr"><span class="hs-identifier">scanr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Scanr"><span class="hs-identifier hs-var">Scanr</span></a><span>
</span><a name="line-345"></a><span>
</span><a name="line-346"></a><span class="hs-comment">-- | Right-to-left variant of 'scanl''.</span><span>
</span><a name="line-347"></a><span class="hs-comment">--</span><span>
</span><a name="line-348"></a><span class="hs-identifier">scanr'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500115"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-349"></a><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500115"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500115"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500115"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-350"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500115"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-351"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Vector"><span class="hs-identifier hs-type">Vector</span></a><span> </span><a href="#local-1630500115"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-352"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Vector"><span class="hs-identifier hs-type">Vector</span></a><span> </span><a href="#local-1630500115"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a><span> </span><a href="#local-1630500115"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-353"></a><a name="scanr%27"><a href="Data.Array.Accelerate.Language.html#scanr%27"><span class="hs-identifier">scanr'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#unatup2"><span class="hs-identifier hs-var">unatup2</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Scanr%27"><span class="hs-identifier hs-var">Scanr'</span></a><span>
</span><a name="line-354"></a><span>
</span><a name="line-355"></a><span class="hs-comment">-- | Right-to-left variant of 'scanl1'.</span><span>
</span><a name="line-356"></a><span class="hs-comment">--</span><span>
</span><a name="line-357"></a><span class="hs-identifier">scanr1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500114"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-358"></a><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500114"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500114"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500114"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-359"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Vector"><span class="hs-identifier hs-type">Vector</span></a><span> </span><a href="#local-1630500114"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-360"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Vector"><span class="hs-identifier hs-type">Vector</span></a><span> </span><a href="#local-1630500114"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-361"></a><a name="scanr1"><a href="Data.Array.Accelerate.Language.html#scanr1"><span class="hs-identifier">scanr1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Scanr1"><span class="hs-identifier hs-var">Scanr1</span></a><span>
</span><a name="line-362"></a><span>
</span><a name="line-363"></a><span class="hs-comment">-- Permutations</span><span>
</span><a name="line-364"></a><span class="hs-comment">-- ------------</span><span>
</span><a name="line-365"></a><span>
</span><a name="line-366"></a><span class="hs-comment">-- | Forward permutation specified by an index mapping. The result array is</span><span>
</span><a name="line-367"></a><span class="hs-comment">-- initialised with the given defaults and any further values that are permuted</span><span>
</span><a name="line-368"></a><span class="hs-comment">-- into the result array are added to the current value using the given</span><span>
</span><a name="line-369"></a><span class="hs-comment">-- combination function.</span><span>
</span><a name="line-370"></a><span class="hs-comment">--</span><span>
</span><a name="line-371"></a><span class="hs-comment">-- The combination function must be /associative/ and /commutative/. Elements</span><span>
</span><a name="line-372"></a><span class="hs-comment">-- that are mapped to the magic value 'ignore' by the permutation function are</span><span>
</span><a name="line-373"></a><span class="hs-comment">-- dropped.</span><span>
</span><a name="line-374"></a><span class="hs-comment">--</span><span>
</span><a name="line-375"></a><span class="hs-identifier">permute</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500111"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500112"><span class="hs-identifier hs-type">ix'</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500113"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-376"></a><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500113"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500113"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500113"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- ^combination function</span><span>
</span><a name="line-377"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500112"><span class="hs-identifier hs-type">ix'</span></a><span> </span><a href="#local-1630500113"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>            </span><span class="hs-comment">-- ^array of default values</span><span>
</span><a name="line-378"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500111"><span class="hs-identifier hs-type">ix</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500112"><span class="hs-identifier hs-type">ix'</span></a><span class="hs-special">)</span><span>          </span><span class="hs-comment">-- ^permutation</span><span>
</span><a name="line-379"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500111"><span class="hs-identifier hs-type">ix</span></a><span>  </span><a href="#local-1630500113"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>            </span><span class="hs-comment">-- ^array to be permuted</span><span>
</span><a name="line-380"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500112"><span class="hs-identifier hs-type">ix'</span></a><span> </span><a href="#local-1630500113"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-381"></a><a name="permute"><a href="Data.Array.Accelerate.Language.html#permute"><span class="hs-identifier">permute</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24%24"><span class="hs-operator hs-var">$$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Permute"><span class="hs-identifier hs-var">Permute</span></a><span>
</span><a name="line-382"></a><span>
</span><a name="line-383"></a><span class="hs-comment">-- | Backward permutation specified by an index mapping from the destination</span><span>
</span><a name="line-384"></a><span class="hs-comment">-- array specifying which element of the source array to read.</span><span>
</span><a name="line-385"></a><span class="hs-comment">--</span><span>
</span><a name="line-386"></a><span class="hs-identifier">backpermute</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500108"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500109"><span class="hs-identifier hs-type">ix'</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500110"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-387"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500109"><span class="hs-identifier hs-type">ix'</span></a><span>                  </span><span class="hs-comment">-- ^shape of the result array</span><span>
</span><a name="line-388"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500109"><span class="hs-identifier hs-type">ix'</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500108"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">)</span><span>      </span><span class="hs-comment">-- ^permutation</span><span>
</span><a name="line-389"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500108"><span class="hs-identifier hs-type">ix</span></a><span>  </span><a href="#local-1630500110"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>        </span><span class="hs-comment">-- ^source array</span><span>
</span><a name="line-390"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500109"><span class="hs-identifier hs-type">ix'</span></a><span> </span><a href="#local-1630500110"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-391"></a><a name="backpermute"><a href="Data.Array.Accelerate.Language.html#backpermute"><span class="hs-identifier">backpermute</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Backpermute"><span class="hs-identifier hs-var">Backpermute</span></a><span>
</span><a name="line-392"></a><span>
</span><a name="line-393"></a><span class="hs-comment">-- Stencil operations</span><span>
</span><a name="line-394"></a><span class="hs-comment">-- ------------------</span><span>
</span><a name="line-395"></a><span>
</span><a name="line-396"></a><span class="hs-comment">-- Common stencil types</span><span>
</span><a name="line-397"></a><span class="hs-comment">--</span><span>
</span><a name="line-398"></a><span>
</span><a name="line-399"></a><span class="hs-comment">-- DIM1 stencil type</span><span>
</span><a name="line-400"></a><span class="hs-keyword">type</span><span> </span><a name="Stencil3"><a href="Data.Array.Accelerate.Language.html#Stencil3"><span class="hs-identifier">Stencil3</span></a></a><span> </span><a name="local-1630500045"><a href="#local-1630500045"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500045"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500045"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500045"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-401"></a><span class="hs-keyword">type</span><span> </span><a name="Stencil5"><a href="Data.Array.Accelerate.Language.html#Stencil5"><span class="hs-identifier">Stencil5</span></a></a><span> </span><a name="local-1630500044"><a href="#local-1630500044"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500044"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500044"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500044"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500044"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500044"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-402"></a><span class="hs-keyword">type</span><span> </span><a name="Stencil7"><a href="Data.Array.Accelerate.Language.html#Stencil7"><span class="hs-identifier">Stencil7</span></a></a><span> </span><a name="local-1630500043"><a href="#local-1630500043"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500043"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500043"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500043"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500043"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500043"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500043"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500043"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-403"></a><span class="hs-keyword">type</span><span> </span><a name="Stencil9"><a href="Data.Array.Accelerate.Language.html#Stencil9"><span class="hs-identifier">Stencil9</span></a></a><span> </span><a name="local-1630500042"><a href="#local-1630500042"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500042"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500042"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500042"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500042"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500042"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500042"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500042"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500042"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500042"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-404"></a><span>
</span><a name="line-405"></a><span class="hs-comment">-- DIM2 stencil type</span><span>
</span><a name="line-406"></a><span class="hs-keyword">type</span><span> </span><a name="Stencil3x3"><a href="Data.Array.Accelerate.Language.html#Stencil3x3"><span class="hs-identifier">Stencil3x3</span></a></a><span> </span><a name="local-1630500041"><a href="#local-1630500041"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Language.html#Stencil3"><span class="hs-identifier hs-type">Stencil3</span></a><span> </span><a href="#local-1630500041"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3"><span class="hs-identifier hs-type">Stencil3</span></a><span> </span><a href="#local-1630500041"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3"><span class="hs-identifier hs-type">Stencil3</span></a><span> </span><a href="#local-1630500041"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-407"></a><span class="hs-keyword">type</span><span> </span><a name="Stencil5x3"><a href="Data.Array.Accelerate.Language.html#Stencil5x3"><span class="hs-identifier">Stencil5x3</span></a></a><span> </span><a name="local-1630500040"><a href="#local-1630500040"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Language.html#Stencil5"><span class="hs-identifier hs-type">Stencil5</span></a><span> </span><a href="#local-1630500040"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5"><span class="hs-identifier hs-type">Stencil5</span></a><span> </span><a href="#local-1630500040"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5"><span class="hs-identifier hs-type">Stencil5</span></a><span> </span><a href="#local-1630500040"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-408"></a><span class="hs-keyword">type</span><span> </span><a name="Stencil3x5"><a href="Data.Array.Accelerate.Language.html#Stencil3x5"><span class="hs-identifier">Stencil3x5</span></a></a><span> </span><a name="local-1630500039"><a href="#local-1630500039"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Language.html#Stencil3"><span class="hs-identifier hs-type">Stencil3</span></a><span> </span><a href="#local-1630500039"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3"><span class="hs-identifier hs-type">Stencil3</span></a><span> </span><a href="#local-1630500039"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3"><span class="hs-identifier hs-type">Stencil3</span></a><span> </span><a href="#local-1630500039"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3"><span class="hs-identifier hs-type">Stencil3</span></a><span> </span><a href="#local-1630500039"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3"><span class="hs-identifier hs-type">Stencil3</span></a><span> </span><a href="#local-1630500039"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-409"></a><span class="hs-keyword">type</span><span> </span><a name="Stencil5x5"><a href="Data.Array.Accelerate.Language.html#Stencil5x5"><span class="hs-identifier">Stencil5x5</span></a></a><span> </span><a name="local-1630500038"><a href="#local-1630500038"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Language.html#Stencil5"><span class="hs-identifier hs-type">Stencil5</span></a><span> </span><a href="#local-1630500038"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5"><span class="hs-identifier hs-type">Stencil5</span></a><span> </span><a href="#local-1630500038"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5"><span class="hs-identifier hs-type">Stencil5</span></a><span> </span><a href="#local-1630500038"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5"><span class="hs-identifier hs-type">Stencil5</span></a><span> </span><a href="#local-1630500038"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5"><span class="hs-identifier hs-type">Stencil5</span></a><span> </span><a href="#local-1630500038"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-410"></a><span>
</span><a name="line-411"></a><span class="hs-comment">-- DIM3 stencil type</span><span>
</span><a name="line-412"></a><span class="hs-keyword">type</span><span> </span><a name="Stencil3x3x3"><a href="Data.Array.Accelerate.Language.html#Stencil3x3x3"><span class="hs-identifier">Stencil3x3x3</span></a></a><span> </span><a name="local-1630500037"><a href="#local-1630500037"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Language.html#Stencil3x3"><span class="hs-identifier hs-type">Stencil3x3</span></a><span> </span><a href="#local-1630500037"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3x3"><span class="hs-identifier hs-type">Stencil3x3</span></a><span> </span><a href="#local-1630500037"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3x3"><span class="hs-identifier hs-type">Stencil3x3</span></a><span> </span><a href="#local-1630500037"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-413"></a><span class="hs-keyword">type</span><span> </span><a name="Stencil5x3x3"><a href="Data.Array.Accelerate.Language.html#Stencil5x3x3"><span class="hs-identifier">Stencil5x3x3</span></a></a><span> </span><a name="local-1630500036"><a href="#local-1630500036"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Language.html#Stencil5x3"><span class="hs-identifier hs-type">Stencil5x3</span></a><span> </span><a href="#local-1630500036"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5x3"><span class="hs-identifier hs-type">Stencil5x3</span></a><span> </span><a href="#local-1630500036"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5x3"><span class="hs-identifier hs-type">Stencil5x3</span></a><span> </span><a href="#local-1630500036"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-414"></a><span class="hs-keyword">type</span><span> </span><a name="Stencil3x5x3"><a href="Data.Array.Accelerate.Language.html#Stencil3x5x3"><span class="hs-identifier">Stencil3x5x3</span></a></a><span> </span><a name="local-1630500035"><a href="#local-1630500035"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Language.html#Stencil3x5"><span class="hs-identifier hs-type">Stencil3x5</span></a><span> </span><a href="#local-1630500035"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3x5"><span class="hs-identifier hs-type">Stencil3x5</span></a><span> </span><a href="#local-1630500035"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3x5"><span class="hs-identifier hs-type">Stencil3x5</span></a><span> </span><a href="#local-1630500035"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-415"></a><span class="hs-keyword">type</span><span> </span><a name="Stencil3x3x5"><a href="Data.Array.Accelerate.Language.html#Stencil3x3x5"><span class="hs-identifier">Stencil3x3x5</span></a></a><span> </span><a name="local-1630500034"><a href="#local-1630500034"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Language.html#Stencil3x3"><span class="hs-identifier hs-type">Stencil3x3</span></a><span> </span><a href="#local-1630500034"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3x3"><span class="hs-identifier hs-type">Stencil3x3</span></a><span> </span><a href="#local-1630500034"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3x3"><span class="hs-identifier hs-type">Stencil3x3</span></a><span> </span><a href="#local-1630500034"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3x3"><span class="hs-identifier hs-type">Stencil3x3</span></a><span> </span><a href="#local-1630500034"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3x3"><span class="hs-identifier hs-type">Stencil3x3</span></a><span> </span><a href="#local-1630500034"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-416"></a><span class="hs-keyword">type</span><span> </span><a name="Stencil5x5x3"><a href="Data.Array.Accelerate.Language.html#Stencil5x5x3"><span class="hs-identifier">Stencil5x5x3</span></a></a><span> </span><a name="local-1630500033"><a href="#local-1630500033"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Language.html#Stencil5x5"><span class="hs-identifier hs-type">Stencil5x5</span></a><span> </span><a href="#local-1630500033"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5x5"><span class="hs-identifier hs-type">Stencil5x5</span></a><span> </span><a href="#local-1630500033"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5x5"><span class="hs-identifier hs-type">Stencil5x5</span></a><span> </span><a href="#local-1630500033"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span class="hs-keyword">type</span><span> </span><a name="Stencil5x3x5"><a href="Data.Array.Accelerate.Language.html#Stencil5x3x5"><span class="hs-identifier">Stencil5x3x5</span></a></a><span> </span><a name="local-1630500032"><a href="#local-1630500032"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Language.html#Stencil5x3"><span class="hs-identifier hs-type">Stencil5x3</span></a><span> </span><a href="#local-1630500032"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5x3"><span class="hs-identifier hs-type">Stencil5x3</span></a><span> </span><a href="#local-1630500032"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5x3"><span class="hs-identifier hs-type">Stencil5x3</span></a><span> </span><a href="#local-1630500032"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5x3"><span class="hs-identifier hs-type">Stencil5x3</span></a><span> </span><a href="#local-1630500032"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5x3"><span class="hs-identifier hs-type">Stencil5x3</span></a><span> </span><a href="#local-1630500032"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-418"></a><span class="hs-keyword">type</span><span> </span><a name="Stencil3x5x5"><a href="Data.Array.Accelerate.Language.html#Stencil3x5x5"><span class="hs-identifier">Stencil3x5x5</span></a></a><span> </span><a name="local-1630500031"><a href="#local-1630500031"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Language.html#Stencil3x5"><span class="hs-identifier hs-type">Stencil3x5</span></a><span> </span><a href="#local-1630500031"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3x5"><span class="hs-identifier hs-type">Stencil3x5</span></a><span> </span><a href="#local-1630500031"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3x5"><span class="hs-identifier hs-type">Stencil3x5</span></a><span> </span><a href="#local-1630500031"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3x5"><span class="hs-identifier hs-type">Stencil3x5</span></a><span> </span><a href="#local-1630500031"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil3x5"><span class="hs-identifier hs-type">Stencil3x5</span></a><span> </span><a href="#local-1630500031"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-419"></a><span class="hs-keyword">type</span><span> </span><a name="Stencil5x5x5"><a href="Data.Array.Accelerate.Language.html#Stencil5x5x5"><span class="hs-identifier">Stencil5x5x5</span></a></a><span> </span><a name="local-1630500030"><a href="#local-1630500030"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Language.html#Stencil5x5"><span class="hs-identifier hs-type">Stencil5x5</span></a><span> </span><a href="#local-1630500030"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5x5"><span class="hs-identifier hs-type">Stencil5x5</span></a><span> </span><a href="#local-1630500030"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5x5"><span class="hs-identifier hs-type">Stencil5x5</span></a><span> </span><a href="#local-1630500030"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5x5"><span class="hs-identifier hs-type">Stencil5x5</span></a><span> </span><a href="#local-1630500030"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Language.html#Stencil5x5"><span class="hs-identifier hs-type">Stencil5x5</span></a><span> </span><a href="#local-1630500030"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-420"></a><span>
</span><a name="line-421"></a><span>
</span><a name="line-422"></a><span class="hs-comment">-- |Map a stencil over an array.  In contrast to 'map', the domain of a stencil function is an</span><span>
</span><a name="line-423"></a><span class="hs-comment">--  entire /neighbourhood/ of each array element.  Neighbourhoods are sub-arrays centred around a</span><span>
</span><a name="line-424"></a><span class="hs-comment">--  focal point.  They are not necessarily rectangular, but they are symmetric in each dimension</span><span>
</span><a name="line-425"></a><span class="hs-comment">--  and have an extent of at least three in each dimensions &#8212; due to the symmetry requirement, the</span><span>
</span><a name="line-426"></a><span class="hs-comment">--  extent is necessarily odd.  The focal point is the array position that is determined by the</span><span>
</span><a name="line-427"></a><span class="hs-comment">--  stencil.</span><span>
</span><a name="line-428"></a><span class="hs-comment">--</span><span>
</span><a name="line-429"></a><span class="hs-comment">--  For those array positions where the neighbourhood extends past the boundaries of the source</span><span>
</span><a name="line-430"></a><span class="hs-comment">--  array, a boundary condition determines the contents of the out-of-bounds neighbourhood</span><span>
</span><a name="line-431"></a><span class="hs-comment">--  positions.</span><span>
</span><a name="line-432"></a><span class="hs-comment">--</span><span>
</span><a name="line-433"></a><span class="hs-identifier">stencil</span><span>
</span><a name="line-434"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Stencil"><span class="hs-identifier hs-type">Stencil</span></a><span> </span><a href="#local-1630500104"><span class="hs-identifier hs-type">sh</span></a><span> </span><a href="#local-1630500105"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1630500106"><span class="hs-identifier hs-type">stencil</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500107"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-435"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1630500106"><span class="hs-identifier hs-type">stencil</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500107"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>                     </span><span class="hs-comment">-- ^ stencil function</span><span>
</span><a name="line-436"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Type.html#Boundary"><span class="hs-identifier hs-type">Boundary</span></a><span> </span><a href="#local-1630500105"><span class="hs-identifier hs-type">a</span></a><span>                             </span><span class="hs-comment">-- ^ boundary condition</span><span>
</span><a name="line-437"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500104"><span class="hs-identifier hs-type">sh</span></a><span> </span><a href="#local-1630500105"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>                       </span><span class="hs-comment">-- ^ source array</span><span>
</span><a name="line-438"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500104"><span class="hs-identifier hs-type">sh</span></a><span> </span><a href="#local-1630500107"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>                       </span><span class="hs-comment">-- ^ destination array</span><span>
</span><a name="line-439"></a><a name="stencil"><a href="Data.Array.Accelerate.Language.html#stencil"><span class="hs-identifier">stencil</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Stencil"><span class="hs-identifier hs-var">Stencil</span></a><span>
</span><a name="line-440"></a><span>
</span><a name="line-441"></a><span class="hs-comment">-- | Map a binary stencil of an array.  The extent of the resulting array is the</span><span>
</span><a name="line-442"></a><span class="hs-comment">-- intersection of the extents of the two source arrays.</span><span>
</span><a name="line-443"></a><span class="hs-comment">--</span><span>
</span><a name="line-444"></a><span class="hs-identifier">stencil2</span><span>
</span><a name="line-445"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Stencil"><span class="hs-identifier hs-type">Stencil</span></a><span> </span><a href="#local-1630500098"><span class="hs-identifier hs-type">sh</span></a><span> </span><a href="#local-1630500099"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1630500100"><span class="hs-identifier hs-type">stencil1</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Stencil"><span class="hs-identifier hs-type">Stencil</span></a><span> </span><a href="#local-1630500098"><span class="hs-identifier hs-type">sh</span></a><span> </span><a href="#local-1630500101"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-1630500102"><span class="hs-identifier hs-type">stencil2</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500103"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-446"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1630500100"><span class="hs-identifier hs-type">stencil1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1630500102"><span class="hs-identifier hs-type">stencil2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500103"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>        </span><span class="hs-comment">-- ^ binary stencil function</span><span>
</span><a name="line-447"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Type.html#Boundary"><span class="hs-identifier hs-type">Boundary</span></a><span> </span><a href="#local-1630500099"><span class="hs-identifier hs-type">a</span></a><span>                             </span><span class="hs-comment">-- ^ boundary condition #1</span><span>
</span><a name="line-448"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500098"><span class="hs-identifier hs-type">sh</span></a><span> </span><a href="#local-1630500099"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>                       </span><span class="hs-comment">-- ^ source array #1</span><span>
</span><a name="line-449"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Type.html#Boundary"><span class="hs-identifier hs-type">Boundary</span></a><span> </span><a href="#local-1630500101"><span class="hs-identifier hs-type">b</span></a><span>                             </span><span class="hs-comment">-- ^ boundary condition #2</span><span>
</span><a name="line-450"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500098"><span class="hs-identifier hs-type">sh</span></a><span> </span><a href="#local-1630500101"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>                       </span><span class="hs-comment">-- ^ source array #2</span><span>
</span><a name="line-451"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500098"><span class="hs-identifier hs-type">sh</span></a><span> </span><a href="#local-1630500103"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>                       </span><span class="hs-comment">-- ^ destination array</span><span>
</span><a name="line-452"></a><a name="stencil2"><a href="Data.Array.Accelerate.Language.html#stencil2"><span class="hs-identifier">stencil2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24%24%24"><span class="hs-operator hs-var">$$$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Stencil2"><span class="hs-identifier hs-var">Stencil2</span></a><span>
</span><a name="line-453"></a><span>
</span><a name="line-454"></a><span>
</span><a name="line-455"></a><span class="hs-comment">-- Sequence operations</span><span>
</span><a name="line-456"></a><span class="hs-comment">-- ------------------</span><span>
</span><a name="line-457"></a><span>
</span><a name="line-458"></a><span class="hs-comment">-- Common sequence types</span><span>
</span><a name="line-459"></a><span class="hs-comment">--</span><span>
</span><a name="line-460"></a><span>
</span><a name="line-461"></a><span class="hs-identifier">streamIn</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Arrays"><span class="hs-identifier hs-type">Arrays</span></a><span> </span><a href="#local-1630500097"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-462"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1630500097"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-463"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><span class="hs-special">[</span><a href="#local-1630500097"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-464"></a><a name="streamIn"><a href="Data.Array.Accelerate.Language.html#streamIn"><span class="hs-identifier">streamIn</span></a></a><span> </span><a name="local-1630500148"><a href="#local-1630500148"><span class="hs-identifier">arrs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#StreamIn"><span class="hs-identifier hs-var">StreamIn</span></a><span> </span><a href="#local-1630500148"><span class="hs-identifier hs-var">arrs</span></a><span class="hs-special">)</span><span>
</span><a name="line-465"></a><span>
</span><a name="line-466"></a><span class="hs-comment">-- | Convert the given array to a sequence by dividing the array up into subarrays.</span><span>
</span><a name="line-467"></a><span class="hs-comment">-- The first argument captures how to the division should be performed. The</span><span>
</span><a name="line-468"></a><span class="hs-comment">-- presence of `All` in the division descriptor indicates that elements in the</span><span>
</span><a name="line-469"></a><span class="hs-comment">-- corresponding dimension should be retained in the subarrays, whereas `Split`</span><span>
</span><a name="line-470"></a><span class="hs-comment">-- indicates that the input array should divided along this dimension.</span><span>
</span><a name="line-471"></a><span class="hs-comment">--</span><span>
</span><a name="line-472"></a><span class="hs-identifier">toSeq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Division"><span class="hs-identifier hs-type">Division</span></a><span> </span><a href="#local-1630500095"><span class="hs-identifier hs-type">slsix</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500096"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-473"></a><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1630500095"><span class="hs-identifier hs-type">slsix</span></a><span>
</span><a name="line-474"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#FullShape"><span class="hs-identifier hs-type">FullShape</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#DivisionSlice"><span class="hs-identifier hs-type">DivisionSlice</span></a><span> </span><a href="#local-1630500095"><span class="hs-identifier hs-type">slsix</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1630500096"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-475"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><span class="hs-special">[</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#SliceShape"><span class="hs-identifier hs-type">SliceShape</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#DivisionSlice"><span class="hs-identifier hs-type">DivisionSlice</span></a><span> </span><a href="#local-1630500095"><span class="hs-identifier hs-type">slsix</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1630500096"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-476"></a><a name="toSeq"><a href="Data.Array.Accelerate.Language.html#toSeq"><span class="hs-identifier">toSeq</span></a></a><span> </span><a name="local-1630500149"><a href="#local-1630500149"><span class="hs-identifier">spec</span></a></a><span> </span><a name="local-1630500150"><a href="#local-1630500150"><span class="hs-identifier">acc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#ToSeq"><span class="hs-identifier hs-var">ToSeq</span></a><span> </span><a href="#local-1630500149"><span class="hs-identifier hs-var">spec</span></a><span> </span><a href="#local-1630500150"><span class="hs-identifier hs-var">acc</span></a><span class="hs-special">)</span><span>
</span><a name="line-477"></a><span>
</span><a name="line-478"></a><span class="hs-comment">-- | Apply the given array function element-wise to the given sequence.</span><span>
</span><a name="line-479"></a><span class="hs-comment">--</span><span>
</span><a name="line-480"></a><span class="hs-identifier">mapSeq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Arrays"><span class="hs-identifier hs-type">Arrays</span></a><span> </span><a href="#local-1630500093"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Arrays"><span class="hs-identifier hs-type">Arrays</span></a><span> </span><a href="#local-1630500094"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-481"></a><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500093"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500094"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-482"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><span class="hs-special">[</span><a href="#local-1630500093"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-483"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><span class="hs-special">[</span><a href="#local-1630500094"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-484"></a><a name="mapSeq"><a href="Data.Array.Accelerate.Language.html#mapSeq"><span class="hs-identifier">mapSeq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#MapSeq"><span class="hs-identifier hs-var">MapSeq</span></a><span>
</span><a name="line-485"></a><span>
</span><a name="line-486"></a><span class="hs-comment">-- | Apply the given binary function element-wise to the two sequences.  The length of the resulting</span><span>
</span><a name="line-487"></a><span class="hs-comment">-- sequence is the minumum of the lengths of the two source sequences.</span><span>
</span><a name="line-488"></a><span class="hs-comment">--</span><span>
</span><a name="line-489"></a><span class="hs-identifier">zipWithSeq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Arrays"><span class="hs-identifier hs-type">Arrays</span></a><span> </span><a href="#local-1630500090"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Arrays"><span class="hs-identifier hs-type">Arrays</span></a><span> </span><a href="#local-1630500091"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Arrays"><span class="hs-identifier hs-type">Arrays</span></a><span> </span><a href="#local-1630500092"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-490"></a><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500090"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500091"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500092"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-491"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><span class="hs-special">[</span><a href="#local-1630500090"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-492"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><span class="hs-special">[</span><a href="#local-1630500091"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-493"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><span class="hs-special">[</span><a href="#local-1630500092"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span>
</span><a name="line-494"></a><a name="zipWithSeq"><a href="Data.Array.Accelerate.Language.html#zipWithSeq"><span class="hs-identifier">zipWithSeq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#ZipWithSeq"><span class="hs-identifier hs-var">ZipWithSeq</span></a><span>
</span><a name="line-495"></a><span>
</span><a name="line-496"></a><span class="hs-comment">-- | scanSeq (+) a0 x seq. Scan a sequence x by combining each</span><span>
</span><a name="line-497"></a><span class="hs-comment">-- element using the given binary operation (+). (+) must be</span><span>
</span><a name="line-498"></a><span class="hs-comment">-- associative:</span><span>
</span><a name="line-499"></a><span class="hs-comment">--</span><span>
</span><a name="line-500"></a><span class="hs-comment">--   Forall a b c. (a + b) + c = a + (b + c),</span><span>
</span><a name="line-501"></a><span class="hs-comment">--</span><span>
</span><a name="line-502"></a><span class="hs-comment">-- and a0 must be the identity element for (+):</span><span>
</span><a name="line-503"></a><span class="hs-comment">--</span><span>
</span><a name="line-504"></a><span class="hs-comment">--   Forall a. a0 + a = a = a + a0.</span><span>
</span><a name="line-505"></a><span class="hs-comment">--</span><span>
</span><a name="line-506"></a><span class="hs-identifier">scanSeq</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500089"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-507"></a><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500089"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500089"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500089"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-508"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500089"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-509"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><span class="hs-special">[</span><a href="Data.Array.Accelerate.Array.Sugar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a><span> </span><a href="#local-1630500089"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-510"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><span class="hs-special">[</span><a href="Data.Array.Accelerate.Array.Sugar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a><span> </span><a href="#local-1630500089"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-511"></a><a name="scanSeq"><a href="Data.Array.Accelerate.Language.html#scanSeq"><span class="hs-identifier">scanSeq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#ScanSeq"><span class="hs-identifier hs-var">ScanSeq</span></a><span>
</span><a name="line-512"></a><span>
</span><a name="line-513"></a><span class="hs-comment">-- | foldSeq (+) a0 x seq. Fold a sequence x by combining each</span><span>
</span><a name="line-514"></a><span class="hs-comment">-- element using the given binary operation (+). (+) must be</span><span>
</span><a name="line-515"></a><span class="hs-comment">-- associative:</span><span>
</span><a name="line-516"></a><span class="hs-comment">--</span><span>
</span><a name="line-517"></a><span class="hs-comment">--   Forall a b c. (a + b) + c = a + (b + c),</span><span>
</span><a name="line-518"></a><span class="hs-comment">--</span><span>
</span><a name="line-519"></a><span class="hs-comment">-- and a0 must be the identity element for (+):</span><span>
</span><a name="line-520"></a><span class="hs-comment">--</span><span>
</span><a name="line-521"></a><span class="hs-comment">--   Forall a. a0 + a = a = a + a0.</span><span>
</span><a name="line-522"></a><span class="hs-comment">--</span><span>
</span><a name="line-523"></a><span class="hs-identifier">foldSeq</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500088"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-524"></a><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500088"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500088"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500088"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-525"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500088"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-526"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><span class="hs-special">[</span><a href="Data.Array.Accelerate.Array.Sugar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a><span> </span><a href="#local-1630500088"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-527"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a><span> </span><a href="#local-1630500088"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-528"></a><a name="foldSeq"><a href="Data.Array.Accelerate.Language.html#foldSeq"><span class="hs-identifier">foldSeq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#FoldSeq"><span class="hs-identifier hs-var">FoldSeq</span></a><span>
</span><a name="line-529"></a><span>
</span><a name="line-530"></a><span class="hs-comment">-- | foldSeqFlatten f a0 x seq. A specialized version of</span><span>
</span><a name="line-531"></a><span class="hs-comment">-- FoldSeqAct where reduction with the companion operator</span><span>
</span><a name="line-532"></a><span class="hs-comment">-- corresponds to flattening. f must be semi-associative, with vecotor</span><span>
</span><a name="line-533"></a><span class="hs-comment">-- append (++) as the companion operator:</span><span>
</span><a name="line-534"></a><span class="hs-comment">--</span><span>
</span><a name="line-535"></a><span class="hs-comment">--   Forall b sh1 a1 sh2 a2.</span><span>
</span><a name="line-536"></a><span class="hs-comment">--     f (f b sh1 a1) sh2 a2 = f b (sh1 ++ sh2) (a1 ++ a2).</span><span>
</span><a name="line-537"></a><span class="hs-comment">--</span><span>
</span><a name="line-538"></a><span class="hs-comment">-- It is common to ignore the shape vectors, yielding the usual</span><span>
</span><a name="line-539"></a><span class="hs-comment">-- semi-associativity law:</span><span>
</span><a name="line-540"></a><span class="hs-comment">--</span><span>
</span><a name="line-541"></a><span class="hs-comment">--   f b a _ = b + a,</span><span>
</span><a name="line-542"></a><span class="hs-comment">--</span><span>
</span><a name="line-543"></a><span class="hs-comment">-- for some (+) satisfying:</span><span>
</span><a name="line-544"></a><span class="hs-comment">--</span><span>
</span><a name="line-545"></a><span class="hs-comment">--   Forall b a1 a2. (b + a1) + a2 = b + (a1 ++ a2).</span><span>
</span><a name="line-546"></a><span class="hs-comment">--</span><span>
</span><a name="line-547"></a><span class="hs-identifier">foldSeqFlatten</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Arrays"><span class="hs-identifier hs-type">Arrays</span></a><span> </span><a href="#local-1630500085"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500086"><span class="hs-identifier hs-type">jx</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500087"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-548"></a><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500085"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Vector"><span class="hs-identifier hs-type">Vector</span></a><span> </span><a href="#local-1630500086"><span class="hs-identifier hs-type">jx</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Vector"><span class="hs-identifier hs-type">Vector</span></a><span> </span><a href="#local-1630500087"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500085"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-549"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500085"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-550"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><span class="hs-special">[</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500086"><span class="hs-identifier hs-type">jx</span></a><span> </span><a href="#local-1630500087"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-551"></a><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-1630500085"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-552"></a><a name="foldSeqFlatten"><a href="Data.Array.Accelerate.Language.html#foldSeqFlatten"><span class="hs-identifier">foldSeqFlatten</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-var">Seq</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#FoldSeqFlatten"><span class="hs-identifier hs-var">FoldSeqFlatten</span></a><span>
</span><a name="line-553"></a><span>
</span><a name="line-554"></a><span class="hs-identifier">collect</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Arrays"><span class="hs-identifier hs-type">Arrays</span></a><span> </span><a href="#local-1630500084"><span class="hs-identifier hs-type">arrs</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Seq"><span class="hs-identifier hs-type">Seq</span></a><span> </span><a href="#local-1630500084"><span class="hs-identifier hs-type">arrs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500084"><span class="hs-identifier hs-type">arrs</span></a><span>
</span><a name="line-555"></a><a name="collect"><a href="Data.Array.Accelerate.Language.html#collect"><span class="hs-identifier">collect</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Collect"><span class="hs-identifier hs-var">Collect</span></a><span>
</span><a name="line-556"></a><span>
</span><a name="line-557"></a><span class="hs-comment">-- Foreign function calling</span><span>
</span><a name="line-558"></a><span class="hs-comment">-- ------------------------</span><span>
</span><a name="line-559"></a><span>
</span><a name="line-560"></a><span class="hs-comment">-- | Call a foreign array function.</span><span>
</span><a name="line-561"></a><span class="hs-comment">--</span><span>
</span><a name="line-562"></a><span class="hs-comment">-- The form the first argument takes is dependent on the backend being targeted.</span><span>
</span><a name="line-563"></a><span class="hs-comment">-- Note that the foreign function only has access to the input array(s) passed</span><span>
</span><a name="line-564"></a><span class="hs-comment">-- in as its argument.</span><span>
</span><a name="line-565"></a><span class="hs-comment">--</span><span>
</span><a name="line-566"></a><span class="hs-comment">-- In case the operation is being executed on a backend which does not support</span><span>
</span><a name="line-567"></a><span class="hs-comment">-- this foreign implementation, the fallback implementation is used instead,</span><span>
</span><a name="line-568"></a><span class="hs-comment">-- which itself could be a foreign implementation for a (presumably) different</span><span>
</span><a name="line-569"></a><span class="hs-comment">-- backend, or an implementation of pure Accelerate. In this way, multiple</span><span>
</span><a name="line-570"></a><span class="hs-comment">-- foreign implementations can be supplied, and will be tested for suitability</span><span>
</span><a name="line-571"></a><span class="hs-comment">-- against the target backend in sequence.</span><span>
</span><a name="line-572"></a><span class="hs-comment">--</span><span>
</span><a name="line-573"></a><span class="hs-identifier">foreignAcc</span><span>
</span><a name="line-574"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Arrays"><span class="hs-identifier hs-type">Arrays</span></a><span> </span><span class="hs-keyword">as</span><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Arrays"><span class="hs-identifier hs-type">Arrays</span></a><span> </span><a href="#local-1630500082"><span class="hs-identifier hs-type">bs</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Foreign"><span class="hs-identifier hs-type">Foreign</span></a><span> </span><a href="#local-1630500083"><span class="hs-identifier hs-type">asm</span></a><span class="hs-special">)</span><span>
</span><a name="line-575"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1630500083"><span class="hs-identifier hs-type">asm</span></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1630500082"><span class="hs-identifier hs-type">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-576"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500082"><span class="hs-identifier hs-type">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-577"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-578"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500082"><span class="hs-identifier hs-type">bs</span></a><span>
</span><a name="line-579"></a><a name="foreignAcc"><a href="Data.Array.Accelerate.Language.html#foreignAcc"><span class="hs-identifier">foreignAcc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Aforeign"><span class="hs-identifier hs-var">Aforeign</span></a><span>
</span><a name="line-580"></a><span>
</span><a name="line-581"></a><span class="hs-comment">-- | Call a foreign scalar expression.</span><span>
</span><a name="line-582"></a><span class="hs-comment">--</span><span>
</span><a name="line-583"></a><span class="hs-comment">-- The form of the first argument is dependent on the backend being targeted.</span><span>
</span><a name="line-584"></a><span class="hs-comment">-- Note that the foreign function only has access to the input element(s) passed</span><span>
</span><a name="line-585"></a><span class="hs-comment">-- in as its first argument.</span><span>
</span><a name="line-586"></a><span class="hs-comment">--</span><span>
</span><a name="line-587"></a><span class="hs-comment">-- As with 'foreignAcc', the fallback implementation itself may be a (sequence</span><span>
</span><a name="line-588"></a><span class="hs-comment">-- of) foreign implementation(s) for a different backend(s), or implemented</span><span>
</span><a name="line-589"></a><span class="hs-comment">-- purely in Accelerate.</span><span>
</span><a name="line-590"></a><span class="hs-comment">--</span><span>
</span><a name="line-591"></a><span class="hs-identifier">foreignExp</span><span>
</span><a name="line-592"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500078"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500079"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Foreign"><span class="hs-identifier hs-type">Foreign</span></a><span> </span><a href="#local-1630500080"><span class="hs-identifier hs-type">asm</span></a><span class="hs-special">)</span><span>
</span><a name="line-593"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1630500080"><span class="hs-identifier hs-type">asm</span></a><span> </span><span class="hs-special">(</span><a href="#local-1630500078"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1630500079"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-594"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500078"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500079"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-595"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500078"><span class="hs-identifier hs-type">x</span></a><span>
</span><a name="line-596"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500079"><span class="hs-identifier hs-type">y</span></a><span>
</span><a name="line-597"></a><a name="foreignExp"><a href="Data.Array.Accelerate.Language.html#foreignExp"><span class="hs-identifier">foreignExp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-var">Exp</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Foreign"><span class="hs-identifier hs-var">Foreign</span></a><span>
</span><a name="line-598"></a><span>
</span><a name="line-599"></a><span>
</span><a name="line-600"></a><span class="hs-comment">-- Composition of array computations</span><span>
</span><a name="line-601"></a><span class="hs-comment">-- ---------------------------------</span><span>
</span><a name="line-602"></a><span>
</span><a name="line-603"></a><span class="hs-comment">-- | Pipelining of two array computations.</span><span>
</span><a name="line-604"></a><span class="hs-comment">--</span><span>
</span><a name="line-605"></a><span class="hs-comment">-- Denotationally, we have</span><span>
</span><a name="line-606"></a><span class="hs-comment">--</span><span>
</span><a name="line-607"></a><span class="hs-comment">-- &gt; (acc1 &gt;-&gt; acc2) arrs = let tmp = acc1 arrs in acc2 tmp</span><span>
</span><a name="line-608"></a><span class="hs-comment">--</span><span>
</span><a name="line-609"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-operator">&gt;-&gt;</span><span>
</span><a name="line-610"></a><span class="hs-special">(</span><span class="hs-operator">&gt;-&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Arrays"><span class="hs-identifier hs-type">Arrays</span></a><span> </span><a href="#local-1630500075"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Arrays"><span class="hs-identifier hs-type">Arrays</span></a><span> </span><a href="#local-1630500076"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Arrays"><span class="hs-identifier hs-type">Arrays</span></a><span> </span><a href="#local-1630500077"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500075"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500076"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500076"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500077"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500075"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500077"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-611"></a><span class="hs-special">(</span><a name="%3E-%3E"><a href="Data.Array.Accelerate.Language.html#%3E-%3E"><span class="hs-operator">&gt;-&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Pipe"><span class="hs-identifier hs-var">Pipe</span></a><span>
</span><a name="line-612"></a><span>
</span><a name="line-613"></a><span>
</span><a name="line-614"></a><span class="hs-comment">-- Flow control constructs</span><span>
</span><a name="line-615"></a><span class="hs-comment">-- -----------------------</span><span>
</span><a name="line-616"></a><span>
</span><a name="line-617"></a><span class="hs-comment">-- | An array-level if-then-else construct.</span><span>
</span><a name="line-618"></a><span class="hs-comment">--</span><span>
</span><a name="line-619"></a><span class="hs-identifier">acond</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Arrays"><span class="hs-identifier hs-type">Arrays</span></a><span> </span><a href="#local-1630500074"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-620"></a><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>               </span><span class="hs-comment">-- ^ if-condition</span><span>
</span><a name="line-621"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500074"><span class="hs-identifier hs-type">a</span></a><span>                  </span><span class="hs-comment">-- ^ then-array</span><span>
</span><a name="line-622"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500074"><span class="hs-identifier hs-type">a</span></a><span>                  </span><span class="hs-comment">-- ^ else-array</span><span>
</span><a name="line-623"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500074"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-624"></a><a name="acond"><a href="Data.Array.Accelerate.Language.html#acond"><span class="hs-identifier">acond</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Acond"><span class="hs-identifier hs-var">Acond</span></a><span>
</span><a name="line-625"></a><span>
</span><a name="line-626"></a><span class="hs-comment">-- | An array-level 'while' construct. Continue to apply the given function,</span><span>
</span><a name="line-627"></a><span class="hs-comment">-- starting with the initial value, until the test function evaluates to</span><span>
</span><a name="line-628"></a><span class="hs-comment">-- 'False'.</span><span>
</span><a name="line-629"></a><span class="hs-comment">--</span><span>
</span><a name="line-630"></a><span class="hs-identifier">awhile</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Arrays"><span class="hs-identifier hs-type">Arrays</span></a><span> </span><a href="#local-1630500073"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-631"></a><span>       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500073"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- ^ keep evaluating while this returns 'True'</span><span>
</span><a name="line-632"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500073"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500073"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>                </span><span class="hs-comment">-- ^ function to apply</span><span>
</span><a name="line-633"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500073"><span class="hs-identifier hs-type">a</span></a><span>                           </span><span class="hs-comment">-- ^ initial value</span><span>
</span><a name="line-634"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><a href="#local-1630500073"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-635"></a><a name="awhile"><a href="Data.Array.Accelerate.Language.html#awhile"><span class="hs-identifier">awhile</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-var">Acc</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Awhile"><span class="hs-identifier hs-var">Awhile</span></a><span>
</span><a name="line-636"></a><span>
</span><a name="line-637"></a><span>
</span><a name="line-638"></a><span class="hs-comment">-- Shapes and indices</span><span>
</span><a name="line-639"></a><span class="hs-comment">-- ------------------</span><span>
</span><a name="line-640"></a><span>
</span><a name="line-641"></a><span class="hs-comment">-- | Get the outermost dimension of a shape</span><span>
</span><a name="line-642"></a><span class="hs-comment">--</span><span>
</span><a name="line-643"></a><span class="hs-identifier">indexHead</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Slice"><span class="hs-identifier hs-type">Slice</span></a><span> </span><a href="#local-1630500071"><span class="hs-identifier hs-type">sh</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500072"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-special">(</span><a href="#local-1630500071"><span class="hs-identifier hs-type">sh</span></a><span> </span><span class="hs-operator">:.</span><span> </span><a href="#local-1630500072"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500072"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-644"></a><a name="indexHead"><a href="Data.Array.Accelerate.Language.html#indexHead"><span class="hs-identifier">indexHead</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-var">Exp</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Array.Accelerate.Smart.html#IndexHead"><span class="hs-identifier hs-var">IndexHead</span></a><span>
</span><a name="line-645"></a><span>
</span><a name="line-646"></a><span class="hs-comment">-- | Get all but the outermost element of a shape</span><span>
</span><a name="line-647"></a><span class="hs-comment">--</span><span>
</span><a name="line-648"></a><span class="hs-identifier">indexTail</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Slice"><span class="hs-identifier hs-type">Slice</span></a><span> </span><a href="#local-1630500069"><span class="hs-identifier hs-type">sh</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500070"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-special">(</span><a href="#local-1630500069"><span class="hs-identifier hs-type">sh</span></a><span> </span><span class="hs-operator">:.</span><span> </span><a href="#local-1630500070"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500069"><span class="hs-identifier hs-type">sh</span></a><span>
</span><a name="line-649"></a><a name="indexTail"><a href="Data.Array.Accelerate.Language.html#indexTail"><span class="hs-identifier">indexTail</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-var">Exp</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Array.Accelerate.Smart.html#IndexTail"><span class="hs-identifier hs-var">IndexTail</span></a><span>
</span><a name="line-650"></a><span>
</span><a name="line-651"></a><span class="hs-comment">-- | Map a multi-dimensional index into a linear, row-major representation of an</span><span>
</span><a name="line-652"></a><span class="hs-comment">-- array. The first argument is the array shape, the second is the index.</span><span>
</span><a name="line-653"></a><span class="hs-comment">--</span><span>
</span><a name="line-654"></a><span class="hs-identifier">toIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500068"><span class="hs-identifier hs-type">sh</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500068"><span class="hs-identifier hs-type">sh</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500068"><span class="hs-identifier hs-type">sh</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-655"></a><a name="toIndex"><a href="Data.Array.Accelerate.Language.html#toIndex"><span class="hs-identifier">toIndex</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-var">Exp</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#ToIndex"><span class="hs-identifier hs-var">ToIndex</span></a><span>
</span><a name="line-656"></a><span>
</span><a name="line-657"></a><span class="hs-comment">-- | Inverse of 'toIndex'</span><span>
</span><a name="line-658"></a><span class="hs-comment">--</span><span>
</span><a name="line-659"></a><span class="hs-identifier">fromIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500067"><span class="hs-identifier hs-type">sh</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500067"><span class="hs-identifier hs-type">sh</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500067"><span class="hs-identifier hs-type">sh</span></a><span>
</span><a name="line-660"></a><a name="fromIndex"><a href="Data.Array.Accelerate.Language.html#fromIndex"><span class="hs-identifier">fromIndex</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-var">Exp</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#FromIndex"><span class="hs-identifier hs-var">FromIndex</span></a><span>
</span><a name="line-661"></a><span>
</span><a name="line-662"></a><span class="hs-comment">-- | Intersection of two shapes</span><span>
</span><a name="line-663"></a><span class="hs-comment">--</span><span>
</span><a name="line-664"></a><span class="hs-identifier">intersect</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500066"><span class="hs-identifier hs-type">sh</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500066"><span class="hs-identifier hs-type">sh</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500066"><span class="hs-identifier hs-type">sh</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500066"><span class="hs-identifier hs-type">sh</span></a><span>
</span><a name="line-665"></a><a name="intersect"><a href="Data.Array.Accelerate.Language.html#intersect"><span class="hs-identifier">intersect</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-var">Exp</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Intersect"><span class="hs-identifier hs-var">Intersect</span></a><span>
</span><a name="line-666"></a><span>
</span><a name="line-667"></a><span class="hs-comment">-- | Union of two shapes</span><span>
</span><a name="line-668"></a><span class="hs-comment">--</span><span>
</span><a name="line-669"></a><span class="hs-identifier">union</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500065"><span class="hs-identifier hs-type">sh</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500065"><span class="hs-identifier hs-type">sh</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500065"><span class="hs-identifier hs-type">sh</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500065"><span class="hs-identifier hs-type">sh</span></a><span>
</span><a name="line-670"></a><a name="union"><a href="Data.Array.Accelerate.Language.html#union"><span class="hs-identifier">union</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-var">Exp</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Union"><span class="hs-identifier hs-var">Union</span></a><span>
</span><a name="line-671"></a><span>
</span><a name="line-672"></a><span>
</span><a name="line-673"></a><span class="hs-comment">-- Flow-control</span><span>
</span><a name="line-674"></a><span class="hs-comment">-- ------------</span><span>
</span><a name="line-675"></a><span>
</span><a name="line-676"></a><span class="hs-comment">-- | A scalar-level if-then-else construct.</span><span>
</span><a name="line-677"></a><span class="hs-comment">--</span><span>
</span><a name="line-678"></a><span class="hs-identifier">cond</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500064"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-679"></a><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>                </span><span class="hs-comment">-- ^ condition</span><span>
</span><a name="line-680"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500064"><span class="hs-identifier hs-type">t</span></a><span>                   </span><span class="hs-comment">-- ^ then-expression</span><span>
</span><a name="line-681"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500064"><span class="hs-identifier hs-type">t</span></a><span>                   </span><span class="hs-comment">-- ^ else-expression</span><span>
</span><a name="line-682"></a><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500064"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-683"></a><a name="cond"><a href="Data.Array.Accelerate.Language.html#cond"><span class="hs-identifier">cond</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-var">Exp</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Cond"><span class="hs-identifier hs-var">Cond</span></a><span>
</span><a name="line-684"></a><span>
</span><a name="line-685"></a><span class="hs-comment">-- | While construct. Continue to apply the given function, starting with the</span><span>
</span><a name="line-686"></a><span class="hs-comment">-- initial value, until the test function evaluates to 'False'.</span><span>
</span><a name="line-687"></a><span class="hs-comment">--</span><span>
</span><a name="line-688"></a><span class="hs-identifier">while</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500063"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-689"></a><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500063"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- ^ keep evaluating while this returns 'True'</span><span>
</span><a name="line-690"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500063"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500063"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- ^ function to apply</span><span>
</span><a name="line-691"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500063"><span class="hs-identifier hs-type">e</span></a><span>                  </span><span class="hs-comment">-- ^ initial value</span><span>
</span><a name="line-692"></a><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500063"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-693"></a><a name="while"><a href="Data.Array.Accelerate.Language.html#while"><span class="hs-identifier">while</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-var">Exp</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24%24"><span class="hs-operator hs-var">$$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#While"><span class="hs-identifier hs-var">While</span></a><span>
</span><a name="line-694"></a><span>
</span><a name="line-695"></a><span>
</span><a name="line-696"></a><span class="hs-comment">-- Array operations with a scalar result</span><span>
</span><a name="line-697"></a><span class="hs-comment">-- -------------------------------------</span><span>
</span><a name="line-698"></a><span>
</span><a name="line-699"></a><span class="hs-comment">-- |Expression form that extracts a scalar from an array</span><span>
</span><a name="line-700"></a><span class="hs-comment">--</span><span>
</span><a name="line-701"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-glyph">!</span><span>
</span><a name="line-702"></a><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500061"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500062"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500061"><span class="hs-identifier hs-type">ix</span></a><span> </span><a href="#local-1630500062"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500061"><span class="hs-identifier hs-type">ix</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500062"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-703"></a><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-var">Exp</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#Index"><span class="hs-identifier hs-var">Index</span></a><span>
</span><a name="line-704"></a><span>
</span><a name="line-705"></a><span class="hs-comment">-- |Expression form that extracts a scalar from an array at a linear index</span><span>
</span><a name="line-706"></a><span class="hs-comment">--</span><span>
</span><a name="line-707"></a><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">9</span><span> </span><span class="hs-operator">!!</span><span>
</span><a name="line-708"></a><span class="hs-special">(</span><span class="hs-operator">!!</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500059"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500060"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500059"><span class="hs-identifier hs-type">ix</span></a><span> </span><a href="#local-1630500060"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500060"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-709"></a><span class="hs-special">(</span><a name="%21%21"><a href="Data.Array.Accelerate.Language.html#%21%21"><span class="hs-operator">!!</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-var">Exp</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#%24%24"><span class="hs-operator hs-var">$$</span></a><span> </span><a href="Data.Array.Accelerate.Smart.html#LinearIndex"><span class="hs-identifier hs-var">LinearIndex</span></a><span>
</span><a name="line-710"></a><span>
</span><a name="line-711"></a><span class="hs-comment">-- |Expression form that yields the shape of an array</span><span>
</span><a name="line-712"></a><span class="hs-comment">--</span><span>
</span><a name="line-713"></a><span class="hs-identifier">shape</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500057"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500058"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500057"><span class="hs-identifier hs-type">ix</span></a><span> </span><a href="#local-1630500058"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500057"><span class="hs-identifier hs-type">ix</span></a><span>
</span><a name="line-714"></a><a name="shape"><a href="Data.Array.Accelerate.Language.html#shape"><span class="hs-identifier">shape</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-var">Exp</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Shape"><span class="hs-identifier hs-var">Shape</span></a><span>
</span><a name="line-715"></a><span>
</span><a name="line-716"></a><span class="hs-comment">-- |Expression form that yields the size of an array</span><span>
</span><a name="line-717"></a><span class="hs-comment">--</span><span>
</span><a name="line-718"></a><span class="hs-identifier">size</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500055"><span class="hs-identifier hs-type">ix</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500056"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Acc"><span class="hs-identifier hs-type">Acc</span></a><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Array"><span class="hs-identifier hs-type">Array</span></a><span> </span><a href="#local-1630500055"><span class="hs-identifier hs-type">ix</span></a><span> </span><a href="#local-1630500056"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-719"></a><a name="size"><a href="Data.Array.Accelerate.Language.html#size"><span class="hs-identifier">size</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Language.html#shapeSize"><span class="hs-identifier hs-var">shapeSize</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Array.Accelerate.Language.html#shape"><span class="hs-identifier hs-var">shape</span></a><span>
</span><a name="line-720"></a><span>
</span><a name="line-721"></a><span class="hs-comment">-- |The total number of elements in an array of the given 'Shape'</span><span>
</span><a name="line-722"></a><span class="hs-comment">--</span><span>
</span><a name="line-723"></a><span class="hs-identifier">shapeSize</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500054"><span class="hs-identifier hs-type">ix</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500054"><span class="hs-identifier hs-type">ix</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-724"></a><a name="shapeSize"><a href="Data.Array.Accelerate.Language.html#shapeSize"><span class="hs-identifier">shapeSize</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-var">Exp</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.Array.Accelerate.Smart.html#ShapeSize"><span class="hs-identifier hs-var">ShapeSize</span></a><span>
</span><a name="line-725"></a><span>
</span><a name="line-726"></a><span>
</span><a name="line-727"></a><span class="hs-comment">-- Numeric functions</span><span>
</span><a name="line-728"></a><span class="hs-comment">-- -----------------</span><span>
</span><a name="line-729"></a><span>
</span><a name="line-730"></a><span class="hs-comment">-- | 'subtract' is the same as @'flip' ('-')@.</span><span>
</span><a name="line-731"></a><span class="hs-comment">--</span><span>
</span><a name="line-732"></a><span class="hs-identifier">subtract</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Classes.Num.html#Num"><span class="hs-identifier hs-type">Num</span></a><span> </span><a href="#local-1630500053"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500053"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500053"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500053"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-733"></a><a name="subtract"><a href="Data.Array.Accelerate.Language.html#subtract"><span class="hs-identifier">subtract</span></a></a><span> </span><a name="local-1630500151"><a href="#local-1630500151"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1630500152"><a href="#local-1630500152"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1630500152"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-1630500151"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-734"></a><span>
</span><a name="line-735"></a><span class="hs-comment">-- | Determine if a number is even</span><span>
</span><a name="line-736"></a><span class="hs-comment">--</span><span>
</span><a name="line-737"></a><span class="hs-identifier">even</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Classes.Integral.html#Integral"><span class="hs-identifier hs-type">Integral</span></a><span> </span><a href="#local-1630500052"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500052"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-738"></a><a name="even"><a href="Data.Array.Accelerate.Language.html#even"><span class="hs-identifier">even</span></a></a><span> </span><a name="local-1630500153"><a href="#local-1630500153"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1630500153"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">rem</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span> </span><a href="Data.Array.Accelerate.Classes.Eq.html#%3D%3D%2A"><span class="hs-operator hs-var">==*</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-739"></a><span>
</span><a name="line-740"></a><span class="hs-comment">-- | Determine if a number is odd</span><span>
</span><a name="line-741"></a><span class="hs-comment">--</span><span>
</span><a name="line-742"></a><span class="hs-identifier">odd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Classes.Integral.html#Integral"><span class="hs-identifier hs-type">Integral</span></a><span> </span><a href="#local-1630500051"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500051"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-743"></a><a name="odd"><a href="Data.Array.Accelerate.Language.html#odd"><span class="hs-identifier">odd</span></a></a><span> </span><a name="local-1630500154"><a href="#local-1630500154"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1630500154"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">rem</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span> </span><a href="Data.Array.Accelerate.Classes.Eq.html#%2F%3D%2A"><span class="hs-operator hs-var">/=*</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-744"></a><span>
</span><a name="line-745"></a><span class="hs-comment">-- | @'gcd' x y@ is the non-negative factor of both @x@ and @y@ of which every</span><span>
</span><a name="line-746"></a><span class="hs-comment">-- common factor of both @x@ and @y@ is also a factor; for example:</span><span>
</span><a name="line-747"></a><span class="hs-comment">--</span><span>
</span><a name="line-748"></a><span class="hs-comment">-- &gt;&gt;&gt; gcd 4 2 = 2</span><span>
</span><a name="line-749"></a><span class="hs-comment">-- &gt;&gt;&gt; gcd (-4) 6 = 2</span><span>
</span><a name="line-750"></a><span class="hs-comment">-- &gt;&gt;&gt; gcd 0 4 = 4</span><span>
</span><a name="line-751"></a><span class="hs-comment">-- &gt;&gt;&gt; gcd 0 0 = 0</span><span>
</span><a name="line-752"></a><span class="hs-comment">--</span><span>
</span><a name="line-753"></a><span class="hs-comment">-- That is, the common divisor that is \&quot;greatest\&quot; in the divisibility</span><span>
</span><a name="line-754"></a><span class="hs-comment">-- preordering.</span><span>
</span><a name="line-755"></a><span class="hs-comment">--</span><span>
</span><a name="line-756"></a><span class="hs-identifier">gcd</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Classes.Integral.html#Integral"><span class="hs-identifier hs-type">Integral</span></a><span> </span><a href="#local-1630500050"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500050"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500050"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500050"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-757"></a><a name="gcd"><a href="Data.Array.Accelerate.Language.html#gcd"><span class="hs-identifier">gcd</span></a></a><span> </span><a name="local-1630500155"><a href="#local-1630500155"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1630500156"><a href="#local-1630500156"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1630500157"><span class="hs-identifier hs-var">gcd'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-1630500155"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-1630500156"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-758"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-759"></a><span>    </span><span class="hs-identifier">gcd'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Classes.Integral.html#Integral"><span class="hs-identifier hs-type">Integral</span></a><span> </span><a href="#local-1630500158"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500158"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500158"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500158"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-760"></a><span>    </span><a name="local-1630500157"><a href="#local-1630500157"><span class="hs-identifier">gcd'</span></a></a><span> </span><a name="local-1630500159"><a href="#local-1630500159"><span class="hs-identifier">u</span></a></a><span> </span><a name="local-1630500160"><a href="#local-1630500160"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-761"></a><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-1630500161"><a href="#local-1630500161"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#untup2"><span class="hs-identifier hs-var">untup2</span></a><span>
</span><a name="line-762"></a><span>                </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Array.Accelerate.Language.html#while"><span class="hs-identifier hs-var">while</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#untup2"><span class="hs-identifier hs-var">untup2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-1630500162"><a href="#local-1630500162"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1630500162"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="Data.Array.Accelerate.Classes.Eq.html#%2F%3D%2A"><span class="hs-operator hs-var">/=*</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-763"></a><span>                        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#untup2"><span class="hs-identifier hs-var">untup2</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a name="local-1630500163"><a href="#local-1630500163"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-1630500164"><a href="#local-1630500164"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#tup2"><span class="hs-identifier hs-var">tup2</span></a><span> </span><span class="hs-special">(</span><a href="#local-1630500164"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-1630500163"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">rem</span><span class="hs-special">`</span><span> </span><a href="#local-1630500164"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-764"></a><span>                        </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Smart.html#tup2"><span class="hs-identifier hs-var">tup2</span></a><span> </span><span class="hs-special">(</span><a href="#local-1630500159"><span class="hs-identifier hs-var">u</span></a><span class="hs-special">,</span><a href="#local-1630500160"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-765"></a><span>      </span><span class="hs-keyword">in</span><span> </span><a href="#local-1630500161"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-766"></a><span>
</span><a name="line-767"></a><span>
</span><a name="line-768"></a><span class="hs-comment">-- | @'lcm' x y@ is the smallest positive integer that both @x@ and @y@ divide.</span><span>
</span><a name="line-769"></a><span class="hs-comment">--</span><span>
</span><a name="line-770"></a><span class="hs-identifier">lcm</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Classes.Integral.html#Integral"><span class="hs-identifier hs-type">Integral</span></a><span> </span><a href="#local-1630500049"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500049"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500049"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500049"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-771"></a><a name="lcm"><a href="Data.Array.Accelerate.Language.html#lcm"><span class="hs-identifier">lcm</span></a></a><span> </span><a name="local-1630500165"><a href="#local-1630500165"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-1630500166"><a href="#local-1630500166"><span class="hs-identifier">y</span></a></a><span>
</span><a name="line-772"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Language.html#cond"><span class="hs-identifier hs-var">cond</span></a><span> </span><span class="hs-special">(</span><a href="#local-1630500165"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="Data.Array.Accelerate.Classes.Eq.html#%3D%3D%2A"><span class="hs-operator hs-var">==*</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="Data.Array.Accelerate.Classes.Eq.html#%7C%7C%2A"><span class="hs-operator hs-var">||*</span></a><span> </span><a href="#local-1630500166"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="Data.Array.Accelerate.Classes.Eq.html#%3D%3D%2A"><span class="hs-operator hs-var">==*</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-773"></a><span>  </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">abs</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-1630500165"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">quot</span><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Language.html#gcd"><span class="hs-identifier hs-var">gcd</span></a><span> </span><a href="#local-1630500165"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1630500166"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-1630500166"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-774"></a><span>
</span><a name="line-775"></a><span>
</span><a name="line-776"></a><span class="hs-comment">-- Conversions</span><span>
</span><a name="line-777"></a><span class="hs-comment">-- -----------</span><span>
</span><a name="line-778"></a><span>
</span><a name="line-779"></a><span class="hs-comment">-- |Convert a character to an 'Int'.</span><span>
</span><a name="line-780"></a><span class="hs-comment">--</span><span>
</span><a name="line-781"></a><span class="hs-identifier">ord</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-782"></a><a name="ord"><a href="Data.Array.Accelerate.Language.html#ord"><span class="hs-identifier">ord</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#mkOrd"><span class="hs-identifier hs-var">mkOrd</span></a><span>
</span><a name="line-783"></a><span>
</span><a name="line-784"></a><span class="hs-comment">-- |Convert an 'Int' into a character.</span><span>
</span><a name="line-785"></a><span class="hs-comment">--</span><span>
</span><a name="line-786"></a><span class="hs-identifier">chr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-identifier hs-type">Char</span><span>
</span><a name="line-787"></a><a name="chr"><a href="Data.Array.Accelerate.Language.html#chr"><span class="hs-identifier">chr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#mkChr"><span class="hs-identifier hs-var">mkChr</span></a><span>
</span><a name="line-788"></a><span>
</span><a name="line-789"></a><span class="hs-comment">-- |Convert a Boolean value to an 'Int', where 'False' turns into '0' and 'True'</span><span>
</span><a name="line-790"></a><span class="hs-comment">-- into '1'.</span><span>
</span><a name="line-791"></a><span class="hs-comment">--</span><span>
</span><a name="line-792"></a><span class="hs-identifier">boolToInt</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-793"></a><a name="boolToInt"><a href="Data.Array.Accelerate.Language.html#boolToInt"><span class="hs-identifier">boolToInt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#mkBoolToInt"><span class="hs-identifier hs-var">mkBoolToInt</span></a><span>
</span><a name="line-794"></a><span>
</span><a name="line-795"></a><span class="hs-comment">-- |Reinterpret a value as another type. The two representations must have the</span><span>
</span><a name="line-796"></a><span class="hs-comment">-- same bit size.</span><span>
</span><a name="line-797"></a><span class="hs-comment">--</span><span>
</span><a name="line-798"></a><span class="hs-identifier">bitcast</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500047"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Elt"><span class="hs-identifier hs-type">Elt</span></a><span> </span><a href="#local-1630500048"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Type.html#IsScalar"><span class="hs-identifier hs-type">IsScalar</span></a><span> </span><a href="#local-1630500047"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Type.html#IsScalar"><span class="hs-identifier hs-type">IsScalar</span></a><span> </span><a href="#local-1630500048"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Data.Array.Accelerate.Type.html#BitSizeEq"><span class="hs-identifier hs-type">BitSizeEq</span></a><span> </span><a href="#local-1630500047"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-1630500048"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500047"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500048"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-799"></a><a name="bitcast"><a href="Data.Array.Accelerate.Language.html#bitcast"><span class="hs-identifier">bitcast</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#mkBitcast"><span class="hs-identifier hs-var">mkBitcast</span></a><span>
</span><a name="line-800"></a><span>
</span><a name="line-801"></a><span>
</span><a name="line-802"></a><span class="hs-comment">-- Constants</span><span>
</span><a name="line-803"></a><span class="hs-comment">-- ---------</span><span>
</span><a name="line-804"></a><span>
</span><a name="line-805"></a><span class="hs-comment">-- |Magic value identifying elements that are ignored in a forward permutation.</span><span>
</span><a name="line-806"></a><span class="hs-comment">-- Note that this currently does not work for singleton arrays.</span><span>
</span><a name="line-807"></a><span class="hs-comment">--</span><span>
</span><a name="line-808"></a><span class="hs-identifier">ignore</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#Shape"><span class="hs-identifier hs-type">Shape</span></a><span> </span><a href="#local-1630500046"><span class="hs-identifier hs-type">ix</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Array.Accelerate.Smart.html#Exp"><span class="hs-identifier hs-type">Exp</span></a><span> </span><a href="#local-1630500046"><span class="hs-identifier hs-type">ix</span></a><span>
</span><a name="line-809"></a><a name="ignore"><a href="Data.Array.Accelerate.Language.html#ignore"><span class="hs-identifier">ignore</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Array.Accelerate.Smart.html#constant"><span class="hs-identifier hs-var">constant</span></a><span> </span><a href="Data.Array.Accelerate.Array.Sugar.html#ignore"><span class="hs-identifier hs-var">Sugar</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">ignore</span></a><span>
</span><a name="line-810"></a><span>
</span><a name="line-811"></a></pre></body></html>