<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- GENERATED by C-&gt;Haskell Compiler, version 0.28.1 Switcheroo, 1 April 2016 (Haskell)</span><span>
</span><a name="line-2"></a><span class="hs-comment">-- Edit the ORIGNAL .chs file instead!</span><span>
</span><a name="line-3"></a><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LINE 1 &quot;src/Foreign/CUDA/Driver/Unified.chs&quot; #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE BangPatterns             #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE CPP                      #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE EmptyDataDecls           #-}</span><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE ForeignFunctionInterface #-}</span><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables      #-}</span><span>
</span><a name="line-11"></a><span class="hs-pragma">{-# LANGUAGE TemplateHaskell          #-}</span><span>
</span><a name="line-12"></a><span class="hs-pragma">{-# OPTIONS_HADDOCK prune #-}</span><span>
</span><a name="line-13"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- Module    : Foreign.CUDA.Driver.Unified</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- Copyright : [2017] Trevor L. McDonell</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- License   : BSD</span><span>
</span><a name="line-18"></a><span class="hs-comment">--</span><span>
</span><a name="line-19"></a><span class="hs-comment">-- Unified addressing functions for the low-level driver interface</span><span>
</span><a name="line-20"></a><span class="hs-comment">--</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- [/Overview/]</span><span>
</span><a name="line-22"></a><span class="hs-comment">--</span><span>
</span><a name="line-23"></a><span class="hs-comment">-- CUDA devices can share a unified address space with the host. For these</span><span>
</span><a name="line-24"></a><span class="hs-comment">-- devices, there is no distinction between a device pointer and a host</span><span>
</span><a name="line-25"></a><span class="hs-comment">-- pointer---the same pointer value may be used to access memory from the host</span><span>
</span><a name="line-26"></a><span class="hs-comment">-- program and from a kernel running on the device (with exceptions enumerated</span><span>
</span><a name="line-27"></a><span class="hs-comment">-- below).</span><span>
</span><a name="line-28"></a><span class="hs-comment">--</span><span>
</span><a name="line-29"></a><span class="hs-comment">-- [/Support/]</span><span>
</span><a name="line-30"></a><span class="hs-comment">--</span><span>
</span><a name="line-31"></a><span class="hs-comment">-- Whether or not a device supports unified addressing may be queried by calling</span><span>
</span><a name="line-32"></a><span class="hs-comment">-- 'Foreign.CUDA.Driver.Device.attribute' with the</span><span>
</span><a name="line-33"></a><span class="hs-comment">-- 'Foreign.CUDA.Driver.Device.UnifiedAddressing' attribute.</span><span>
</span><a name="line-34"></a><span class="hs-comment">--</span><span>
</span><a name="line-35"></a><span class="hs-comment">-- Unified addressing is automatically enabled in 64-bit processes on devices</span><span>
</span><a name="line-36"></a><span class="hs-comment">-- with compute capability at leas 2.0.</span><span>
</span><a name="line-37"></a><span class="hs-comment">--</span><span>
</span><a name="line-38"></a><span class="hs-comment">-- [/Looking up information about pointers/]</span><span>
</span><a name="line-39"></a><span class="hs-comment">--</span><span>
</span><a name="line-40"></a><span class="hs-comment">-- It is possible to look up information about the memory which backs a pointer;</span><span>
</span><a name="line-41"></a><span class="hs-comment">-- that is, whether the memory resides on the host or the device (and in</span><span>
</span><a name="line-42"></a><span class="hs-comment">-- particular, which device).</span><span>
</span><a name="line-43"></a><span class="hs-comment">--</span><span>
</span><a name="line-44"></a><span class="hs-comment">-- [/Automatic mapping of host memory/]</span><span>
</span><a name="line-45"></a><span class="hs-comment">--</span><span>
</span><a name="line-46"></a><span class="hs-comment">-- All host memory allocated in all contexts using</span><span>
</span><a name="line-47"></a><span class="hs-comment">-- 'Foreign.CUDA.Driver.Marshal.mallocHostArray' or</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- 'Foreign.CUDA.Driver.Marshal.mallocHostForeignPtr' is always directly</span><span>
</span><a name="line-49"></a><span class="hs-comment">-- accessible from all contexts on all devices which support unified addressing.</span><span>
</span><a name="line-50"></a><span class="hs-comment">-- This is the case whether or not the flags</span><span>
</span><a name="line-51"></a><span class="hs-comment">-- 'Foreign.CUDA.Driver.Marshal.Portable' or</span><span>
</span><a name="line-52"></a><span class="hs-comment">-- 'Foreign.CUDA.Driver.Marshal.DeviceMapped' are specified.</span><span>
</span><a name="line-53"></a><span class="hs-comment">--</span><span>
</span><a name="line-54"></a><span class="hs-comment">-- The pointer value through which allocated host memory may be accessed in</span><span>
</span><a name="line-55"></a><span class="hs-comment">-- kernels on all devices which support unified addressing is the same as the</span><span>
</span><a name="line-56"></a><span class="hs-comment">-- pointer value as on the host; that is, it is not necessary to call</span><span>
</span><a name="line-57"></a><span class="hs-comment">-- 'Foreign.CUDA.Driver.Marshal.getDevicePtr' for these allocations.</span><span>
</span><a name="line-58"></a><span class="hs-comment">--</span><span>
</span><a name="line-59"></a><span class="hs-comment">-- Note that this is not the case for memory allocated using the</span><span>
</span><a name="line-60"></a><span class="hs-comment">-- 'Foreign.CUDA.Driver.Marshal.WriteCombined' option; see below.</span><span>
</span><a name="line-61"></a><span class="hs-comment">--</span><span>
</span><a name="line-62"></a><span class="hs-comment">-- [/Automatic registration of peer memory/]</span><span>
</span><a name="line-63"></a><span class="hs-comment">--</span><span>
</span><a name="line-64"></a><span class="hs-comment">-- Upon enabling direct access from a context which supports unified addressing</span><span>
</span><a name="line-65"></a><span class="hs-comment">-- to another peer context which supports unified addressing using</span><span>
</span><a name="line-66"></a><span class="hs-comment">-- 'Foreign.CUDA.Driver.Context.Peer.add', all memory allocated in the peer</span><span>
</span><a name="line-67"></a><span class="hs-comment">-- context will immediately be accessible by the current context. The device</span><span>
</span><a name="line-68"></a><span class="hs-comment">-- pointer values are the same on both contexts.</span><span>
</span><a name="line-69"></a><span class="hs-comment">--</span><span>
</span><a name="line-70"></a><span class="hs-comment">-- [/Exceptions (disjoint addressing/]</span><span>
</span><a name="line-71"></a><span class="hs-comment">--</span><span>
</span><a name="line-72"></a><span class="hs-comment">-- Not all memory may be accessed on devices through the same pointer value</span><span>
</span><a name="line-73"></a><span class="hs-comment">-- as they are accessed with on the host. These exceptions are host arrays</span><span>
</span><a name="line-74"></a><span class="hs-comment">-- registered with 'Foreign.CUDA.Driver.Marshal.registerArray', and those</span><span>
</span><a name="line-75"></a><span class="hs-comment">-- allocated with the flag 'Foreign.CUDA.Driver.Marshal.WriteCombined'. In these</span><span>
</span><a name="line-76"></a><span class="hs-comment">-- cases, the host and device arrays have distinct addresses (pointer values).</span><span>
</span><a name="line-77"></a><span class="hs-comment">-- However, the device address is guaranteed to not overlap with any valid host</span><span>
</span><a name="line-78"></a><span class="hs-comment">-- pointer range and is guaranteed to have the same value across all contexts</span><span>
</span><a name="line-79"></a><span class="hs-comment">-- which support unified addressing.</span><span>
</span><a name="line-80"></a><span class="hs-comment">--</span><span>
</span><a name="line-81"></a><span class="hs-comment">-- The value of the device pointer may be queried with</span><span>
</span><a name="line-82"></a><span class="hs-comment">-- 'Foreign.CUDA.Driver.Marshal.getDevicePtr' from any context supporting</span><span>
</span><a name="line-83"></a><span class="hs-comment">-- unified addressing.</span><span>
</span><a name="line-84"></a><span class="hs-comment">--</span><span>
</span><a name="line-85"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">CUDA</span><span class="hs-operator">.</span><span class="hs-identifier">Driver</span><span class="hs-operator">.</span><span class="hs-identifier">Unified</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span>  </span><span class="hs-comment">-- ** Querying pointer attributes</span><span>
</span><a name="line-90"></a><span>  </span><span class="hs-identifier">PointerAttributes</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">MemoryType</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-91"></a><span>  </span><span class="hs-identifier">getAttributes</span><span class="hs-special">,</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span>  </span><span class="hs-comment">-- ** Setting pointer attributes</span><span>
</span><a name="line-94"></a><span>  </span><span class="hs-identifier">Advice</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-95"></a><span>  </span><span class="hs-identifier">setSyncMemops</span><span class="hs-special">,</span><span>
</span><a name="line-96"></a><span>  </span><span class="hs-identifier">advise</span><span class="hs-special">,</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span class="hs-pragma">{-# LINE 96 &quot;src/Foreign/CUDA/Driver/Unified.chs&quot; #-}</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">-- Friends</span><span>
</span><a name="line-108"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">CUDA</span><span class="hs-operator">.</span><span class="hs-identifier">Driver</span><span class="hs-operator">.</span><span class="hs-identifier">Context</span><span>
</span><a name="line-109"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">CUDA</span><span class="hs-operator">.</span><span class="hs-identifier">Driver</span><span class="hs-operator">.</span><span class="hs-identifier">Device</span><span>
</span><a name="line-110"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">CUDA</span><span class="hs-operator">.</span><span class="hs-identifier">Driver</span><span class="hs-operator">.</span><span class="hs-identifier">Error</span><span>
</span><a name="line-111"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">CUDA</span><span class="hs-operator">.</span><span class="hs-identifier">Driver</span><span class="hs-operator">.</span><span class="hs-identifier">Marshal</span><span>
</span><a name="line-112"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">CUDA</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span><span class="hs-operator">.</span><span class="hs-identifier">C2HS</span><span>
</span><a name="line-113"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">CUDA</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-comment">-- System</span><span>
</span><a name="line-116"></a><span class="hs-keyword">import</span><span> </span><a name="PointerAttributes"><a href="Foreign.CUDA.Driver.Unified.html#PointerAttributes"><span class="hs-identifier">Control</span><span class="hs-operator">.</span></a></a><span class="hs-identifier">Applicative</span><span>
</span><a name="line-117"></a><span class="hs-keyword">import</span><span> </span><a name="MemoryType"><a href="Foreign.CUDA.Driver.Unified.html#MemoryType"><span class="hs-identifier">Control</span><span class="hs-operator">.</span></a></a><span class="hs-identifier">Monad</span><span>
</span><a name="line-118"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span>
</span><a name="line-119"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span>
</span><a name="line-120"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">C</span><span>
</span><a name="line-121"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">Storable</span><span>
</span><a name="line-122"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">PointerAttributes</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-126"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">MemoryType</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Advice</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-comment">-- Return information about a pointer.</span><span>
</span><a name="line-132"></a><span class="hs-comment">--</span><span>
</span><a name="line-133"></a><span class="hs-comment">-- &lt;http://docs.nvidia.com/cuda/cuda-driver-api/group__CUDA__UNIFIED.html#group__CUDA__UNIFIED_1g0c28ed0aff848042bc0533110e45820c&gt;</span><span>
</span><a name="line-134"></a><span class="hs-comment">--</span><span>
</span><a name="line-135"></a><span class="hs-comment">-- Requires CUDA-7.0.</span><span>
</span><a name="line-136"></a><span class="hs-comment">--</span><span>
</span><a name="line-137"></a><span class="hs-pragma">{-# INLINEABLE getAttributes #-}</span><span>
</span><a name="line-138"></a><span class="hs-identifier">getAttributes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PointerAttributes</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span class="hs-identifier">getAttributes</span><span> </span><span class="hs-identifier">_</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">requireSDK</span><span> </span><span class="hs-char">'getAttributes 7.0


-- Set whether or not the given memory region is guaranteed to always
-- synchronise memory operations that are synchronous. If there are some
-- previously initiated synchronous memory operations that are pending when this
-- attribute is set, the function does not return until those memory operations
-- are complete. See
-- &lt;http://docs.nvidia.com/cuda/cuda-driver-api/api-sync-behavior.html API
-- synchronisation behaviour&gt; for more information on cases where synchronous
-- memory operations can exhibit asynchronous behaviour.
--
-- &lt;http://docs.nvidia.com/cuda/cuda-driver-api/group__CUDA__UNIFIED.html#group__CUDA__UNIFIED_1g89f7ad29a657e574fdea2624b74d138e&gt;
--
-- Requires CUDA-7.0.
--
{-# INLINE setSyncMemops #-}
setSyncMemops :: Ptr a -&gt; Bool -&gt; IO ()
setSyncMemops _   _   = requireSDK 'setSyncMemops 7.0


-- | Advise about the usage of a given range of memory. If the supplied device
-- is Nothing, then the preferred location is taken to mean the CPU.
--
-- &lt;http://docs.nvidia.com/cuda/cuda-driver-api/group__CUDA__UNIFIED.html#group__CUDA__UNIFIED_1g27608c857a9254789c13f3e3b72029e2&gt;
--
-- Requires CUDA-8.0.
--
{-# INLINEABLE advise #-}
advise :: Storable a =&gt; Ptr a -&gt; Int -&gt; Advice -&gt; Maybe Device -&gt; IO ()
advise _   _ _ _    = requireSDK 'advise 8.0

</span></pre></body></html>