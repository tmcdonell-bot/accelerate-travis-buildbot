<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>GHC/Integer/Type.lhs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
\begin{code}
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE BangPatterns, CPP, UnboxedTuples, UnliftedFFITypes, MagicHash, NoImplicitPrelude #-}</span>
<a name="line-2"></a><span class='hs-comment'>{-# OPTIONS_HADDOCK hide #-}</span>
<a name="line-3"></a>
<a name="line-4"></a><span class='hs-comment'>-- Commentary of Integer library is located on the wiki:</span>
<a name="line-5"></a><span class='hs-comment'>-- <a href="http://ghc.haskell.org/trac/ghc/wiki/Commentary/Libraries/Integer">http://ghc.haskell.org/trac/ghc/wiki/Commentary/Libraries/Integer</a></span>
<a name="line-6"></a><span class='hs-comment'>--</span>
<a name="line-7"></a><span class='hs-comment'>-- It gives an in-depth description of implementation details and</span>
<a name="line-8"></a><span class='hs-comment'>-- decisions.</span>
<a name="line-9"></a><span class='hs-comment'>--</span>
<a name="line-10"></a><span class='hs-comment'>-- TODO: Try to use optimized big/small int primops on IL32P64 archs</span>
<a name="line-11"></a><span class='hs-comment'>-- (mostly Windows/x86_64). Currently, we have to fall back to</span>
<a name="line-12"></a><span class='hs-comment'>-- unoptimized code-paths for most big/small-int primops, due to</span>
<a name="line-13"></a><span class='hs-comment'>-- @mpz_*()@ functions using @long@ types, which is smaller than</span>
<a name="line-14"></a><span class='hs-comment'>-- @mp_limb_t@ on IL32P64. The @mpn_*()@ functions are often safe to</span>
<a name="line-15"></a><span class='hs-comment'>-- use, as they use @mb_limb_t@ instead of @long@.</span>
<a name="line-16"></a><span class='hs-comment'>-- (look out for @#if SIZEOF_HSWORD == SIZEOF_LONG@ occurences)</span>
<a name="line-17"></a><span class='hs-comment'>--</span>
<a name="line-18"></a>
<a name="line-19"></a><span class='hs-cpp'>#include "MachDeps.h"</span>
<a name="line-20"></a><span class='hs-cpp'>#include "HsIntegerGmp.h"</span>
<a name="line-21"></a>
<a name="line-22"></a><span class='hs-cpp'>#if SIZEOF_HSWORD == 4</span>
<a name="line-23"></a><span class='hs-cpp'>#define INT_MINBOUND (-2147483648#)</span>
<a name="line-24"></a><span class='hs-cpp'>#define NEG_INT_MINBOUND (S# 2147483647# `plusInteger` S# 1#)</span>
<a name="line-25"></a><span class='hs-cpp'>#elif SIZEOF_HSWORD == 8</span>
<a name="line-26"></a><span class='hs-cpp'>#define INT_MINBOUND (-9223372036854775808#)</span>
<a name="line-27"></a><span class='hs-cpp'>#define NEG_INT_MINBOUND (S# 9223372036854775807# `plusInteger` S# 1#)</span>
<a name="line-28"></a><span class='hs-cpp'>#else</span>
<a name="line-29"></a><span class='hs-cpp'>#error Unknown SIZEOF_HSWORD; can't define INT_MINBOUND and NEG_INT_MINBOUND</span>
<a name="line-30"></a><span class='hs-cpp'>#endif</span>
<a name="line-31"></a>
<a name="line-32"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>GHC</span><span class='hs-varop'>.</span><span class='hs-conid'>Integer</span><span class='hs-varop'>.</span><span class='hs-conid'>Type</span> <span class='hs-keyword'>where</span>
<a name="line-33"></a>
<a name="line-34"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC</span><span class='hs-varop'>.</span><span class='hs-conid'>Prim</span> <span class='hs-layout'>(</span>
<a name="line-35"></a>    <span class='hs-comment'>-- Other types we use, convert from, or convert to</span>
<a name="line-36"></a>    <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-conid'>Double</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-conid'>Float</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-conid'>Addr</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-37"></a>    <span class='hs-varid'>indexIntArray</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-38"></a>    <span class='hs-comment'>-- Conversions between those types</span>
<a name="line-39"></a>    <span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>int2Double</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>int2Float</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>word2Int</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-40"></a>    <span class='hs-comment'>-- Operations on Int# that we use for operations on S#</span>
<a name="line-41"></a>    <span class='hs-varid'>quotInt</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>remInt</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>quotRemInt</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-42"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>*#</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>-#</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-43"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>==#</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>/=#</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>&lt;=#</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>&gt;=#</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>&lt;#</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>&gt;#</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-44"></a>    <span class='hs-varid'>mulIntMayOflo</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>addIntC</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>subIntC</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-45"></a>    <span class='hs-varid'>and</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>or</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>xor</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-46"></a> <span class='hs-layout'>)</span>
<a name="line-47"></a>
<a name="line-48"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC</span><span class='hs-varop'>.</span><span class='hs-conid'>Integer</span><span class='hs-varop'>.</span><span class='hs-conid'>GMP</span><span class='hs-varop'>.</span><span class='hs-conid'>Prim</span> <span class='hs-layout'>(</span>
<a name="line-49"></a>    <span class='hs-comment'>-- GMP-related primitives</span>
<a name="line-50"></a>    <span class='hs-conid'>MPZ</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-51"></a>    <span class='hs-varid'>cmpInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-52"></a>    <span class='hs-varid'>plusInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>minusInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-53"></a>    <span class='hs-varid'>timesInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-54"></a>    <span class='hs-varid'>quotRemInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>quotInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>remInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-55"></a>    <span class='hs-varid'>divModInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>divInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>modInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-56"></a>    <span class='hs-varid'>divExactInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-57"></a>    <span class='hs-varid'>gcdInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>gcdExtInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>gcdIntegerInt</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>gcdInt</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-58"></a>    <span class='hs-varid'>decodeDouble</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-59"></a>    <span class='hs-varid'>int2Integer</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>integer2Int</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>word2Integer</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>integer2Word</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-60"></a>    <span class='hs-varid'>andInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>orInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>xorInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>complementInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-61"></a>    <span class='hs-varid'>testBitInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>mul2ExpInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>fdivQ2ExpInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-62"></a>    <span class='hs-varid'>powInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>powModInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>powModSecInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>recipModInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-63"></a>    <span class='hs-varid'>nextPrimeInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>testPrimeInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-64"></a>    <span class='hs-varid'>sizeInBaseInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-65"></a>    <span class='hs-varid'>importIntegerFromByteArray</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>importIntegerFromAddr</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-66"></a>    <span class='hs-varid'>exportIntegerToMutableByteArray</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>exportIntegerToAddr</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-67"></a>
<a name="line-68"></a><span class='hs-cpp'>#if SIZEOF_HSWORD == SIZEOF_LONG</span>
<a name="line-69"></a>    <span class='hs-varid'>plusIntegerInt</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>minusIntegerInt</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-70"></a>    <span class='hs-varid'>timesIntegerInt</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-71"></a>    <span class='hs-varid'>divIntegerWord</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>modIntegerWord</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>divModIntegerWord</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-72"></a>    <span class='hs-varid'>divExactIntegerWord</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-73"></a>    <span class='hs-varid'>quotIntegerWord</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>remIntegerWord</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>quotRemIntegerWord</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-74"></a><span class='hs-cpp'>#endif</span>
<a name="line-75"></a>
<a name="line-76"></a><span class='hs-cpp'>#if WORD_SIZE_IN_BITS &lt; 64</span>
<a name="line-77"></a>    <span class='hs-varid'>int64ToInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>  <span class='hs-varid'>integerToInt64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-78"></a>    <span class='hs-varid'>word64ToInteger</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>integerToWord64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-79"></a><span class='hs-cpp'>#endif</span>
<a name="line-80"></a> <span class='hs-layout'>)</span>
<a name="line-81"></a>
<a name="line-82"></a><span class='hs-cpp'>#if WORD_SIZE_IN_BITS &lt; 64</span>
<a name="line-83"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC</span><span class='hs-varop'>.</span><span class='hs-conid'>IntWord64</span> <span class='hs-layout'>(</span>
<a name="line-84"></a>            <span class='hs-conid'>Int64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-conid'>Word64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-85"></a>            <span class='hs-varid'>int64ToWord64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>intToInt64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-86"></a>            <span class='hs-varid'>int64ToInt</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>word64ToInt64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-87"></a>            <span class='hs-varid'>geInt64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>leInt64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>leWord64</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span>
<a name="line-88"></a>       <span class='hs-layout'>)</span>
<a name="line-89"></a><span class='hs-cpp'>#endif</span>
<a name="line-90"></a>
<a name="line-91"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC</span><span class='hs-varop'>.</span><span class='hs-conid'>Classes</span>
<a name="line-92"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC</span><span class='hs-varop'>.</span><span class='hs-conid'>Types</span>
<a name="line-93"></a>
<a name="line-94"></a><span class='hs-keyword'>default</span> <span class='hs-conid'>()</span>
</pre>\end{code}

%*********************************************************
%*                                                      *
\subsection{The @Integer@ type}
%*                                                      *
%*********************************************************

Convenient boxed Integer PrimOps.

\begin{code}
<pre><a name="line-1"></a><a name="Integer"></a><span class='hs-comment'>-- | Arbitrary-precision integers.</span>
<a name="line-2"></a><a name="Integer"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>Integer</span>
<a name="line-3"></a>   <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>            <span class='hs-comment'>-- ^ \"small\" integers fitting into an 'Int#'</span>
<a name="line-4"></a>   <span class='hs-keyglyph'>|</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-comment'>-- ^ \"big\" integers represented as GMP's @mpz_t@ structure.</span>
<a name="line-5"></a>     <span class='hs-comment'>--</span>
<a name="line-6"></a>     <span class='hs-comment'>-- The 'Int#' field corresponds to @mpz_t@'s @_mp_size@ field,</span>
<a name="line-7"></a>     <span class='hs-comment'>-- which encodes the sign and the number of /limbs/ stored in the</span>
<a name="line-8"></a>     <span class='hs-comment'>-- 'ByteArray#' field (i.e. @mpz_t@'s @_mp_d@ field). Note: The</span>
<a name="line-9"></a>     <span class='hs-comment'>-- 'ByteArray#' may have been over-allocated, and thus larger</span>
<a name="line-10"></a>     <span class='hs-comment'>-- than the size denoted by the 'Int#' field.</span>
<a name="line-11"></a>     <span class='hs-comment'>--</span>
<a name="line-12"></a>     <span class='hs-comment'>-- This representation tries to avoid using the GMP number</span>
<a name="line-13"></a>     <span class='hs-comment'>-- representation for small integers that fit into a native</span>
<a name="line-14"></a>     <span class='hs-comment'>-- 'Int#'. This allows to reduce (or at least defer) calling into GMP</span>
<a name="line-15"></a>     <span class='hs-comment'>-- for operations whose results remain in the 'Int#'-domain.</span>
<a name="line-16"></a>     <span class='hs-comment'>--</span>
<a name="line-17"></a>     <span class='hs-comment'>-- Note: It does __not__ constitute a violation of invariants to</span>
<a name="line-18"></a>     <span class='hs-comment'>-- represent an integer which would fit into an 'Int#' with the</span>
<a name="line-19"></a>     <span class='hs-comment'>-- 'J#'-constructor. For instance, the value @0@ has (only) two valid</span>
<a name="line-20"></a>     <span class='hs-comment'>-- representations, either @'S#' 0#@ or @'J#' 0 _@.</span>
<a name="line-21"></a>
<a name="line-22"></a><a name="mkInteger"></a><span class='hs-comment'>-- | Construct 'Integer' value from list of 'Int's.</span>
<a name="line-23"></a><span class='hs-comment'>--</span>
<a name="line-24"></a><span class='hs-comment'>-- This function is used by GHC for constructing 'Integer' literals.</span>
<a name="line-25"></a><span class='hs-definition'>mkInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span>   <span class='hs-comment'>-- ^ sign of integer ('True' if non-negative)</span>
<a name="line-26"></a>          <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Int</span><span class='hs-keyglyph'>]</span>  <span class='hs-comment'>-- ^ absolute value expressed in 31 bit chunks, least significant first</span>
<a name="line-27"></a>
<a name="line-28"></a>                    <span class='hs-comment'>-- (ideally these would be machine-word 'Word's rather than 31-bit truncated 'Int's)</span>
<a name="line-29"></a>          <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-30"></a><span class='hs-definition'>mkInteger</span> <span class='hs-varid'>nonNegative</span> <span class='hs-varid'>is</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>abs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span> <span class='hs-varid'>is</span>
<a name="line-31"></a>                           <span class='hs-keyword'>in</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>nonNegative</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>abs</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>negateInteger</span> <span class='hs-varid'>abs</span>
<a name="line-32"></a>    <span class='hs-keyword'>where</span> <span class='hs-varid'>f</span> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-33"></a>          <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-conop'>:</span> <span class='hs-varid'>is'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-varop'>`orInteger`</span> <span class='hs-varid'>shiftLInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>f</span> <span class='hs-varid'>is'</span><span class='hs-layout'>)</span> <span class='hs-num'>31</span><span class='hs-cpp'>#</span>
<a name="line-34"></a>
<a name="line-35"></a><a name="smallInteger"></a><span class='hs-comment'>{-# NOINLINE smallInteger #-}</span>
<a name="line-36"></a><span class='hs-definition'>smallInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-37"></a><span class='hs-definition'>smallInteger</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span>
<a name="line-38"></a>
<a name="line-39"></a><a name="wordToInteger"></a><span class='hs-comment'>{-# NOINLINE wordToInteger #-}</span>
<a name="line-40"></a><span class='hs-definition'>wordToInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-41"></a><span class='hs-definition'>wordToInteger</span> <span class='hs-varid'>w</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span> <span class='hs-varop'>&gt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-42"></a>                  <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span>
<a name="line-43"></a>                  <span class='hs-keyword'>else</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>word2Integer</span><span class='hs-cpp'>#</span> <span class='hs-varid'>w</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-44"></a>    <span class='hs-keyword'>where</span>
<a name="line-45"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>word2Int</span><span class='hs-cpp'>#</span> <span class='hs-varid'>w</span>
<a name="line-46"></a>
<a name="line-47"></a><a name="integerToWord"></a><span class='hs-comment'>{-# NOINLINE integerToWord #-}</span>
<a name="line-48"></a><span class='hs-definition'>integerToWord</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-49"></a><span class='hs-definition'>integerToWord</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span>
<a name="line-50"></a><span class='hs-definition'>integerToWord</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>integer2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-51"></a>
<a name="line-52"></a><span class='hs-cpp'>#if WORD_SIZE_IN_BITS &lt; 64</span>
<a name="line-53"></a><a name="integerToWord64"></a><span class='hs-comment'>{-# NOINLINE integerToWord64 #-}</span>
<a name="line-54"></a><span class='hs-definition'>integerToWord64</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word64</span><span class='hs-cpp'>#</span>
<a name="line-55"></a><span class='hs-definition'>integerToWord64</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>int64ToWord64</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>intToInt64</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>
<a name="line-56"></a><span class='hs-definition'>integerToWord64</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>integerToWord64</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-57"></a>
<a name="line-58"></a><a name="word64ToInteger"></a><span class='hs-comment'>{-# NOINLINE word64ToInteger #-}</span>
<a name="line-59"></a><span class='hs-definition'>word64ToInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word64</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-60"></a><span class='hs-definition'>word64ToInteger</span> <span class='hs-varid'>w</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>w</span> <span class='hs-varop'>`</span><span class='hs-varid'>leWord64</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>int64ToWord64</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>intToInt64</span><span class='hs-cpp'>#</span> <span class='hs-num'>0x7FFFFFFF</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-61"></a>                    <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>int64ToInt</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>word64ToInt64</span><span class='hs-cpp'>#</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-62"></a>                    <span class='hs-keyword'>else</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>word64ToInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>w</span> <span class='hs-keyword'>of</span>
<a name="line-63"></a>                         <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-64"></a>
<a name="line-65"></a><a name="integerToInt64"></a><span class='hs-comment'>{-# NOINLINE integerToInt64 #-}</span>
<a name="line-66"></a><span class='hs-definition'>integerToInt64</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int64</span><span class='hs-cpp'>#</span>
<a name="line-67"></a><span class='hs-definition'>integerToInt64</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>intToInt64</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span>
<a name="line-68"></a><span class='hs-definition'>integerToInt64</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>integerToInt64</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-69"></a>
<a name="line-70"></a><a name="int64ToInteger"></a><span class='hs-comment'>{-# NOINLINE int64ToInteger #-}</span>
<a name="line-71"></a><span class='hs-definition'>int64ToInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int64</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-72"></a><span class='hs-definition'>int64ToInteger</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span> <span class='hs-varop'>`</span><span class='hs-varid'>leInt64</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>intToInt64</span><span class='hs-cpp'>#</span> <span class='hs-num'>0x7FFFFFFF</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;&amp;</span>
<a name="line-73"></a>                      <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span> <span class='hs-varop'>`</span><span class='hs-varid'>geInt64</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>intToInt64</span><span class='hs-cpp'>#</span> <span class='hs-comment'>-</span><span class='hs-num'>0x80000000</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-74"></a>                   <span class='hs-keyword'>then</span> <span class='hs-varid'>smallInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>int64ToInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>
<a name="line-75"></a>                   <span class='hs-keyword'>else</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>int64ToInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-keyword'>of</span>
<a name="line-76"></a>                        <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-77"></a><span class='hs-cpp'>#endif</span>
<a name="line-78"></a>
<a name="line-79"></a><a name="integerToInt"></a><span class='hs-definition'>integerToInt</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-80"></a><span class='hs-comment'>{-# NOINLINE integerToInt #-}</span>
<a name="line-81"></a><span class='hs-definition'>integerToInt</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span>
<a name="line-82"></a><span class='hs-definition'>integerToInt</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>integer2Int</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span>
<a name="line-83"></a>
<a name="line-84"></a><a name="minIntAsBig"></a><span class='hs-comment'>-- This manually floated out constant is needed as GHC doesn't do it on its own</span>
<a name="line-85"></a><span class='hs-definition'>minIntAsBig</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span>
<a name="line-86"></a><span class='hs-definition'>minIntAsBig</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>int2Integer</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-layout'>}</span>
<a name="line-87"></a>
<a name="line-88"></a><a name="toBig"></a><span class='hs-comment'>-- | Promote 'S#' to 'J#'</span>
<a name="line-89"></a><span class='hs-definition'>toBig</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-90"></a><span class='hs-definition'>toBig</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>int2Integer</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-layout'>}</span>
<a name="line-91"></a><span class='hs-definition'>toBig</span> <span class='hs-varid'>i</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span>
<a name="line-92"></a>
<a name="line-93"></a><a name="toSmall"></a><span class='hs-comment'>-- | Demote 'J#' to 'S#' if possible. See also 'smartJ#'.</span>
<a name="line-94"></a><span class='hs-definition'>toSmall</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-95"></a><span class='hs-definition'>toSmall</span> <span class='hs-varid'>i</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span>
<a name="line-96"></a><span class='hs-definition'>toSmall</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mb</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>smartJ</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mb</span><span class='hs-cpp'>#</span>
<a name="line-97"></a>
<a name="line-98"></a>
<a name="line-99"></a><a name="smartJ"></a><span class='hs-comment'>-- | Smart 'J#' constructor which tries to construct 'S#' if possible</span>
<a name="line-100"></a><span class='hs-definition'>smartJ</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-101"></a><span class='hs-definition'>smartJ</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-102"></a><span class='hs-definition'>smartJ</span><span class='hs-cpp'>#</span> <span class='hs-num'>1</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mb</span><span class='hs-cpp'>#</span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-varop'>&gt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>v</span>
<a name="line-103"></a>    <span class='hs-keyword'>where</span>
<a name="line-104"></a>      <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>indexIntArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mb</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-105"></a><span class='hs-definition'>smartJ</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varid'>mb</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>v</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>v</span>
<a name="line-106"></a>    <span class='hs-keyword'>where</span>
<a name="line-107"></a>      <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>indexIntArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mb</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-108"></a><span class='hs-definition'>smartJ</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mb</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mb</span><span class='hs-cpp'>#</span>
<a name="line-109"></a>
<a name="line-110"></a><a name="mpzToInteger"></a><span class='hs-comment'>-- |Construct 'Integer' out of a 'MPZ#' as returned by GMP wrapper primops</span>
<a name="line-111"></a><span class='hs-comment'>--</span>
<a name="line-112"></a><span class='hs-comment'>-- IMPORTANT: The 'ByteArray#' element MUST NOT be accessed unless the</span>
<a name="line-113"></a><span class='hs-comment'>-- size-element indicates more than one limb!</span>
<a name="line-114"></a><span class='hs-comment'>--</span>
<a name="line-115"></a><span class='hs-comment'>-- See notes at definition site of 'MPZ#' in "GHC.Integer.GMP.Prim"</span>
<a name="line-116"></a><span class='hs-comment'>-- for more details.</span>
<a name="line-117"></a><span class='hs-definition'>mpzToInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MPZ</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-118"></a><span class='hs-definition'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-119"></a><span class='hs-definition'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-num'>1</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>w</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>v</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&gt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>v</span><span class='hs-cpp'>#</span>
<a name="line-120"></a>                             <span class='hs-keyglyph'>|</span> <span class='hs-conid'>True</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>word2Integer</span><span class='hs-cpp'>#</span> <span class='hs-varid'>w</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-num'>1</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span>
<a name="line-121"></a>    <span class='hs-keyword'>where</span>
<a name="line-122"></a>      <span class='hs-varid'>v</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>word2Int</span><span class='hs-cpp'>#</span> <span class='hs-varid'>w</span><span class='hs-cpp'>#</span>
<a name="line-123"></a><span class='hs-definition'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>w</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>v</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&lt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>v</span><span class='hs-cpp'>#</span>
<a name="line-124"></a>                              <span class='hs-keyglyph'>|</span> <span class='hs-conid'>True</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>word2Integer</span><span class='hs-cpp'>#</span> <span class='hs-varid'>w</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span>
<a name="line-125"></a>    <span class='hs-keyword'>where</span>
<a name="line-126"></a>      <span class='hs-varid'>v</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>word2Int</span><span class='hs-cpp'>#</span> <span class='hs-varid'>w</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-127"></a><span class='hs-definition'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>mb</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mb</span><span class='hs-cpp'>#</span>
<a name="line-128"></a>
<a name="line-129"></a><a name="mpzToInteger2"></a><span class='hs-comment'>-- | Variant of 'mpzToInteger' for pairs of 'Integer's</span>
<a name="line-130"></a><span class='hs-definition'>mpzToInteger2</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>MPZ</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-conid'>MPZ</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>Integer</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integer</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-131"></a><span class='hs-definition'>mpzToInteger2</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>mpz1</span><span class='hs-layout'>,</span> <span class='hs-varid'>mpz2</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i1</span><span class='hs-layout'>,</span> <span class='hs-varid'>i2</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-132"></a>    <span class='hs-keyword'>where</span>
<a name="line-133"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>i1</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-varid'>mpz1</span> <span class='hs-comment'>-- This use of `!` avoids creating thunks,</span>
<a name="line-134"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>i2</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-varid'>mpz2</span> <span class='hs-comment'>-- see also Note [Use S# if possible].</span>
<a name="line-135"></a>
<a name="line-136"></a><a name="mpzNeg"></a><span class='hs-comment'>-- |Negate MPZ#</span>
<a name="line-137"></a><span class='hs-definition'>mpzNeg</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MPZ</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>MPZ</span><span class='hs-cpp'>#</span>
<a name="line-138"></a><span class='hs-definition'>mpzNeg</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>mb</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>w</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>mb</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>w</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-139"></a>
</pre>\end{code}

Note [Use S# if possible]
~~~~~~~~~~~~~~~~~~~~~~~~~
It's a big win to use S#, rather than J#, whenever possible.  Not only
does it take less space, but (probably more important) subsequent
operations are more efficient. See Trac #8638.

'smartJ#' is the smart constructor for J# that performs the necessary
tests.  When returning a nested result, we always use smartJ# strictly,
thus
       let !r = smartJ# a b in (# r, somthing_else #)
to avoid creating a thunk that is subsequently evaluated to a J#.
smartJ# itself does a pretty small amount of work, so it's not worth
thunking it.

We call 'smartJ#' in places like quotRemInteger where a big input
might produce a small output.

Just using smartJ# in this way has good results:

        Program           Size    Allocs   Runtime   Elapsed  TotalMem
--------------------------------------------------------------------------------
         gamteb          +0.1%    -19.0%      0.03      0.03     +0.0%
          kahan          +0.2%     -1.2%      0.17      0.17     +0.0%
         mandel          +0.1%     -7.7%      0.05      0.05     +0.0%
          power          +0.1%    -40.8%    -32.5%    -32.5%     +0.0%
         symalg          +0.2%     -0.5%      0.01      0.01     +0.0%
--------------------------------------------------------------------------------
            Min          +0.0%    -40.8%    -32.5%    -32.5%     -5.1%
            Max          +0.2%     +0.1%     +2.0%     +2.0%     +0.0%
 Geometric Mean          +0.1%     -1.0%     -2.5%     -2.5%     -0.1%

%*********************************************************
%*                                                      *
\subsection{Dividing @Integers@}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><span class='hs-comment'>-- XXX There's no good reason for us using unboxed tuples for the</span>
<a name="line-2"></a><span class='hs-comment'>-- results, but we don't have Data.Tuple available.</span>
<a name="line-3"></a>
<a name="line-4"></a><span class='hs-comment'>-- Note that we don't check for divide-by-zero here. That needs</span>
<a name="line-5"></a><span class='hs-comment'>-- to be done where it's used.</span>
<a name="line-6"></a><span class='hs-comment'>-- (we don't have error)</span>
<a name="line-7"></a>
<a name="line-8"></a><a name="quotRemInteger"></a><span class='hs-comment'>{-# NOINLINE quotRemInteger #-}</span>
<a name="line-9"></a><span class='hs-definition'>quotRemInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>Integer</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integer</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-10"></a><span class='hs-definition'>quotRemInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>quotRemInteger</span> <span class='hs-varid'>minIntAsBig</span> <span class='hs-varid'>b</span>
<a name="line-11"></a><span class='hs-definition'>quotRemInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>quotRemInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span> <span class='hs-keyword'>of</span>
<a name="line-12"></a>                                   <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>q</span><span class='hs-layout'>,</span> <span class='hs-varid'>r</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>q</span><span class='hs-layout'>,</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>r</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-13"></a><span class='hs-cpp'>#if SIZEOF_HSWORD == SIZEOF_LONG</span>
<a name="line-14"></a><span class='hs-definition'>quotRemInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-15"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>quotRemIntegerWord</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-16"></a>          <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>q</span><span class='hs-layout'>,</span> <span class='hs-varid'>r</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>let</span> <span class='hs-varop'>!</span><span class='hs-varid'>q'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>mpzNeg</span> <span class='hs-varid'>q</span><span class='hs-layout'>)</span>
<a name="line-17"></a>                            <span class='hs-varop'>!</span><span class='hs-varid'>r'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-varid'>r</span>
<a name="line-18"></a>                        <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>q'</span><span class='hs-layout'>,</span> <span class='hs-varid'>r'</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- see also Trac #8726</span>
<a name="line-19"></a><span class='hs-definition'>quotRemInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-20"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger2</span> <span class='hs-layout'>(</span><span class='hs-varid'>quotRemIntegerWord</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-21"></a><span class='hs-cpp'>#else</span>
<a name="line-22"></a><span class='hs-definition'>quotRemInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>quotRemInteger</span> <span class='hs-varid'>i1</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i2</span><span class='hs-layout'>)</span>
<a name="line-23"></a><span class='hs-cpp'>#endif</span>
<a name="line-24"></a><span class='hs-definition'>quotRemInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>quotRemInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i1</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span>
<a name="line-25"></a><span class='hs-definition'>quotRemInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span>
<a name="line-26"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger2</span><span class='hs-layout'>(</span><span class='hs-varid'>quotRemInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- See Note [Use S# if possible]</span>
<a name="line-27"></a>
<a name="line-28"></a><a name="divModInteger"></a><span class='hs-comment'>{-# NOINLINE divModInteger #-}</span>
<a name="line-29"></a><span class='hs-definition'>divModInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>Integer</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integer</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-30"></a><span class='hs-definition'>divModInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>divModInteger</span> <span class='hs-varid'>minIntAsBig</span> <span class='hs-varid'>b</span>
<a name="line-31"></a><span class='hs-definition'>divModInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-layout'>,</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>m</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-32"></a>    <span class='hs-keyword'>where</span>
<a name="line-33"></a>      <span class='hs-comment'>-- NB. don't inline these.  (# S# (i `quotInt#` j), ... #) means</span>
<a name="line-34"></a>      <span class='hs-comment'>-- (# let q = i `quotInt#` j in S# q, ... #) which builds a</span>
<a name="line-35"></a>      <span class='hs-comment'>-- useless thunk.  Placing the bindings here means they'll be</span>
<a name="line-36"></a>      <span class='hs-comment'>-- evaluated strictly.</span>
<a name="line-37"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>d</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span> <span class='hs-varop'>`</span><span class='hs-varid'>divInt</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>j</span>
<a name="line-38"></a>      <span class='hs-varop'>!</span><span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span> <span class='hs-varop'>`</span><span class='hs-varid'>modInt</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>j</span>
<a name="line-39"></a><span class='hs-cpp'>#if SIZEOF_HSWORD == SIZEOF_LONG</span>
<a name="line-40"></a><span class='hs-definition'>divModInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-41"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>divModIntegerWord</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span><span class='hs-layout'>)</span> <span class='hs-varid'>d1</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>of</span>
<a name="line-42"></a>          <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>q</span><span class='hs-layout'>,</span> <span class='hs-varid'>r</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>let</span> <span class='hs-varop'>!</span><span class='hs-varid'>q'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-varid'>q</span>
<a name="line-43"></a>                            <span class='hs-varop'>!</span><span class='hs-varid'>r'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>mpzNeg</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>
<a name="line-44"></a>                        <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>q'</span><span class='hs-layout'>,</span> <span class='hs-varid'>r'</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- see also Trac #8726</span>
<a name="line-45"></a><span class='hs-definition'>divModInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-46"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger2</span><span class='hs-layout'>(</span><span class='hs-varid'>divModIntegerWord</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-47"></a><span class='hs-cpp'>#else</span>
<a name="line-48"></a><span class='hs-definition'>divModInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>divModInteger</span> <span class='hs-varid'>i1</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i2</span><span class='hs-layout'>)</span>
<a name="line-49"></a><span class='hs-cpp'>#endif</span>
<a name="line-50"></a><span class='hs-definition'>divModInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>divModInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i1</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span>
<a name="line-51"></a><span class='hs-definition'>divModInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger2</span> <span class='hs-layout'>(</span><span class='hs-varid'>divModInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span>
<a name="line-52"></a>
<a name="line-53"></a><a name="remInteger"></a><span class='hs-comment'>{-# NOINLINE remInteger #-}</span>
<a name="line-54"></a><span class='hs-definition'>remInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-55"></a><span class='hs-definition'>remInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>remInteger</span> <span class='hs-varid'>minIntAsBig</span> <span class='hs-varid'>b</span>
<a name="line-56"></a><span class='hs-definition'>remInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>remInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-57"></a><span class='hs-comment'>{- Special case doesn't work, because a 1-element J# has the range
<a name="line-58"></a>   -(2^32-1) -- 2^32-1, whereas S# has the range -2^31 -- (2^31-1)
<a name="line-59"></a>remInteger ia@(S# a) (J# sb b)
<a name="line-60"></a>  | sb ==# 1#  = S# (remInt# a (word2Int# (integer2Word# sb b)))
<a name="line-61"></a>  | sb ==# -1# = S# (remInt# a (0# -# (word2Int# (integer2Word# sb b))))
<a name="line-62"></a>  | 0# &lt;# sb   = ia
<a name="line-63"></a>  | otherwise  = S# (0# -# a)
<a name="line-64"></a>-}</span>
<a name="line-65"></a><span class='hs-definition'>remInteger</span> <span class='hs-varid'>ia</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>ib</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>remInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>ia</span><span class='hs-layout'>)</span> <span class='hs-varid'>ib</span>
<a name="line-66"></a><span class='hs-cpp'>#if SIZEOF_HSWORD == SIZEOF_LONG</span>
<a name="line-67"></a><span class='hs-definition'>remInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-68"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>remIntegerWord</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span>
<a name="line-69"></a>  <span class='hs-keyword'>where</span>
<a name="line-70"></a>    <span class='hs-varid'>w</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-71"></a><span class='hs-cpp'>#else</span>
<a name="line-72"></a><span class='hs-definition'>remInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>remInteger</span> <span class='hs-varid'>i1</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i2</span><span class='hs-layout'>)</span>
<a name="line-73"></a><span class='hs-cpp'>#endif</span>
<a name="line-74"></a><span class='hs-definition'>remInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-75"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>remInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-76"></a>
<a name="line-77"></a><a name="quotInteger"></a><span class='hs-comment'>{-# NOINLINE quotInteger #-}</span>
<a name="line-78"></a><span class='hs-definition'>quotInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-79"></a><span class='hs-definition'>quotInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>quotInteger</span> <span class='hs-varid'>minIntAsBig</span> <span class='hs-varid'>b</span>
<a name="line-80"></a><span class='hs-definition'>quotInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>quotInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-81"></a><span class='hs-comment'>{- Special case disabled, see remInteger above
<a name="line-82"></a>quotInteger (S# a) (J# sb b)
<a name="line-83"></a>  | sb ==# 1#  = S# (quotInt# a (word2Int# (integer2Word# sb b)))
<a name="line-84"></a>  | sb ==# -1# = S# (quotInt# a (0# -# (word2Int# (integer2Word# sb b))))
<a name="line-85"></a>  | otherwise  = S# 0
<a name="line-86"></a>-}</span>
<a name="line-87"></a><span class='hs-definition'>quotInteger</span> <span class='hs-varid'>ia</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>ib</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>quotInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>ia</span><span class='hs-layout'>)</span> <span class='hs-varid'>ib</span>
<a name="line-88"></a><span class='hs-cpp'>#if SIZEOF_HSWORD == SIZEOF_LONG</span>
<a name="line-89"></a><span class='hs-definition'>quotInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-90"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>mpzNeg</span> <span class='hs-layout'>(</span><span class='hs-varid'>quotIntegerWord</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-91"></a><span class='hs-definition'>quotInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-92"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>quotIntegerWord</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-93"></a><span class='hs-cpp'>#else</span>
<a name="line-94"></a><span class='hs-definition'>quotInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>quotInteger</span> <span class='hs-varid'>i1</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i2</span><span class='hs-layout'>)</span>
<a name="line-95"></a><span class='hs-cpp'>#endif</span>
<a name="line-96"></a><span class='hs-definition'>quotInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-97"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>quotInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-98"></a>
<a name="line-99"></a><a name="modInteger"></a><span class='hs-comment'>{-# NOINLINE modInteger #-}</span>
<a name="line-100"></a><span class='hs-definition'>modInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-101"></a><span class='hs-definition'>modInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>modInteger</span> <span class='hs-varid'>minIntAsBig</span> <span class='hs-varid'>b</span>
<a name="line-102"></a><span class='hs-definition'>modInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>modInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-103"></a><span class='hs-definition'>modInteger</span> <span class='hs-varid'>ia</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>ib</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>modInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>ia</span><span class='hs-layout'>)</span> <span class='hs-varid'>ib</span>
<a name="line-104"></a><span class='hs-cpp'>#if SIZEOF_HSWORD == SIZEOF_LONG</span>
<a name="line-105"></a><span class='hs-definition'>modInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-106"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>mpzNeg</span> <span class='hs-layout'>(</span><span class='hs-varid'>modIntegerWord</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-107"></a><span class='hs-definition'>modInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-108"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>modIntegerWord</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-109"></a><span class='hs-cpp'>#else</span>
<a name="line-110"></a><span class='hs-definition'>modInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>modInteger</span> <span class='hs-varid'>i1</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i2</span><span class='hs-layout'>)</span>
<a name="line-111"></a><span class='hs-cpp'>#endif</span>
<a name="line-112"></a><span class='hs-definition'>modInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-113"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>modInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-114"></a>
<a name="line-115"></a><a name="divInteger"></a><span class='hs-comment'>{-# NOINLINE divInteger #-}</span>
<a name="line-116"></a><span class='hs-definition'>divInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-117"></a><span class='hs-definition'>divInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>divInteger</span> <span class='hs-varid'>minIntAsBig</span> <span class='hs-varid'>b</span>
<a name="line-118"></a><span class='hs-definition'>divInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>divInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-119"></a><span class='hs-definition'>divInteger</span> <span class='hs-varid'>ia</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>ib</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>divInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>ia</span><span class='hs-layout'>)</span> <span class='hs-varid'>ib</span>
<a name="line-120"></a><span class='hs-cpp'>#if SIZEOF_HSWORD == SIZEOF_LONG</span>
<a name="line-121"></a><span class='hs-definition'>divInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-122"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>divIntegerWord</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-123"></a><span class='hs-definition'>divInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-124"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>divIntegerWord</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-125"></a><span class='hs-cpp'>#else</span>
<a name="line-126"></a><span class='hs-definition'>divInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>divInteger</span> <span class='hs-varid'>i1</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i2</span><span class='hs-layout'>)</span>
<a name="line-127"></a><span class='hs-cpp'>#endif</span>
<a name="line-128"></a><span class='hs-definition'>divInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-129"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>divInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
</pre>\end{code}



\begin{code}
<pre><a name="line-1"></a><a name="gcdInteger"></a><span class='hs-comment'>-- | Compute greatest common divisor.</span>
<a name="line-2"></a><span class='hs-comment'>{-# NOINLINE gcdInteger #-}</span>
<a name="line-3"></a><span class='hs-definition'>gcdInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-4"></a><span class='hs-comment'>-- SUP: Do we really need the first two cases?</span>
<a name="line-5"></a><span class='hs-definition'>gcdInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gcdInteger</span> <span class='hs-varid'>minIntAsBig</span> <span class='hs-varid'>b</span>
<a name="line-6"></a><span class='hs-definition'>gcdInteger</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gcdInteger</span> <span class='hs-varid'>a</span> <span class='hs-varid'>minIntAsBig</span>
<a name="line-7"></a><span class='hs-definition'>gcdInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>gcdInt</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-8"></a><span class='hs-definition'>gcdInteger</span> <span class='hs-varid'>ia</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>  <span class='hs-varid'>ib</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-9"></a> <span class='hs-keyglyph'>=</span>      <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span>  <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>absInteger</span> <span class='hs-varid'>ib</span>
<a name="line-10"></a>   <span class='hs-keyword'>else</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>sb</span> <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>absInteger</span> <span class='hs-varid'>ia</span>
<a name="line-11"></a>   <span class='hs-keyword'>else</span>                             <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>gcdIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>absSb</span> <span class='hs-varid'>b</span> <span class='hs-varid'>absA</span><span class='hs-layout'>)</span>
<a name="line-12"></a>       <span class='hs-keyword'>where</span> <span class='hs-varop'>!</span><span class='hs-varid'>absA</span>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span>  <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span>  <span class='hs-keyword'>else</span> <span class='hs-varid'>a</span>
<a name="line-13"></a>             <span class='hs-varop'>!</span><span class='hs-varid'>absSb</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>sb</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>sb</span>
<a name="line-14"></a><span class='hs-definition'>gcdInteger</span> <span class='hs-varid'>ia</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>ib</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gcdInteger</span> <span class='hs-varid'>ib</span> <span class='hs-varid'>ia</span>
<a name="line-15"></a><span class='hs-definition'>gcdInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>gcdInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-16"></a>
<a name="line-17"></a><a name="gcdExtInteger"></a><span class='hs-comment'>-- | Extended euclidean algorithm.</span>
<a name="line-18"></a><span class='hs-comment'>--</span>
<a name="line-19"></a><span class='hs-comment'>-- For @/a/@ and @/b/@, compute their greatest common divisor @/g/@</span>
<a name="line-20"></a><span class='hs-comment'>-- and the coefficient @/s/@ satisfying @/a//s/ + /b//t/ = /g/@.</span>
<a name="line-21"></a><span class='hs-comment'>--</span>
<a name="line-22"></a><span class='hs-comment'>-- /Since: 0.5.1.0/</span>
<a name="line-23"></a><span class='hs-comment'>{-# NOINLINE gcdExtInteger #-}</span>
<a name="line-24"></a><span class='hs-definition'>gcdExtInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>Integer</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integer</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-25"></a><span class='hs-definition'>gcdExtInteger</span> <span class='hs-varid'>a</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>   <span class='hs-varid'>b</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gcdExtInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-26"></a><span class='hs-definition'>gcdExtInteger</span> <span class='hs-varid'>a</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gcdExtInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span>
<a name="line-27"></a><span class='hs-definition'>gcdExtInteger</span> <span class='hs-varid'>a</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gcdExtInteger</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-28"></a><span class='hs-definition'>gcdExtInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger2</span> <span class='hs-layout'>(</span><span class='hs-varid'>gcdExtInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-29"></a>
<a name="line-30"></a><a name="lcmInteger"></a><span class='hs-comment'>-- | Compute least common multiple.</span>
<a name="line-31"></a><span class='hs-comment'>{-# NOINLINE lcmInteger #-}</span>
<a name="line-32"></a><span class='hs-definition'>lcmInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-33"></a><span class='hs-definition'>lcmInteger</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span>      <span class='hs-keyword'>if</span> <span class='hs-varid'>a</span> <span class='hs-varop'>`eqInteger`</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-34"></a>                 <span class='hs-keyword'>else</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>b</span> <span class='hs-varop'>`eqInteger`</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-35"></a>                 <span class='hs-keyword'>else</span> <span class='hs-layout'>(</span><span class='hs-varid'>divExact</span> <span class='hs-varid'>aa</span> <span class='hs-layout'>(</span><span class='hs-varid'>gcdInteger</span> <span class='hs-varid'>aa</span> <span class='hs-varid'>ab</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varop'>`timesInteger`</span> <span class='hs-varid'>ab</span>
<a name="line-36"></a>  <span class='hs-keyword'>where</span> <span class='hs-varid'>aa</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>absInteger</span> <span class='hs-varid'>a</span>
<a name="line-37"></a>        <span class='hs-varid'>ab</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>absInteger</span> <span class='hs-varid'>b</span>
<a name="line-38"></a>
<a name="line-39"></a><a name="gcdInt"></a><span class='hs-comment'>-- | Compute greatest common divisor.</span>
<a name="line-40"></a><span class='hs-definition'>gcdInt</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-41"></a><span class='hs-definition'>gcdInt</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-varid'>y</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>absInt</span> <span class='hs-varid'>y</span>
<a name="line-42"></a><span class='hs-definition'>gcdInt</span> <span class='hs-varid'>x</span>  <span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>absInt</span> <span class='hs-varid'>x</span>
<a name="line-43"></a><span class='hs-definition'>gcdInt</span> <span class='hs-varid'>x</span>  <span class='hs-varid'>y</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gcdInt</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>absInt</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>absInt</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span>
<a name="line-44"></a>
<a name="line-45"></a><a name="absInt"></a><span class='hs-definition'>absInt</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-46"></a><span class='hs-definition'>absInt</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>else</span> <span class='hs-varid'>x</span>
<a name="line-47"></a>
<a name="line-48"></a><a name="divExact"></a><span class='hs-definition'>divExact</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-49"></a><span class='hs-definition'>divExact</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>divExact</span> <span class='hs-varid'>minIntAsBig</span> <span class='hs-varid'>b</span>
<a name="line-50"></a><span class='hs-definition'>divExact</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>quotInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-51"></a><span class='hs-definition'>divExact</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-52"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>quotInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>integer2Int</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-53"></a><span class='hs-cpp'>#if SIZEOF_HSWORD == SIZEOF_LONG</span>
<a name="line-54"></a><span class='hs-definition'>divExact</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-55"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>divExactIntegerWord</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-56"></a><span class='hs-definition'>divExact</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>divExactIntegerWord</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-57"></a><span class='hs-cpp'>#else</span>
<a name="line-58"></a><span class='hs-definition'>divExact</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>divExact</span> <span class='hs-varid'>i1</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i2</span><span class='hs-layout'>)</span>
<a name="line-59"></a><span class='hs-cpp'>#endif</span>
<a name="line-60"></a><span class='hs-definition'>divExact</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>divExactInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>sa</span> <span class='hs-varid'>a</span> <span class='hs-varid'>sb</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
</pre>\end{code}


%*********************************************************
%*                                                      *
\subsection{The @Integer@ instances for @Eq@, @Ord@}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a>
<a name="line-2"></a><a name="eqInteger"></a><span class='hs-comment'>-- | /Since: 0.5.1.0/</span>
<a name="line-3"></a><span class='hs-comment'>{-# NOINLINE eqInteger# #-}</span>
<a name="line-4"></a><span class='hs-definition'>eqInteger</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-5"></a><span class='hs-definition'>eqInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span> <span class='hs-varop'>==#</span> <span class='hs-varid'>j</span>
<a name="line-6"></a><span class='hs-definition'>eqInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-7"></a><span class='hs-definition'>eqInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-8"></a><span class='hs-definition'>eqInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>cmpInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-9"></a>
<a name="line-10"></a><a name="neqInteger"></a><span class='hs-comment'>-- | /Since: 0.5.1.0/</span>
<a name="line-11"></a><span class='hs-comment'>{-# NOINLINE neqInteger# #-}</span>
<a name="line-12"></a><span class='hs-definition'>neqInteger</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-13"></a><span class='hs-definition'>neqInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span> <span class='hs-varop'>/=#</span> <span class='hs-varid'>j</span>
<a name="line-14"></a><span class='hs-definition'>neqInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>/=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-15"></a><span class='hs-definition'>neqInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>/=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-16"></a><span class='hs-definition'>neqInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>cmpInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-varop'>/=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-17"></a>
<a name="line-18"></a><span class='hs-comment'>{-# INLINE eqInteger  #-}</span>
<a name="line-19"></a><span class='hs-comment'>{-# INLINE neqInteger #-}</span>
<a name="line-20"></a><span class='hs-definition'>eqInteger</span><span class='hs-layout'>,</span> <span class='hs-varid'>neqInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-21"></a><span class='hs-definition'>eqInteger</span>  <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-varop'>`</span><span class='hs-varid'>eqInteger</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span>  <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-22"></a><span class='hs-definition'>neqInteger</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-varop'>`</span><span class='hs-varid'>neqInteger</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-23"></a>
<a name="line-24"></a><span class='hs-keyword'>instance</span>  <span class='hs-conid'>Eq</span> <span class='hs-conid'>Integer</span>  <span class='hs-keyword'>where</span>
<a name="line-25"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>==</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>eqInteger</span>
<a name="line-26"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>/=</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>neqInteger</span>
<a name="line-27"></a>
<a name="line-28"></a><span class='hs-comment'>------------------------------------------------------------------------</span>
<a name="line-29"></a>
<a name="line-30"></a><a name="leInteger"></a><span class='hs-comment'>-- | /Since: 0.5.1.0/</span>
<a name="line-31"></a><span class='hs-comment'>{-# NOINLINE leInteger# #-}</span>
<a name="line-32"></a><span class='hs-definition'>leInteger</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-33"></a><span class='hs-definition'>leInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&lt;=#</span> <span class='hs-varid'>j</span>
<a name="line-34"></a><span class='hs-definition'>leInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&lt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-35"></a><span class='hs-definition'>leInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&gt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-36"></a><span class='hs-definition'>leInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>cmpInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-37"></a>
<a name="line-38"></a><a name="gtInteger"></a><span class='hs-comment'>-- | /Since: 0.5.1.0/</span>
<a name="line-39"></a><span class='hs-comment'>{-# NOINLINE gtInteger# #-}</span>
<a name="line-40"></a><span class='hs-definition'>gtInteger</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-41"></a><span class='hs-definition'>gtInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&gt;#</span> <span class='hs-varid'>j</span>
<a name="line-42"></a><span class='hs-definition'>gtInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&gt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-43"></a><span class='hs-definition'>gtInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-44"></a><span class='hs-definition'>gtInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>cmpInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-45"></a>
<a name="line-46"></a><a name="ltInteger"></a><span class='hs-comment'>-- | /Since: 0.5.1.0/</span>
<a name="line-47"></a><span class='hs-comment'>{-# NOINLINE ltInteger# #-}</span>
<a name="line-48"></a><span class='hs-definition'>ltInteger</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-49"></a><span class='hs-definition'>ltInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&lt;#</span> <span class='hs-varid'>j</span>
<a name="line-50"></a><span class='hs-definition'>ltInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-51"></a><span class='hs-definition'>ltInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&gt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-52"></a><span class='hs-definition'>ltInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>cmpInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-53"></a>
<a name="line-54"></a><a name="geInteger"></a><span class='hs-comment'>-- | /Since: 0.5.1.0/</span>
<a name="line-55"></a><span class='hs-comment'>{-# NOINLINE geInteger# #-}</span>
<a name="line-56"></a><span class='hs-definition'>geInteger</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-57"></a><span class='hs-definition'>geInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&gt;=#</span> <span class='hs-varid'>j</span>
<a name="line-58"></a><span class='hs-definition'>geInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&gt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-59"></a><span class='hs-definition'>geInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&lt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-60"></a><span class='hs-definition'>geInteger</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>cmpInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-61"></a>
<a name="line-62"></a><span class='hs-comment'>{-# INLINE leInteger #-}</span>
<a name="line-63"></a><span class='hs-comment'>{-# INLINE ltInteger #-}</span>
<a name="line-64"></a><span class='hs-comment'>{-# INLINE geInteger #-}</span>
<a name="line-65"></a><span class='hs-comment'>{-# INLINE gtInteger #-}</span>
<a name="line-66"></a><span class='hs-definition'>leInteger</span><span class='hs-layout'>,</span> <span class='hs-varid'>gtInteger</span><span class='hs-layout'>,</span> <span class='hs-varid'>ltInteger</span><span class='hs-layout'>,</span> <span class='hs-varid'>geInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-67"></a><span class='hs-definition'>leInteger</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-varop'>`</span><span class='hs-varid'>leInteger</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-68"></a><span class='hs-definition'>gtInteger</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-varop'>`</span><span class='hs-varid'>gtInteger</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-69"></a><span class='hs-definition'>ltInteger</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-varop'>`</span><span class='hs-varid'>ltInteger</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-70"></a><span class='hs-definition'>geInteger</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-varop'>`</span><span class='hs-varid'>geInteger</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-71"></a>
<a name="line-72"></a><a name="compareInteger"></a><span class='hs-comment'>{-# NOINLINE compareInteger #-}</span>
<a name="line-73"></a><span class='hs-definition'>compareInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ordering</span>
<a name="line-74"></a><span class='hs-definition'>compareInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>  <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>
<a name="line-75"></a>   <span class='hs-keyglyph'>=</span>      <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span> <span class='hs-varop'>==#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>EQ</span>
<a name="line-76"></a>     <span class='hs-keyword'>else</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span> <span class='hs-varop'>&lt;=#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>LT</span>
<a name="line-77"></a>     <span class='hs-keyword'>else</span>                           <span class='hs-conid'>GT</span>
<a name="line-78"></a><span class='hs-definition'>compareInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>
<a name="line-79"></a>   <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-varid'>res</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-80"></a>     <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>res</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>LT</span> <span class='hs-keyword'>else</span>
<a name="line-81"></a>     <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>res</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&gt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>GT</span> <span class='hs-keyword'>else</span> <span class='hs-conid'>EQ</span>
<a name="line-82"></a>     <span class='hs-layout'>}</span>
<a name="line-83"></a><span class='hs-definition'>compareInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-84"></a>   <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-varid'>res</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-85"></a>     <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>res</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&gt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>LT</span> <span class='hs-keyword'>else</span>
<a name="line-86"></a>     <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>res</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>GT</span> <span class='hs-keyword'>else</span> <span class='hs-conid'>EQ</span>
<a name="line-87"></a>     <span class='hs-layout'>}</span>
<a name="line-88"></a><span class='hs-definition'>compareInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span>
<a name="line-89"></a>   <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>cmpInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span> <span class='hs-keyword'>of</span> <span class='hs-layout'>{</span> <span class='hs-varid'>res</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-90"></a>     <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>res</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>LT</span> <span class='hs-keyword'>else</span>
<a name="line-91"></a>     <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>res</span><span class='hs-cpp'>#</span> <span class='hs-varop'>&gt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>GT</span> <span class='hs-keyword'>else</span> <span class='hs-conid'>EQ</span>
<a name="line-92"></a>     <span class='hs-layout'>}</span>
<a name="line-93"></a>
<a name="line-94"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Ord</span> <span class='hs-conid'>Integer</span> <span class='hs-keyword'>where</span>
<a name="line-95"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>&lt;=</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>leInteger</span>
<a name="line-96"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>&lt;</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ltInteger</span>
<a name="line-97"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>&gt;</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>gtInteger</span>
<a name="line-98"></a>    <span class='hs-layout'>(</span><span class='hs-varop'>&gt;=</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>geInteger</span>
<a name="line-99"></a>    <span class='hs-varid'>compare</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>compareInteger</span>
</pre>\end{code}


%*********************************************************
%*                                                      *
\subsection{The @Integer@ instances for @Num@}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><a name="absInteger"></a><span class='hs-comment'>{-# NOINLINE absInteger #-}</span>
<a name="line-2"></a><span class='hs-definition'>absInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-3"></a><span class='hs-definition'>absInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NEG_INT_MINBOUND</span>
<a name="line-4"></a><span class='hs-definition'>absInteger</span> <span class='hs-varid'>n</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span> <span class='hs-varop'>&gt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>else</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>
<a name="line-5"></a><span class='hs-definition'>absInteger</span> <span class='hs-varid'>n</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>s</span> <span class='hs-varop'>&gt;=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>else</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span>
<a name="line-6"></a>
<a name="line-7"></a><a name="signumInteger"></a><span class='hs-comment'>{-# NOINLINE signumInteger #-}</span>
<a name="line-8"></a><span class='hs-definition'>signumInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-9"></a><span class='hs-definition'>signumInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span> <span class='hs-varop'>&lt;#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-cpp'>#</span>
<a name="line-10"></a>                       <span class='hs-keyword'>else</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span> <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-11"></a>                       <span class='hs-keyword'>else</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>1</span><span class='hs-cpp'>#</span>
<a name="line-12"></a><span class='hs-definition'>signumInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-13"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span>
<a name="line-14"></a>        <span class='hs-varop'>!</span><span class='hs-varid'>cmp</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cmpIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-15"></a>    <span class='hs-keyword'>in</span>
<a name="line-16"></a>    <span class='hs-keyword'>if</span>      <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>cmp</span> <span class='hs-varop'>&gt;#</span>  <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>1</span><span class='hs-cpp'>#</span>
<a name="line-17"></a>    <span class='hs-keyword'>else</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>cmp</span> <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-18"></a>    <span class='hs-keyword'>else</span>                              <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-num'>1</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-19"></a>
<a name="line-20"></a><a name="plusInteger"></a><span class='hs-comment'>{-# NOINLINE plusInteger #-}</span>
<a name="line-21"></a><span class='hs-definition'>plusInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-22"></a><span class='hs-definition'>plusInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>      <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>addIntC</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span> <span class='hs-keyword'>of</span>
<a name="line-23"></a>                                   <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-varid'>c</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-24"></a>                                       <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span> <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-25"></a>                                       <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>r</span>
<a name="line-26"></a><span class='hs-cpp'>#if SIZEOF_HSWORD == SIZEOF_LONG</span>
<a name="line-27"></a>                                       <span class='hs-keyword'>else</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>int2Integer</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-keyword'>of</span>
<a name="line-28"></a>                                            <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>plusIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>
<a name="line-29"></a><span class='hs-cpp'>#else</span>
<a name="line-30"></a>                                       <span class='hs-keyword'>else</span> <span class='hs-varid'>plusInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-31"></a><span class='hs-cpp'>#endif</span>
<a name="line-32"></a><span class='hs-definition'>plusInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i1</span>
<a name="line-33"></a><span class='hs-cpp'>#if SIZEOF_HSWORD == SIZEOF_LONG</span>
<a name="line-34"></a><span class='hs-definition'>plusInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span>  <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>plusIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>
<a name="line-35"></a><span class='hs-cpp'>#else</span>
<a name="line-36"></a><span class='hs-definition'>plusInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>plusInteger</span> <span class='hs-varid'>i1</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i2</span><span class='hs-layout'>)</span>
<a name="line-37"></a><span class='hs-cpp'>#endif</span>
<a name="line-38"></a><span class='hs-definition'>plusInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>plusInteger</span> <span class='hs-varid'>i2</span> <span class='hs-varid'>i1</span>
<a name="line-39"></a><span class='hs-definition'>plusInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>plusInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span>
<a name="line-40"></a>
<a name="line-41"></a><a name="minusInteger"></a><span class='hs-comment'>{-# NOINLINE minusInteger #-}</span>
<a name="line-42"></a><span class='hs-definition'>minusInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-43"></a><span class='hs-definition'>minusInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>      <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>subIntC</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span> <span class='hs-keyword'>of</span>
<a name="line-44"></a>                                     <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-varid'>c</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-45"></a>                                         <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>c</span> <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>r</span>
<a name="line-46"></a><span class='hs-cpp'>#if SIZEOF_HSWORD == SIZEOF_LONG</span>
<a name="line-47"></a>                                         <span class='hs-keyword'>else</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>int2Integer</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-keyword'>of</span>
<a name="line-48"></a>                                              <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>minusIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>
<a name="line-49"></a><span class='hs-cpp'>#else</span>
<a name="line-50"></a>                                         <span class='hs-keyword'>else</span> <span class='hs-varid'>minusInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-51"></a><span class='hs-cpp'>#endif</span>
<a name="line-52"></a><span class='hs-definition'>minusInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i1</span>
<a name="line-53"></a><span class='hs-definition'>minusInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>    <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span><span class='hs-layout'>)</span> <span class='hs-varid'>d2</span>
<a name="line-54"></a><span class='hs-cpp'>#if SIZEOF_HSWORD == SIZEOF_LONG</span>
<a name="line-55"></a><span class='hs-definition'>minusInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span>  <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>minusIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>
<a name="line-56"></a><span class='hs-definition'>minusInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>     <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>plusIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span><span class='hs-layout'>)</span> <span class='hs-varid'>d2</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>
<a name="line-57"></a><span class='hs-cpp'>#else</span>
<a name="line-58"></a><span class='hs-definition'>minusInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>minusInteger</span> <span class='hs-varid'>i1</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i2</span><span class='hs-layout'>)</span>
<a name="line-59"></a><span class='hs-definition'>minusInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>minusInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i1</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span>
<a name="line-60"></a><span class='hs-cpp'>#endif</span>
<a name="line-61"></a><span class='hs-definition'>minusInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>minusInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span>
<a name="line-62"></a>
<a name="line-63"></a><a name="timesInteger"></a><span class='hs-comment'>{-# NOINLINE timesInteger #-}</span>
<a name="line-64"></a><span class='hs-definition'>timesInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-65"></a><span class='hs-definition'>timesInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>mulIntMayOflo</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span> <span class='hs-varop'>==#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-66"></a>                                     <span class='hs-keyword'>then</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span> <span class='hs-varop'>*#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>
<a name="line-67"></a><span class='hs-cpp'>#if SIZEOF_HSWORD == SIZEOF_LONG</span>
<a name="line-68"></a>                                     <span class='hs-keyword'>else</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>int2Integer</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-keyword'>of</span>
<a name="line-69"></a>                                          <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-varid'>d</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>timesIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>
<a name="line-70"></a><span class='hs-cpp'>#else</span>
<a name="line-71"></a>                                     <span class='hs-keyword'>else</span> <span class='hs-varid'>timesInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-72"></a><span class='hs-cpp'>#endif</span>
<a name="line-73"></a><span class='hs-definition'>timesInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>     <span class='hs-keyword'>_</span>         <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-74"></a><span class='hs-definition'>timesInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>    <span class='hs-varid'>i2</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>negateInteger</span> <span class='hs-varid'>i2</span>
<a name="line-75"></a><span class='hs-definition'>timesInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-num'>1</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>     <span class='hs-varid'>i2</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i2</span>
<a name="line-76"></a><span class='hs-cpp'>#if SIZEOF_HSWORD == SIZEOF_LONG</span>
<a name="line-77"></a><span class='hs-definition'>timesInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i1</span><span class='hs-layout'>)</span>    <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>timesIntegerInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span> <span class='hs-varid'>i1</span><span class='hs-layout'>)</span>
<a name="line-78"></a><span class='hs-cpp'>#else</span>
<a name="line-79"></a><span class='hs-definition'>timesInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>timesInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>i1</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span>
<a name="line-80"></a><span class='hs-cpp'>#endif</span>
<a name="line-81"></a><span class='hs-definition'>timesInteger</span> <span class='hs-varid'>i1</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i2</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>timesInteger</span> <span class='hs-varid'>i2</span> <span class='hs-varid'>i1</span> <span class='hs-comment'>-- swap args &amp; retry</span>
<a name="line-82"></a><span class='hs-definition'>timesInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>timesInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span>
<a name="line-83"></a>
<a name="line-84"></a><a name="negateInteger"></a><span class='hs-comment'>{-# NOINLINE negateInteger #-}</span>
<a name="line-85"></a><span class='hs-definition'>negateInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-86"></a><span class='hs-definition'>negateInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-conid'>INT_MINBOUND</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>NEG_INT_MINBOUND</span>
<a name="line-87"></a><span class='hs-definition'>negateInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>            <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>
<a name="line-88"></a><span class='hs-definition'>negateInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span> <span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>negateInt</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-varid'>d</span>
</pre>\end{code}


%*********************************************************
%*                                                      *
\subsection{The @Integer@ stuff for Double@}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><a name="encodeFloatInteger"></a><span class='hs-comment'>{-# NOINLINE encodeFloatInteger #-}</span>
<a name="line-2"></a><span class='hs-definition'>encodeFloatInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Float</span><span class='hs-cpp'>#</span>
<a name="line-3"></a><span class='hs-definition'>encodeFloatInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>j</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>int_encodeFloat</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span>
<a name="line-4"></a><span class='hs-definition'>encodeFloatInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>encodeFloat</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-cpp'>#</span> <span class='hs-varid'>e</span>
<a name="line-5"></a>
<a name="line-6"></a><a name="encodeDoubleInteger"></a><span class='hs-comment'>{-# NOINLINE encodeDoubleInteger #-}</span>
<a name="line-7"></a><span class='hs-definition'>encodeDoubleInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span><span class='hs-cpp'>#</span>
<a name="line-8"></a><span class='hs-definition'>encodeDoubleInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-varid'>j</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>int_encodeDouble</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span> <span class='hs-varid'>j</span>
<a name="line-9"></a><span class='hs-definition'>encodeDoubleInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>encodeDouble</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-cpp'>#</span> <span class='hs-varid'>e</span>
<a name="line-10"></a>
<a name="line-11"></a><a name="decodeDoubleInteger"></a><span class='hs-comment'>{-# NOINLINE decodeDoubleInteger #-}</span>
<a name="line-12"></a><span class='hs-definition'>decodeDoubleInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>Integer</span><span class='hs-layout'>,</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-13"></a><span class='hs-definition'>decodeDoubleInteger</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>decodeDouble</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span> <span class='hs-keyword'>of</span>
<a name="line-14"></a>                        <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>exp</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>man</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>let</span> <span class='hs-varop'>!</span><span class='hs-varid'>man</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-varid'>man</span><span class='hs-cpp'>#</span>
<a name="line-15"></a>                                            <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>man</span><span class='hs-layout'>,</span> <span class='hs-varid'>exp</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-16"></a>
<a name="line-17"></a><span class='hs-comment'>-- previous code: doubleFromInteger n = fromInteger n = encodeFloat n 0</span>
<a name="line-18"></a><span class='hs-comment'>-- doesn't work too well, because encodeFloat is defined in</span>
<a name="line-19"></a><span class='hs-comment'>-- terms of ccalls which can never be simplified away.  We</span>
<a name="line-20"></a><span class='hs-comment'>-- want simple literals like (fromInteger 3 :: Float) to turn</span>
<a name="line-21"></a><span class='hs-comment'>-- into (F# 3.0), hence the special case for S# here.</span>
<a name="line-22"></a>
<a name="line-23"></a><a name="doubleFromInteger"></a><span class='hs-comment'>{-# NOINLINE doubleFromInteger #-}</span>
<a name="line-24"></a><span class='hs-definition'>doubleFromInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span><span class='hs-cpp'>#</span>
<a name="line-25"></a><span class='hs-definition'>doubleFromInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>int2Double</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-cpp'>#</span>
<a name="line-26"></a><span class='hs-definition'>doubleFromInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>encodeDouble</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-27"></a>
<a name="line-28"></a><a name="floatFromInteger"></a><span class='hs-comment'>{-# NOINLINE floatFromInteger #-}</span>
<a name="line-29"></a><span class='hs-definition'>floatFromInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Float</span><span class='hs-cpp'>#</span>
<a name="line-30"></a><span class='hs-definition'>floatFromInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>int2Float</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-cpp'>#</span>
<a name="line-31"></a><span class='hs-definition'>floatFromInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>encodeFloat</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-cpp'>#</span> <span class='hs-varid'>d</span><span class='hs-cpp'>#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span>
<a name="line-32"></a>
<a name="line-33"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_cbits_encodeFloat"</span>
<a name="line-34"></a>        <span class='hs-varid'>encodeFloat</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Float</span><span class='hs-cpp'>#</span>
<a name="line-35"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"__int_encodeFloat"</span>
<a name="line-36"></a>        <span class='hs-varid'>int_encodeFloat</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Float</span><span class='hs-cpp'>#</span>
<a name="line-37"></a>
<a name="line-38"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"integer_cbits_encodeDouble"</span>
<a name="line-39"></a>        <span class='hs-varid'>encodeDouble</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span><span class='hs-cpp'>#</span>
<a name="line-40"></a><span class='hs-keyword'>foreign</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>ccall</span> <span class='hs-keyword'>unsafe</span> <span class='hs-str'>"__int_encodeDouble"</span>
<a name="line-41"></a>        <span class='hs-varid'>int_encodeDouble</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span><span class='hs-cpp'>#</span>
</pre>\end{code}

%*********************************************************
%*                                                      *
\subsection{The @Integer@ Bit definitions@}
%*                                                      *
%*********************************************************

We explicitly pattern match against J# and S# in order to produce
Core that doesn't have pattern matching errors, as that would
introduce a spurious dependency to base.

\begin{code}
<pre><a name="line-1"></a><a name="andInteger"></a><span class='hs-comment'>{-# NOINLINE andInteger #-}</span>
<a name="line-2"></a><span class='hs-definition'>andInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-3"></a><a name="andInteger"></a><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>     <span class='hs-varop'>`andInteger`</span>   <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>word2Int</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`</span><span class='hs-varid'>and</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-4"></a><a name="x"></a><span class='hs-definition'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>   <span class='hs-varop'>`andInteger`</span> <span class='hs-varid'>y</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toBig</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`andInteger`</span> <span class='hs-varid'>y</span>
<a name="line-5"></a><span class='hs-definition'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varop'>`andInteger`</span> <span class='hs-varid'>y</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`andInteger`</span> <span class='hs-varid'>toBig</span> <span class='hs-varid'>y</span>
<a name="line-6"></a><a name="andInteger"></a><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-varop'>`andInteger`</span>   <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-7"></a>     <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>andInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span>
<a name="line-8"></a>
<a name="line-9"></a><a name="orInteger"></a><span class='hs-comment'>{-# NOINLINE orInteger #-}</span>
<a name="line-10"></a><span class='hs-definition'>orInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-11"></a><a name="orInteger"></a><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>     <span class='hs-varop'>`orInteger`</span>   <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>word2Int</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`</span><span class='hs-varid'>or</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-12"></a><span class='hs-definition'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>   <span class='hs-varop'>`orInteger`</span> <span class='hs-varid'>y</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toBig</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`orInteger`</span> <span class='hs-varid'>y</span>
<a name="line-13"></a><span class='hs-definition'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varop'>`orInteger`</span> <span class='hs-varid'>y</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`orInteger`</span> <span class='hs-varid'>toBig</span> <span class='hs-varid'>y</span>
<a name="line-14"></a><a name="orInteger"></a><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-varop'>`orInteger`</span>   <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-15"></a>     <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>orInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span>
<a name="line-16"></a>
<a name="line-17"></a><a name="xorInteger"></a><span class='hs-comment'>{-# NOINLINE xorInteger #-}</span>
<a name="line-18"></a><span class='hs-definition'>xorInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-19"></a><a name="xorInteger"></a><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>     <span class='hs-varop'>`xorInteger`</span>   <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>word2Int</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`</span><span class='hs-varid'>xor</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-20"></a><span class='hs-definition'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>   <span class='hs-varop'>`xorInteger`</span> <span class='hs-varid'>y</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toBig</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`xorInteger`</span> <span class='hs-varid'>y</span>
<a name="line-21"></a><span class='hs-definition'>x</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varop'>`xorInteger`</span> <span class='hs-varid'>y</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`xorInteger`</span> <span class='hs-varid'>toBig</span> <span class='hs-varid'>y</span>
<a name="line-22"></a><a name="xorInteger"></a><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-varop'>`xorInteger`</span>   <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-23"></a>     <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>xorInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span>
<a name="line-24"></a>
<a name="line-25"></a><a name="complementInteger"></a><span class='hs-comment'>{-# NOINLINE complementInteger #-}</span>
<a name="line-26"></a><span class='hs-definition'>complementInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-27"></a><span class='hs-definition'>complementInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-28"></a>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>word2Int</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`</span><span class='hs-varid'>xor</span><span class='hs-cpp'>#</span><span class='hs-varop'>`</span> <span class='hs-varid'>int2Word</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-cpp'>#</span> <span class='hs-varop'>-#</span> <span class='hs-num'>1</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-29"></a><span class='hs-definition'>complementInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-30"></a>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>complementInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-31"></a>
<a name="line-32"></a><a name="shiftLInteger"></a><span class='hs-comment'>{-# NOINLINE shiftLInteger #-}</span>
<a name="line-33"></a><span class='hs-definition'>shiftLInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-34"></a><span class='hs-definition'>shiftLInteger</span> <span class='hs-varid'>j</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>shiftLInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>i</span>
<a name="line-35"></a><span class='hs-definition'>shiftLInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>mul2ExpInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>
<a name="line-36"></a>
<a name="line-37"></a><a name="shiftRInteger"></a><span class='hs-comment'>{-# NOINLINE shiftRInteger #-}</span>
<a name="line-38"></a><span class='hs-definition'>shiftRInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-39"></a><span class='hs-definition'>shiftRInteger</span> <span class='hs-varid'>j</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>shiftRInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>i</span>
<a name="line-40"></a><span class='hs-definition'>shiftRInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>fdivQ2ExpInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span>
<a name="line-41"></a>
<a name="line-42"></a><a name="testBitInteger"></a><span class='hs-comment'>-- | /Since: 0.5.1.0/</span>
<a name="line-43"></a><span class='hs-comment'>{-# NOINLINE testBitInteger #-}</span>
<a name="line-44"></a><span class='hs-definition'>testBitInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-45"></a><span class='hs-definition'>testBitInteger</span> <span class='hs-varid'>j</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>testBitInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>i</span>
<a name="line-46"></a><span class='hs-definition'>testBitInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isTrue</span><span class='hs-cpp'>#</span> <span class='hs-layout'>(</span><span class='hs-varid'>testBitInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>i</span> <span class='hs-varop'>/=#</span> <span class='hs-num'>0</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-47"></a>
<a name="line-48"></a><a name="powInteger"></a><span class='hs-comment'>-- | \"@'powInteger' /b/ /e/@\" computes base @/b/@ raised to exponent @/e/@.</span>
<a name="line-49"></a><span class='hs-comment'>--</span>
<a name="line-50"></a><span class='hs-comment'>-- /Since: 0.5.1.0/</span>
<a name="line-51"></a><span class='hs-comment'>{-# NOINLINE powInteger #-}</span>
<a name="line-52"></a><span class='hs-definition'>powInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-53"></a><span class='hs-definition'>powInteger</span> <span class='hs-varid'>j</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>powInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span>
<a name="line-54"></a><span class='hs-definition'>powInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>powInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-55"></a>
<a name="line-56"></a><a name="powModInteger"></a><span class='hs-comment'>-- | \"@'powModInteger' /b/ /e/ /m/@\" computes base @/b/@ raised to</span>
<a name="line-57"></a><span class='hs-comment'>-- exponent @/e/@ modulo @/m/@.</span>
<a name="line-58"></a><span class='hs-comment'>--</span>
<a name="line-59"></a><span class='hs-comment'>-- Negative exponents are supported if an inverse modulo @/m/@</span>
<a name="line-60"></a><span class='hs-comment'>-- exists. It's advised to avoid calling this primitive with negative</span>
<a name="line-61"></a><span class='hs-comment'>-- exponents unless it is guaranteed the inverse exists, as failure to</span>
<a name="line-62"></a><span class='hs-comment'>-- do so will likely cause program abortion due to a divide-by-zero</span>
<a name="line-63"></a><span class='hs-comment'>-- fault. See also 'recipModInteger'.</span>
<a name="line-64"></a><span class='hs-comment'>--</span>
<a name="line-65"></a><span class='hs-comment'>-- /Since: 0.5.1.0/</span>
<a name="line-66"></a><span class='hs-comment'>{-# NOINLINE powModInteger #-}</span>
<a name="line-67"></a><span class='hs-definition'>powModInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-68"></a><span class='hs-definition'>powModInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s3</span> <span class='hs-varid'>d3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-69"></a>    <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>powModInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span> <span class='hs-varid'>s3</span> <span class='hs-varid'>d3</span><span class='hs-layout'>)</span>
<a name="line-70"></a><span class='hs-definition'>powModInteger</span> <span class='hs-varid'>b</span> <span class='hs-varid'>e</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>powModInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span>
<a name="line-71"></a>
<a name="line-72"></a><a name="powModSecInteger"></a><span class='hs-comment'>-- | \"@'powModSecInteger' /b/ /e/ /m/@\" computes base @/b/@ raised to</span>
<a name="line-73"></a><span class='hs-comment'>-- exponent @/e/@ modulo @/m/@. It is required that @/e/ &gt; 0@ and</span>
<a name="line-74"></a><span class='hs-comment'>-- @/m/@ is odd.</span>
<a name="line-75"></a><span class='hs-comment'>--</span>
<a name="line-76"></a><span class='hs-comment'>-- This is a \"secure\" variant of 'powModInteger' using the</span>
<a name="line-77"></a><span class='hs-comment'>-- @mpz_powm_sec()@ function which is designed to be resilient to side</span>
<a name="line-78"></a><span class='hs-comment'>-- channel attacks and is therefore intended for cryptographic</span>
<a name="line-79"></a><span class='hs-comment'>-- applications.</span>
<a name="line-80"></a><span class='hs-comment'>--</span>
<a name="line-81"></a><span class='hs-comment'>-- This primitive is only available when the underlying GMP library</span>
<a name="line-82"></a><span class='hs-comment'>-- supports it (GMP &gt;= 5). Otherwise, it internally falls back to</span>
<a name="line-83"></a><span class='hs-comment'>-- @'powModInteger'@, and a warning will be emitted when used.</span>
<a name="line-84"></a><span class='hs-comment'>--</span>
<a name="line-85"></a><span class='hs-comment'>-- /Since: 0.5.1.0/</span>
<a name="line-86"></a><span class='hs-comment'>{-# NOINLINE powModSecInteger #-}</span>
<a name="line-87"></a><span class='hs-definition'>powModSecInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-88"></a><span class='hs-definition'>powModSecInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s3</span> <span class='hs-varid'>d3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<a name="line-89"></a>    <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>powModSecInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s1</span> <span class='hs-varid'>d1</span> <span class='hs-varid'>s2</span> <span class='hs-varid'>d2</span> <span class='hs-varid'>s3</span> <span class='hs-varid'>d3</span><span class='hs-layout'>)</span>
<a name="line-90"></a><span class='hs-definition'>powModSecInteger</span> <span class='hs-varid'>b</span> <span class='hs-varid'>e</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>powModSecInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span>
<a name="line-91"></a>
<a name="line-92"></a><span class='hs-cpp'>#if HAVE_SECURE_POWM == 0</span>
<a name="line-93"></a><span class='hs-comment'>{-# WARNING powModSecInteger "The underlying GMP library does not support a secure version of powModInteger which is side-channel resistant - you need at least GMP version 5 to support this" #-}</span>
<a name="line-94"></a><span class='hs-cpp'>#endif</span>
<a name="line-95"></a>
<a name="line-96"></a><a name="recipModInteger"></a><span class='hs-comment'>-- | \"@'recipModInteger' /x/ /m/@\" computes the inverse of @/x/@ modulo @/m/@. If</span>
<a name="line-97"></a><span class='hs-comment'>-- the inverse exists, the return value @/y/@ will satisfy @0 &lt; /y/ &lt;</span>
<a name="line-98"></a><span class='hs-comment'>-- abs(/m/)@, otherwise the result is @0@.</span>
<a name="line-99"></a><span class='hs-comment'>--</span>
<a name="line-100"></a><span class='hs-comment'>-- Note: The implementation exploits the undocumented property of</span>
<a name="line-101"></a><span class='hs-comment'>-- @mpz_invert()@ to not mangle the result operand (which is initialized</span>
<a name="line-102"></a><span class='hs-comment'>-- to 0) in case of non-existence of the inverse.</span>
<a name="line-103"></a><span class='hs-comment'>--</span>
<a name="line-104"></a><span class='hs-comment'>-- /Since: 0.5.1.0/</span>
<a name="line-105"></a><span class='hs-comment'>{-# NOINLINE recipModInteger #-}</span>
<a name="line-106"></a><span class='hs-definition'>recipModInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-107"></a><span class='hs-definition'>recipModInteger</span> <span class='hs-varid'>j</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recipModInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span>
<a name="line-108"></a><span class='hs-definition'>recipModInteger</span> <span class='hs-varid'>j</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recipModInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span>
<a name="line-109"></a><span class='hs-definition'>recipModInteger</span> <span class='hs-varid'>j</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recipModInteger</span> <span class='hs-varid'>j</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span>
<a name="line-110"></a><span class='hs-definition'>recipModInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>ms</span> <span class='hs-varid'>md</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>recipModInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>ms</span> <span class='hs-varid'>md</span><span class='hs-layout'>)</span>
<a name="line-111"></a>
<a name="line-112"></a><a name="testPrimeInteger"></a><span class='hs-comment'>-- | Probalistic Miller-Rabin primality test.</span>
<a name="line-113"></a><span class='hs-comment'>--</span>
<a name="line-114"></a><span class='hs-comment'>-- \"@'testPrimeInteger' /n/ /k/@\" determines whether @/n/@ is prime</span>
<a name="line-115"></a><span class='hs-comment'>-- and returns one of the following results:</span>
<a name="line-116"></a><span class='hs-comment'>--</span>
<a name="line-117"></a><span class='hs-comment'>-- * @2#@ is returned if @/n/@ is definitely prime,</span>
<a name="line-118"></a><span class='hs-comment'>--</span>
<a name="line-119"></a><span class='hs-comment'>-- * @1#@ if @/n/@ is a /probable prime/, or</span>
<a name="line-120"></a><span class='hs-comment'>--</span>
<a name="line-121"></a><span class='hs-comment'>-- * @0#@ if @/n/@ is definitely not a prime.</span>
<a name="line-122"></a><span class='hs-comment'>--</span>
<a name="line-123"></a><span class='hs-comment'>-- The @/k/@ argument controls how many test rounds are performed for</span>
<a name="line-124"></a><span class='hs-comment'>-- determining a /probable prime/. For more details, see</span>
<a name="line-125"></a><span class='hs-comment'>-- &lt;<a href="http://gmplib.org/manual/Number-Theoretic-Functions.html#index-mpz_005fprobab_005fprime_005fp-360">http://gmplib.org/manual/Number-Theoretic-Functions.html#index-mpz_005fprobab_005fprime_005fp-360</a> GMP documentation for `mpz_probab_prime_p()`&gt;.</span>
<a name="line-126"></a><span class='hs-comment'>--</span>
<a name="line-127"></a><span class='hs-comment'>-- /Since: 0.5.1.0/</span>
<a name="line-128"></a><span class='hs-comment'>{-# NOINLINE testPrimeInteger #-}</span>
<a name="line-129"></a><span class='hs-definition'>testPrimeInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-130"></a><span class='hs-definition'>testPrimeInteger</span> <span class='hs-varid'>j</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>reps</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>testPrimeInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>reps</span>
<a name="line-131"></a><span class='hs-definition'>testPrimeInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>reps</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>testPrimeInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>reps</span>
<a name="line-132"></a>
<a name="line-133"></a><a name="nextPrimeInteger"></a><span class='hs-comment'>-- | Compute next prime greater than @/n/@ probalistically.</span>
<a name="line-134"></a><span class='hs-comment'>--</span>
<a name="line-135"></a><span class='hs-comment'>-- According to the GMP documentation, the underlying function</span>
<a name="line-136"></a><span class='hs-comment'>-- @mpz_nextprime()@ \"uses a probabilistic algorithm to identify</span>
<a name="line-137"></a><span class='hs-comment'>-- primes. For practical purposes it's adequate, the chance of a</span>
<a name="line-138"></a><span class='hs-comment'>-- composite passing will be extremely small.\"</span>
<a name="line-139"></a><span class='hs-comment'>--</span>
<a name="line-140"></a><span class='hs-comment'>-- /Since: 0.5.1.0/</span>
<a name="line-141"></a><span class='hs-comment'>{-# NOINLINE nextPrimeInteger #-}</span>
<a name="line-142"></a><span class='hs-definition'>nextPrimeInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-143"></a><span class='hs-definition'>nextPrimeInteger</span> <span class='hs-varid'>j</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>nextPrimeInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span>
<a name="line-144"></a><span class='hs-definition'>nextPrimeInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>nextPrimeInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span>
<a name="line-145"></a>
<a name="line-146"></a><a name="sizeInBaseInteger"></a><span class='hs-comment'>-- | Compute number of digits (without sign) in given @/base/@.</span>
<a name="line-147"></a><span class='hs-comment'>--</span>
<a name="line-148"></a><span class='hs-comment'>-- It's recommended to avoid calling 'sizeInBaseInteger' for small</span>
<a name="line-149"></a><span class='hs-comment'>-- integers as this function would currently convert those to big</span>
<a name="line-150"></a><span class='hs-comment'>-- integers in order to call @mpz_sizeinbase()@.</span>
<a name="line-151"></a><span class='hs-comment'>--</span>
<a name="line-152"></a><span class='hs-comment'>-- This function wraps @mpz_sizeinbase()@ which has some</span>
<a name="line-153"></a><span class='hs-comment'>-- implementation pecularities to take into account:</span>
<a name="line-154"></a><span class='hs-comment'>--</span>
<a name="line-155"></a><span class='hs-comment'>-- * \"@'sizeInBaseInteger' 0 /base/ = 1@\" (see also comment in 'exportIntegerToMutableByteArray').</span>
<a name="line-156"></a><span class='hs-comment'>--</span>
<a name="line-157"></a><span class='hs-comment'>-- * This function is only defined if @/base/ &gt;= 2#@ and @/base/ &lt;= 256#@</span>
<a name="line-158"></a><span class='hs-comment'>--   (Note: the documentation claims that only @/base/ &lt;= 62#@ is</span>
<a name="line-159"></a><span class='hs-comment'>--   supported, however the actual implementation supports up to base 256).</span>
<a name="line-160"></a><span class='hs-comment'>--</span>
<a name="line-161"></a><span class='hs-comment'>-- * If @/base/@ is a power of 2, the result will be exact. In other</span>
<a name="line-162"></a><span class='hs-comment'>--   cases (e.g. for @/base/ = 10#@), the result /may/ be 1 digit too large</span>
<a name="line-163"></a><span class='hs-comment'>--   sometimes.</span>
<a name="line-164"></a><span class='hs-comment'>--</span>
<a name="line-165"></a><span class='hs-comment'>-- * \"@'sizeInBaseInteger' /i/ 2#@\" can be used to determine the most</span>
<a name="line-166"></a><span class='hs-comment'>--   significant bit of @/i/@.</span>
<a name="line-167"></a><span class='hs-comment'>--</span>
<a name="line-168"></a><span class='hs-comment'>-- /Since: 0.5.1.0/</span>
<a name="line-169"></a><span class='hs-comment'>{-# NOINLINE sizeInBaseInteger #-}</span>
<a name="line-170"></a><span class='hs-definition'>sizeInBaseInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span>
<a name="line-171"></a><span class='hs-definition'>sizeInBaseInteger</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sizeInBaseInteger</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>b</span>
<a name="line-172"></a><span class='hs-definition'>sizeInBaseInteger</span> <span class='hs-varid'>j</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sizeInBaseInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span> <span class='hs-comment'>-- TODO</span>
<a name="line-173"></a>
<a name="line-174"></a><a name="exportIntegerToMutableByteArray"></a><span class='hs-comment'>-- | Dump 'Integer' (without sign) to mutable byte-array in base-256 representation.</span>
<a name="line-175"></a><span class='hs-comment'>--</span>
<a name="line-176"></a><span class='hs-comment'>-- The call</span>
<a name="line-177"></a><span class='hs-comment'>--</span>
<a name="line-178"></a><span class='hs-comment'>-- @'exportIntegerToMutableByteArray' /i/ /mba/ /offset/ /order/@</span>
<a name="line-179"></a><span class='hs-comment'>--</span>
<a name="line-180"></a><span class='hs-comment'>-- writes</span>
<a name="line-181"></a><span class='hs-comment'>--</span>
<a name="line-182"></a><span class='hs-comment'>-- * the 'Integer' @/i/@</span>
<a name="line-183"></a><span class='hs-comment'>--</span>
<a name="line-184"></a><span class='hs-comment'>-- * into the 'MutableByteArray#' @/mba/@ starting at @/offset/@</span>
<a name="line-185"></a><span class='hs-comment'>--</span>
<a name="line-186"></a><span class='hs-comment'>-- * with most significant byte first if @order@ is @1#@ or least</span>
<a name="line-187"></a><span class='hs-comment'>--   significant byte first if @order@ is @-1#@, and</span>
<a name="line-188"></a><span class='hs-comment'>--</span>
<a name="line-189"></a><span class='hs-comment'>-- * returns number of bytes written.</span>
<a name="line-190"></a><span class='hs-comment'>--</span>
<a name="line-191"></a><span class='hs-comment'>-- Use \"@'sizeInBaseInteger' /i/ 256#@\" to compute the exact number of</span>
<a name="line-192"></a><span class='hs-comment'>-- bytes written in advance for @/i/ /= 0@. In case of @/i/ == 0@,</span>
<a name="line-193"></a><span class='hs-comment'>-- 'exportIntegerToMutableByteArray' will write and report zero bytes</span>
<a name="line-194"></a><span class='hs-comment'>-- written, whereas 'sizeInBaseInteger' report one byte.</span>
<a name="line-195"></a><span class='hs-comment'>--</span>
<a name="line-196"></a><span class='hs-comment'>-- It's recommended to avoid calling 'exportIntegerToMutableByteArray' for small</span>
<a name="line-197"></a><span class='hs-comment'>-- integers as this function would currently convert those to big</span>
<a name="line-198"></a><span class='hs-comment'>-- integers in order to call @mpz_export()@.</span>
<a name="line-199"></a><span class='hs-comment'>--</span>
<a name="line-200"></a><span class='hs-comment'>-- /Since: 0.5.1.0/</span>
<a name="line-201"></a><span class='hs-comment'>{-# NOINLINE exportIntegerToMutableByteArray #-}</span>
<a name="line-202"></a><span class='hs-definition'>exportIntegerToMutableByteArray</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>MutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-203"></a><span class='hs-definition'>exportIntegerToMutableByteArray</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>mba</span> <span class='hs-varid'>o</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>exportIntegerToMutableByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>mba</span> <span class='hs-varid'>o</span> <span class='hs-varid'>e</span>
<a name="line-204"></a><span class='hs-definition'>exportIntegerToMutableByteArray</span> <span class='hs-varid'>j</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>mba</span> <span class='hs-varid'>o</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>exportIntegerToMutableByteArray</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>mba</span> <span class='hs-varid'>o</span> <span class='hs-varid'>e</span> <span class='hs-comment'>-- TODO</span>
<a name="line-205"></a>
<a name="line-206"></a><a name="exportIntegerToAddr"></a><span class='hs-comment'>-- | Dump 'Integer' (without sign) to @/addr/@ in base-256 representation.</span>
<a name="line-207"></a><span class='hs-comment'>--</span>
<a name="line-208"></a><span class='hs-comment'>-- @'exportIntegerToAddr' /addr/ /o/ /e/@</span>
<a name="line-209"></a><span class='hs-comment'>--</span>
<a name="line-210"></a><span class='hs-comment'>-- See description of 'exportIntegerToMutableByteArray' for more details.</span>
<a name="line-211"></a><span class='hs-comment'>--</span>
<a name="line-212"></a><span class='hs-comment'>-- /Since: 0.5.1.0/</span>
<a name="line-213"></a><span class='hs-comment'>{-# NOINLINE exportIntegerToAddr #-}</span>
<a name="line-214"></a><span class='hs-definition'>exportIntegerToAddr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Addr</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-215"></a><span class='hs-definition'>exportIntegerToAddr</span> <span class='hs-layout'>(</span><span class='hs-conid'>J</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varid'>addr</span> <span class='hs-varid'>o</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>exportIntegerToAddr</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-varid'>d</span> <span class='hs-varid'>addr</span> <span class='hs-varid'>o</span> <span class='hs-varid'>e</span>
<a name="line-216"></a><span class='hs-definition'>exportIntegerToAddr</span> <span class='hs-varid'>j</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>S</span><span class='hs-cpp'>#</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-varid'>addr</span> <span class='hs-varid'>o</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>exportIntegerToAddr</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBig</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varid'>addr</span> <span class='hs-varid'>o</span> <span class='hs-varid'>e</span> <span class='hs-comment'>-- TODO</span>
<a name="line-217"></a>
<a name="line-218"></a><a name="importIntegerFromByteArray"></a><span class='hs-comment'>-- | Read 'Integer' (without sign) from byte-array in base-256 representation.</span>
<a name="line-219"></a><span class='hs-comment'>--</span>
<a name="line-220"></a><span class='hs-comment'>-- The call</span>
<a name="line-221"></a><span class='hs-comment'>--</span>
<a name="line-222"></a><span class='hs-comment'>-- @'importIntegerFromByteArray' /ba/ /offset/ /size/ /order/@</span>
<a name="line-223"></a><span class='hs-comment'>--</span>
<a name="line-224"></a><span class='hs-comment'>-- reads</span>
<a name="line-225"></a><span class='hs-comment'>--</span>
<a name="line-226"></a><span class='hs-comment'>-- * @/size/@ bytes from the 'ByteArray#' @/ba/@ starting at @/offset/@</span>
<a name="line-227"></a><span class='hs-comment'>--</span>
<a name="line-228"></a><span class='hs-comment'>-- * with most significant byte first if @/order/@ is @1#@ or least</span>
<a name="line-229"></a><span class='hs-comment'>--   significant byte first if @/order/@ is @-1#@, and</span>
<a name="line-230"></a><span class='hs-comment'>--</span>
<a name="line-231"></a><span class='hs-comment'>-- * returns a new 'Integer'</span>
<a name="line-232"></a><span class='hs-comment'>--</span>
<a name="line-233"></a><span class='hs-comment'>-- /Since: 0.5.1.0/</span>
<a name="line-234"></a><span class='hs-comment'>{-# NOINLINE importIntegerFromByteArray #-}</span>
<a name="line-235"></a><span class='hs-definition'>importIntegerFromByteArray</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Integer</span>
<a name="line-236"></a><span class='hs-definition'>importIntegerFromByteArray</span> <span class='hs-varid'>ba</span> <span class='hs-varid'>o</span> <span class='hs-varid'>l</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-layout'>(</span><span class='hs-varid'>importIntegerFromByteArray</span><span class='hs-cpp'>#</span> <span class='hs-varid'>ba</span> <span class='hs-varid'>o</span> <span class='hs-varid'>l</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>
<a name="line-237"></a>
<a name="line-238"></a><a name="importIntegerFromAddr"></a><span class='hs-comment'>-- | Read 'Integer' (without sign) from memory location at @/addr/@ in</span>
<a name="line-239"></a><span class='hs-comment'>-- base-256 representation.</span>
<a name="line-240"></a><span class='hs-comment'>--</span>
<a name="line-241"></a><span class='hs-comment'>-- @'importIntegerFromAddr' /addr/ /size/ /order/@</span>
<a name="line-242"></a><span class='hs-comment'>--</span>
<a name="line-243"></a><span class='hs-comment'>-- See description of 'importIntegerFromByteArray' for more details.</span>
<a name="line-244"></a><span class='hs-comment'>--</span>
<a name="line-245"></a><span class='hs-comment'>-- /Since: 0.5.1.0/</span>
<a name="line-246"></a><span class='hs-comment'>{-# NOINLINE importIntegerFromAddr #-}</span>
<a name="line-247"></a><span class='hs-definition'>importIntegerFromAddr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Addr</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-conid'>State</span><span class='hs-cpp'>#</span> <span class='hs-varid'>s</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integer</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-248"></a><span class='hs-definition'>importIntegerFromAddr</span> <span class='hs-varid'>addr</span> <span class='hs-varid'>l</span> <span class='hs-varid'>e</span> <span class='hs-varid'>st</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>importIntegerFromAddr</span><span class='hs-cpp'>#</span> <span class='hs-varid'>addr</span> <span class='hs-varid'>l</span> <span class='hs-varid'>e</span> <span class='hs-varid'>st</span> <span class='hs-keyword'>of</span>
<a name="line-249"></a>                                      <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>st'</span><span class='hs-layout'>,</span> <span class='hs-varid'>mpz</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>let</span> <span class='hs-varop'>!</span><span class='hs-varid'>j</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mpzToInteger</span> <span class='hs-varid'>mpz</span> <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-cpp'>#</span> <span class='hs-varid'>st'</span><span class='hs-layout'>,</span> <span class='hs-varid'>j</span> <span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<a name="line-250"></a>
</pre>\end{code}

%*********************************************************
%*                                                      *
\subsection{The @Integer@ hashing@}
%*                                                      *
%*********************************************************

\begin{code}
<pre><a name="line-1"></a><span class='hs-comment'>-- This is used by hashUnique</span>
<a name="line-2"></a>
<a name="line-3"></a><span class='hs-comment'>-- | 'hashInteger' returns the same value as 'fromIntegral', although in</span>
<a name="line-4"></a><span class='hs-comment'>-- unboxed form.  It might be a reasonable hash function for 'Integer',</span>
<a name="line-5"></a><span class='hs-comment'>-- given a suitable distribution of 'Integer' values.</span>
<a name="line-6"></a><span class='hs-comment'>--</span>
<a name="line-7"></a><span class='hs-comment'>-- Note: 'hashInteger' is currently just an alias for 'integerToInt'.</span>
<a name="line-8"></a>
<a name="line-9"></a><a name="hashInteger"></a><span class='hs-definition'>hashInteger</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Integer</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span>
<a name="line-10"></a><span class='hs-definition'>hashInteger</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>integerToInt</span>
</pre>\end{code}

</body>
</html>
