<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_HADDOCK not-home #-}</span><span>
</span><a name="line-2"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hedgehog</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span><span class="hs-operator">.</span><span class="hs-identifier">Shrink</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-3"></a><span>    </span><a href="Hedgehog.Internal.Shrink.html#towards"><span class="hs-identifier hs-var">towards</span></a><span>
</span><a name="line-4"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Hedgehog.Internal.Shrink.html#towardsFloat"><span class="hs-identifier hs-var">towardsFloat</span></a><span>
</span><a name="line-5"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Hedgehog.Internal.Shrink.html#list"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Hedgehog.Internal.Shrink.html#halves"><span class="hs-identifier hs-var">halves</span></a><span>
</span><a name="line-8"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Hedgehog.Internal.Shrink.html#removes"><span class="hs-identifier hs-var">removes</span></a><span>
</span><a name="line-9"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Hedgehog.Internal.Shrink.html#consNub"><span class="hs-identifier hs-var">consNub</span></a><span>
</span><a name="line-10"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-comment">-- | Shrink an integral number by edging towards a destination.</span><span>
</span><a name="line-14"></a><span class="hs-comment">--</span><span>
</span><a name="line-15"></a><span class="hs-comment">--   &gt;&gt;&gt; towards 0 100</span><span>
</span><a name="line-16"></a><span class="hs-comment">--   [0,50,75,88,94,97,99]</span><span>
</span><a name="line-17"></a><span class="hs-comment">--</span><span>
</span><a name="line-18"></a><span class="hs-comment">--   &gt;&gt;&gt; towards 500 1000</span><span>
</span><a name="line-19"></a><span class="hs-comment">--   [500,750,875,938,969,985,993,997,999]</span><span>
</span><a name="line-20"></a><span class="hs-comment">--</span><span>
</span><a name="line-21"></a><span class="hs-comment">--   &gt;&gt;&gt; towards (-50) (-26)</span><span>
</span><a name="line-22"></a><span class="hs-comment">--   [-50,-38,-32,-29,-27]</span><span>
</span><a name="line-23"></a><span class="hs-comment">--</span><span>
</span><a name="line-24"></a><span class="hs-comment">--   /Note we always try the destination first, as that is the optimal shrink./</span><span>
</span><a name="line-25"></a><span class="hs-comment">--</span><span>
</span><a name="line-26"></a><span class="hs-identifier">towards</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679118419"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679118419"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679118419"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679118419"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-27"></a><a name="towards"><a href="Hedgehog.Internal.Shrink.html#towards"><span class="hs-identifier">towards</span></a></a><span> </span><a name="local-6989586621679118420"><a href="#local-6989586621679118420"><span class="hs-identifier">destination</span></a></a><span> </span><a name="local-6989586621679118421"><a href="#local-6989586621679118421"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-28"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679118420"><span class="hs-identifier hs-var">destination</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679118421"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-29"></a><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-30"></a><span>  </span><span class="hs-keyword">else</span><span>
</span><a name="line-31"></a><span>    </span><span class="hs-keyword">let</span><span>
</span><a name="line-32"></a><span>      </span><span class="hs-comment">-- Halve the operands before subtracting them so they don't overflow.</span><span>
</span><a name="line-33"></a><span>      </span><span class="hs-comment">-- Consider 'minBound' and 'maxBound' for a fixed sized type like 'Int64'.</span><span>
</span><a name="line-34"></a><span>      </span><a name="local-6989586621679118422"><a href="#local-6989586621679118422"><span class="hs-identifier">diff</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-35"></a><span>        </span><span class="hs-special">(</span><a href="#local-6989586621679118421"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">quot</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679118420"><span class="hs-identifier hs-var">destination</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">quot</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span>    </span><span class="hs-keyword">in</span><span>
</span><a name="line-37"></a><span>      </span><a href="#local-6989586621679118420"><span class="hs-identifier hs-var">destination</span></a><span> </span><span class="hs-special">`</span><a href="Hedgehog.Internal.Shrink.html#consNub"><span class="hs-identifier hs-var">consNub</span></a><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679118421"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Hedgehog.Internal.Shrink.html#halves"><span class="hs-identifier hs-var">halves</span></a><span> </span><a href="#local-6989586621679118422"><span class="hs-identifier hs-var">diff</span></a><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-comment">-- | Shrink a floating-point number by edging towards a destination.</span><span>
</span><a name="line-40"></a><span class="hs-comment">--</span><span>
</span><a name="line-41"></a><span class="hs-comment">--   &gt;&gt;&gt; take 7 (towardsFloat 0.0 100)</span><span>
</span><a name="line-42"></a><span class="hs-comment">--   [0.0,50.0,75.0,87.5,93.75,96.875,98.4375]</span><span>
</span><a name="line-43"></a><span class="hs-comment">--</span><span>
</span><a name="line-44"></a><span class="hs-comment">--   &gt;&gt;&gt; take 7 (towardsFloat 1.0 0.5)</span><span>
</span><a name="line-45"></a><span class="hs-comment">--   [1.0,0.75,0.625,0.5625,0.53125,0.515625,0.5078125]</span><span>
</span><a name="line-46"></a><span class="hs-comment">--</span><span>
</span><a name="line-47"></a><span class="hs-comment">--   /Note we always try the destination first, as that is the optimal shrink./</span><span>
</span><a name="line-48"></a><span class="hs-comment">--</span><span>
</span><a name="line-49"></a><span class="hs-identifier">towardsFloat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">RealFloat</span><span> </span><a href="#local-6989586621679118418"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679118418"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679118418"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679118418"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-50"></a><a name="towardsFloat"><a href="Hedgehog.Internal.Shrink.html#towardsFloat"><span class="hs-identifier">towardsFloat</span></a></a><span> </span><a name="local-6989586621679118423"><a href="#local-6989586621679118423"><span class="hs-identifier">destination</span></a></a><span> </span><a name="local-6989586621679118424"><a href="#local-6989586621679118424"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-51"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679118423"><span class="hs-identifier hs-var">destination</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679118424"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-52"></a><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-53"></a><span>  </span><span class="hs-keyword">else</span><span>
</span><a name="line-54"></a><span>    </span><span class="hs-keyword">let</span><span>
</span><a name="line-55"></a><span>      </span><a name="local-6989586621679118425"><a href="#local-6989586621679118425"><span class="hs-identifier">diff</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-56"></a><span>        </span><a href="#local-6989586621679118424"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679118423"><span class="hs-identifier hs-var">destination</span></a><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span>      </span><a name="local-6989586621679118426"><a href="#local-6989586621679118426"><span class="hs-identifier">ok</span></a></a><span> </span><a name="local-6989586621679118427"><a href="#local-6989586621679118427"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-59"></a><span>        </span><a href="#local-6989586621679118427"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679118424"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isNaN</span><span> </span><a href="#local-6989586621679118427"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isInfinite</span><span> </span><a href="#local-6989586621679118427"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span>    </span><span class="hs-keyword">in</span><span>
</span><a name="line-61"></a><span>      </span><span class="hs-identifier hs-var">takeWhile</span><span> </span><a href="#local-6989586621679118426"><span class="hs-identifier hs-var">ok</span></a><span> </span><span class="hs-operator hs-var">.</span><span>
</span><a name="line-62"></a><span>      </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679118424"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-63"></a><span>      </span><span class="hs-identifier hs-var">iterate</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679118425"><span class="hs-identifier hs-var">diff</span></a><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-comment">-- | Shrink a list by edging towards the empty list.</span><span>
</span><a name="line-66"></a><span class="hs-comment">--</span><span>
</span><a name="line-67"></a><span class="hs-comment">--   &gt;&gt;&gt; list [1,2,3]</span><span>
</span><a name="line-68"></a><span class="hs-comment">--   [[],[2,3],[1,3],[1,2]]</span><span>
</span><a name="line-69"></a><span class="hs-comment">--</span><span>
</span><a name="line-70"></a><span class="hs-comment">--   &gt;&gt;&gt; list &quot;abcd&quot;</span><span>
</span><a name="line-71"></a><span class="hs-comment">--   [&quot;&quot;,&quot;cd&quot;,&quot;ab&quot;,&quot;bcd&quot;,&quot;acd&quot;,&quot;abd&quot;,&quot;abc&quot;]</span><span>
</span><a name="line-72"></a><span class="hs-comment">--</span><span>
</span><a name="line-73"></a><span class="hs-comment">--   /Note we always try the empty list first, as that is the optimal shrink./</span><span>
</span><a name="line-74"></a><span class="hs-comment">--</span><span>
</span><a name="line-75"></a><span class="hs-identifier">list</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679118417"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679118417"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-76"></a><a name="list"><a href="Hedgehog.Internal.Shrink.html#list"><span class="hs-identifier">list</span></a></a><span> </span><a name="local-6989586621679118428"><a href="#local-6989586621679118428"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-77"></a><span> </span><span class="hs-identifier hs-var">concatMap</span><span>
</span><a name="line-78"></a><span>   </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679118429"><a href="#local-6989586621679118429"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Hedgehog.Internal.Shrink.html#removes"><span class="hs-identifier hs-var">removes</span></a><span> </span><a href="#local-6989586621679118429"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679118428"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-79"></a><span>   </span><span class="hs-special">(</span><a href="Hedgehog.Internal.Shrink.html#halves"><span class="hs-identifier hs-var">halves</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679118428"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-comment">-- | Produce all permutations of removing 'k' elements from a list.</span><span>
</span><a name="line-82"></a><span class="hs-comment">--</span><span>
</span><a name="line-83"></a><span class="hs-comment">--   &gt;&gt;&gt; removes 2 &quot;abcdef&quot;</span><span>
</span><a name="line-84"></a><span class="hs-comment">--   [&quot;cdef&quot;,&quot;abef&quot;,&quot;abcd&quot;]</span><span>
</span><a name="line-85"></a><span class="hs-comment">--</span><span>
</span><a name="line-86"></a><span class="hs-identifier">removes</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679118416"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679118416"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-87"></a><a name="removes"><a href="Hedgehog.Internal.Shrink.html#removes"><span class="hs-identifier">removes</span></a></a><span> </span><a name="local-6989586621679118430"><a href="#local-6989586621679118430"><span class="hs-identifier">k0</span></a></a><span> </span><a name="local-6989586621679118431"><a href="#local-6989586621679118431"><span class="hs-identifier">xs0</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-88"></a><span>  </span><span class="hs-keyword">let</span><span>
</span><a name="line-89"></a><span>    </span><a name="local-6989586621679118432"><a href="#local-6989586621679118432"><span class="hs-identifier">loop</span></a></a><span> </span><a name="local-6989586621679118433"><a href="#local-6989586621679118433"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679118434"><a href="#local-6989586621679118434"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679118435"><a href="#local-6989586621679118435"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-90"></a><span>      </span><span class="hs-keyword">let</span><span>
</span><a name="line-91"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679118436"><a href="#local-6989586621679118436"><span class="hs-identifier">hd</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679118437"><a href="#local-6989586621679118437"><span class="hs-identifier">tl</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-92"></a><span>          </span><span class="hs-identifier hs-var">splitAt</span><span> </span><a href="#local-6989586621679118433"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679118435"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-93"></a><span>      </span><span class="hs-keyword">in</span><span>
</span><a name="line-94"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679118433"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="#local-6989586621679118434"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-95"></a><span>          </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-96"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679118437"><span class="hs-identifier hs-var">tl</span></a><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-97"></a><span>          </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-98"></a><span>        </span><span class="hs-keyword">else</span><span>
</span><a name="line-99"></a><span>          </span><a href="#local-6989586621679118437"><span class="hs-identifier hs-var">tl</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679118436"><span class="hs-identifier hs-var">hd</span></a><span> </span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679118432"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679118433"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679118434"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679118433"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679118437"><span class="hs-identifier hs-var">tl</span></a><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span>  </span><span class="hs-keyword">in</span><span>
</span><a name="line-101"></a><span>    </span><a href="#local-6989586621679118432"><span class="hs-identifier hs-var">loop</span></a><span> </span><a href="#local-6989586621679118430"><span class="hs-identifier hs-var">k0</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679118431"><span class="hs-identifier hs-var">xs0</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679118431"><span class="hs-identifier hs-var">xs0</span></a><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-comment">-- | Produce a list containing the progressive halving of an integral.</span><span>
</span><a name="line-104"></a><span class="hs-comment">--</span><span>
</span><a name="line-105"></a><span class="hs-comment">--   &gt;&gt;&gt; halves 15</span><span>
</span><a name="line-106"></a><span class="hs-comment">--   [15,7,3,1]</span><span>
</span><a name="line-107"></a><span class="hs-comment">--</span><span>
</span><a name="line-108"></a><span class="hs-comment">--   &gt;&gt;&gt; halves 100</span><span>
</span><a name="line-109"></a><span class="hs-comment">--   [100,50,25,12,6,3,1]</span><span>
</span><a name="line-110"></a><span class="hs-comment">--</span><span>
</span><a name="line-111"></a><span class="hs-comment">--   &gt;&gt;&gt; halves (-26)</span><span>
</span><a name="line-112"></a><span class="hs-comment">--   [-26,-13,-6,-3,-1]</span><span>
</span><a name="line-113"></a><span class="hs-comment">--</span><span>
</span><a name="line-114"></a><span class="hs-identifier">halves</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679118415"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679118415"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679118415"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-115"></a><a name="halves"><a href="Hedgehog.Internal.Shrink.html#halves"><span class="hs-identifier">halves</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-116"></a><span>  </span><span class="hs-identifier hs-var">takeWhile</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">iterate</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">quot</span><span class="hs-special">`</span><span> </span><span class="hs-number">2</span><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">-- | Cons an element on to the front of a list unless it is already there.</span><span>
</span><a name="line-119"></a><span class="hs-comment">--</span><span>
</span><a name="line-120"></a><span class="hs-identifier">consNub</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679118414"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679118414"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679118414"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679118414"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-121"></a><a name="consNub"><a href="Hedgehog.Internal.Shrink.html#consNub"><span class="hs-identifier">consNub</span></a></a><span> </span><a name="local-6989586621679118438"><a href="#local-6989586621679118438"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679118439"><a href="#local-6989586621679118439"><span class="hs-identifier">ys0</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-122"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679118439"><span class="hs-identifier hs-var">ys0</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-123"></a><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-124"></a><span>      </span><a href="#local-6989586621679118438"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-125"></a><span>    </span><a name="local-6989586621679118440"><a href="#local-6989586621679118440"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679118441"><a href="#local-6989586621679118441"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-126"></a><span>      </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679118438"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679118440"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">then</span><span>
</span><a name="line-127"></a><span>        </span><a href="#local-6989586621679118440"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679118441"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-128"></a><span>      </span><span class="hs-keyword">else</span><span>
</span><a name="line-129"></a><span>        </span><a href="#local-6989586621679118438"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679118440"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679118441"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-130"></a></pre></body></html>