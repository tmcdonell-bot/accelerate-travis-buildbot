<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- | 
This modules provides 'RegexMaker' and 'RegexLike' instances for using
'String' with the TDFA backend.

This exports instances of the high level API and the medium level
API of 'compile','execute', and 'regexec'.
-}</span><span>
</span><a name="line-8"></a><span class="hs-comment">{- By Chris Kuklewicz, 2009. BSD License, see the LICENSE file. -}</span><span>
</span><a name="line-9"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Regex</span><span class="hs-operator">.</span><span class="hs-identifier">TDFA</span><span class="hs-operator">.</span><span class="hs-identifier">String</span><span class="hs-special">(</span><span>
</span><a name="line-10"></a><span>  </span><span class="hs-comment">-- ** Types</span><span>
</span><a name="line-11"></a><span>  </span><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier hs-type">Regex</span></a><span>
</span><a name="line-12"></a><span> </span><span class="hs-special">,</span><span class="hs-identifier hs-type">MatchOffset</span><span>
</span><a name="line-13"></a><span> </span><span class="hs-special">,</span><span class="hs-identifier hs-type">MatchLength</span><span>
</span><a name="line-14"></a><span> </span><span class="hs-special">,</span><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a><span>
</span><a name="line-15"></a><span> </span><span class="hs-special">,</span><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a><span>
</span><a name="line-16"></a><span>  </span><span class="hs-comment">-- ** Medium level API functions</span><span>
</span><a name="line-17"></a><span> </span><span class="hs-special">,</span><a href="Text.Regex.TDFA.String.html#compile"><span class="hs-identifier hs-var">compile</span></a><span>
</span><a name="line-18"></a><span> </span><span class="hs-special">,</span><a href="Text.Regex.TDFA.String.html#execute"><span class="hs-identifier hs-var">execute</span></a><span>
</span><a name="line-19"></a><span> </span><span class="hs-special">,</span><a href="Text.Regex.TDFA.String.html#regexec"><span class="hs-identifier hs-var">regexec</span></a><span>
</span><a name="line-20"></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Regex</span><span class="hs-operator">.</span><span class="hs-identifier">Base</span><span class="hs-operator">.</span><span class="hs-identifier">Impl</span><span class="hs-special">(</span><span class="hs-identifier hs-var">polymatch</span><span class="hs-special">,</span><span class="hs-identifier hs-var">polymatchM</span><span class="hs-special">)</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Regex</span><span class="hs-operator">.</span><span class="hs-identifier">Base</span><span class="hs-operator">.</span><span class="hs-identifier">RegexLike</span><span class="hs-special">(</span><span class="hs-identifier hs-type">RegexMaker</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier hs-type">RegexLike</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier hs-type">RegexContext</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier hs-type">MatchOffset</span><span class="hs-special">,</span><span class="hs-identifier hs-type">MatchLength</span><span class="hs-special">,</span><span class="hs-identifier hs-type">MatchArray</span><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><a href="Text.Regex.TDFA.Common.html"><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Regex</span><span class="hs-operator">.</span><span class="hs-identifier">TDFA</span><span class="hs-operator">.</span><span class="hs-identifier">Common</span></a><span class="hs-special">(</span><a href="Text.Regex.TDFA.Common.html#common_error"><span class="hs-identifier hs-var">common_error</span></a><span class="hs-special">,</span><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier hs-type">Regex</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a><span class="hs-special">,</span><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a><span class="hs-special">(</span><span class="hs-identifier">captureGroups</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><a href="Text.Regex.TDFA.ReadRegex.html"><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Regex</span><span class="hs-operator">.</span><span class="hs-identifier">TDFA</span><span class="hs-operator">.</span><span class="hs-identifier">ReadRegex</span></a><span class="hs-special">(</span><a href="Text.Regex.TDFA.ReadRegex.html#parseRegex"><span class="hs-identifier hs-var">parseRegex</span></a><span class="hs-special">)</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><a href="Text.Regex.TDFA.TDFA.html"><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Regex</span><span class="hs-operator">.</span><span class="hs-identifier">TDFA</span><span class="hs-operator">.</span><span class="hs-identifier">TDFA</span></a><span class="hs-special">(</span><a href="Text.Regex.TDFA.TDFA.html#patternToRegex"><span class="hs-identifier hs-var">patternToRegex</span></a><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Array</span><span class="hs-operator">.</span><span class="hs-identifier">IArray</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier hs-var">elems</span><span class="hs-special">,</span><span class="hs-identifier hs-var">amap</span><span class="hs-special">)</span><span>
</span><a name="line-29"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span class="hs-special">(</span><span class="hs-identifier hs-var">listToMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><a href="Text.Regex.TDFA.NewDFA.Engine.html"><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Regex</span><span class="hs-operator">.</span><span class="hs-identifier">TDFA</span><span class="hs-operator">.</span><span class="hs-identifier">NewDFA</span><span class="hs-operator">.</span><span class="hs-identifier">Engine</span></a><span class="hs-special">(</span><a href="Text.Regex.TDFA.NewDFA.Engine.html#execMatch"><span class="hs-identifier hs-var">execMatch</span></a><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="Text.Regex.TDFA.NewDFA.Tester.html"><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Regex</span><span class="hs-operator">.</span><span class="hs-identifier">TDFA</span><span class="hs-operator">.</span><span class="hs-identifier">NewDFA</span><span class="hs-operator">.</span><span class="hs-identifier">Tester</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Tester</span><span class="hs-special">(</span><a href="Text.Regex.TDFA.NewDFA.Tester.html#matchTest"><span class="hs-identifier hs-var">matchTest</span></a><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-identifier">err</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679089069"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-34"></a><a name="err"><a href="Text.Regex.TDFA.String.html#err"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.Regex.TDFA.Common.html#common_error"><span class="hs-identifier hs-var">common_error</span></a><span> </span><span class="hs-string">&quot;Text.Regex.TDFA.String&quot;</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-identifier">unwrap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="#local-6989586621679089068"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679089068"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-37"></a><a name="unwrap"><a href="Text.Regex.TDFA.String.html#unwrap"><span class="hs-identifier">unwrap</span></a></a><span> </span><a name="local-6989586621679089070"><a href="#local-6989586621679089070"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679089070"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679089071"><a href="#local-6989586621679089071"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.Regex.TDFA.String.html#err"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Text.Regex.TDFA.String died: &quot;</span><span class="hs-operator hs-var">++</span><a href="#local-6989586621679089071"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>                     </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679089072"><a href="#local-6989586621679089072"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679089072"><span class="hs-identifier hs-var">v</span></a><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-identifier">compile</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a><span> </span><span class="hs-comment">-- ^ Flags (summed together)</span><span>
</span><a name="line-41"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a><span> </span><span class="hs-comment">-- ^ Flags (summed together)</span><span>
</span><a name="line-42"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>     </span><span class="hs-comment">-- ^ The regular expression to compile (ASCII only, no null bytes)</span><span>
</span><a name="line-43"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier hs-type">Regex</span></a><span> </span><span class="hs-comment">-- ^ Returns: the compiled regular expression</span><span>
</span><a name="line-44"></a><a name="compile"><a href="Text.Regex.TDFA.String.html#compile"><span class="hs-identifier">compile</span></a></a><span> </span><a name="local-6989586621679089073"><a href="#local-6989586621679089073"><span class="hs-identifier">compOpt</span></a></a><span> </span><a name="local-6989586621679089074"><a href="#local-6989586621679089074"><span class="hs-identifier">execOpt</span></a></a><span> </span><a name="local-6989586621679089075"><a href="#local-6989586621679089075"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-45"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="Text.Regex.TDFA.ReadRegex.html#parseRegex"><span class="hs-identifier hs-var">parseRegex</span></a><span> </span><a href="#local-6989586621679089075"><span class="hs-identifier hs-var">source</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-46"></a><span>    </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679089076"><a href="#local-6989586621679089076"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;parseRegex for Text.Regex.TDFA.String failed:&quot;</span><span class="hs-operator hs-var">++</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679089076"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span>    </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679089077"><a href="#local-6989586621679089077"><span class="hs-identifier">pattern</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.TDFA.html#patternToRegex"><span class="hs-identifier hs-var">patternToRegex</span></a><span> </span><a href="#local-6989586621679089077"><span class="hs-identifier hs-var">pattern</span></a><span> </span><a href="#local-6989586621679089073"><span class="hs-identifier hs-var">compOpt</span></a><span> </span><a href="#local-6989586621679089074"><span class="hs-identifier hs-var">execOpt</span></a><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">RegexMaker</span><span> </span><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier hs-type">Regex</span></a><span> </span><a href="Text.Regex.TDFA.Common.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a><span> </span><a href="Text.Regex.TDFA.Common.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-50"></a><span>  </span><a name="local-8214565720323793655"><span class="hs-identifier">makeRegexOpts</span></a><span> </span><a name="local-6989586621679089062"><a href="#local-6989586621679089062"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679089063"><a href="#local-6989586621679089063"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679089064"><a href="#local-6989586621679089064"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.Regex.TDFA.String.html#unwrap"><span class="hs-identifier hs-var">unwrap</span></a><span> </span><span class="hs-special">(</span><a href="Text.Regex.TDFA.String.html#compile"><span class="hs-identifier hs-var">compile</span></a><span> </span><a href="#local-6989586621679089062"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679089063"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679089064"><span class="hs-identifier hs-var">source</span></a><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span>  </span><a name="local-8214565720323793653"><span class="hs-identifier">makeRegexOptsM</span></a><span> </span><a name="local-6989586621679089065"><a href="#local-6989586621679089065"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679089066"><a href="#local-6989586621679089066"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679089067"><a href="#local-6989586621679089067"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-identifier hs-var">fail</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Text.Regex.TDFA.String.html#compile"><span class="hs-identifier hs-var">compile</span></a><span> </span><a href="#local-6989586621679089065"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679089066"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679089067"><span class="hs-identifier hs-var">source</span></a><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-identifier">execute</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier hs-type">Regex</span></a><span>      </span><span class="hs-comment">-- ^ Compiled regular expression</span><span>
</span><a name="line-54"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>     </span><span class="hs-comment">-- ^ String to match against</span><span>
</span><a name="line-55"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">MatchArray</span><span class="hs-special">)</span><span>
</span><a name="line-56"></a><a name="execute"><a href="Text.Regex.TDFA.String.html#execute"><span class="hs-identifier">execute</span></a></a><span> </span><a name="local-6989586621679089078"><a href="#local-6989586621679089078"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679089079"><a href="#local-6989586621679089079"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">matchOnce</span><span> </span><a href="#local-6989586621679089078"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679089079"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-identifier">regexec</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier hs-type">Regex</span></a><span>      </span><span class="hs-comment">-- ^ Compiled regular expression</span><span>
</span><a name="line-59"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>     </span><span class="hs-comment">-- ^ String to match against</span><span>
</span><a name="line-60"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><a name="regexec"><a href="Text.Regex.TDFA.String.html#regexec"><span class="hs-identifier">regexec</span></a></a><span> </span><a name="local-6989586621679089080"><a href="#local-6989586621679089080"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679089081"><a href="#local-6989586621679089081"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-62"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">matchOnceText</span><span> </span><a href="#local-6989586621679089080"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679089081"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-63"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-64"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679089082"><a href="#local-6989586621679089082"><span class="hs-identifier">pre</span></a></a><span class="hs-special">,</span><a name="local-6989586621679089083"><a href="#local-6989586621679089083"><span class="hs-identifier">mt</span></a></a><span class="hs-special">,</span><a name="local-6989586621679089084"><a href="#local-6989586621679089084"><span class="hs-identifier">post</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-65"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679089085"><a href="#local-6989586621679089085"><span class="hs-identifier">main</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679089083"><span class="hs-identifier hs-var">mt</span></a><span class="hs-glyph">!</span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span>          </span><a name="local-6989586621679089086"><a href="#local-6989586621679089086"><span class="hs-identifier">rest</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tail</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">elems</span><span> </span><a href="#local-6989586621679089083"><span class="hs-identifier hs-var">mt</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- will be []</span><span>
</span><a name="line-67"></a><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679089082"><span class="hs-identifier hs-var">pre</span></a><span class="hs-special">,</span><a href="#local-6989586621679089085"><span class="hs-identifier hs-var">main</span></a><span class="hs-special">,</span><a href="#local-6989586621679089084"><span class="hs-identifier hs-var">post</span></a><span class="hs-special">,</span><a href="#local-6989586621679089086"><span class="hs-identifier hs-var">rest</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-comment">-- Minimal defintion for now</span><span>
</span><a name="line-70"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">RegexLike</span><span> </span><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier hs-type">Regex</span></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-71"></a><span>  </span><a name="local-8214565720323793663"><span class="hs-identifier">matchOnce</span></a><span> </span><a name="local-6989586621679089038"><a href="#local-6989586621679089038"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679089039"><a href="#local-6989586621679089039"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">listToMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">matchAll</span><span> </span><a href="#local-6989586621679089038"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679089039"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span>  </span><a name="local-8214565720323793662"><span class="hs-identifier">matchAll</span></a><span> </span><a name="local-6989586621679089040"><a href="#local-6989586621679089040"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679089041"><a href="#local-6989586621679089041"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.Regex.TDFA.NewDFA.Engine.html#execMatch"><span class="hs-identifier hs-var">execMatch</span></a><span> </span><a href="#local-6989586621679089040"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-char">'\n'</span><span> </span><a href="#local-6989586621679089041"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-73"></a><span>  </span><a name="local-8214565720323793661"><span class="hs-identifier">matchCount</span></a><span> </span><a name="local-6989586621679089042"><a href="#local-6989586621679089042"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679089043"><a href="#local-6989586621679089043"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">matchAll</span><span> </span><a href="#local-6989586621679089044"><span class="hs-identifier hs-var">r'</span></a><span> </span><a href="#local-6989586621679089043"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679089044"><a href="#local-6989586621679089044"><span class="hs-identifier">r'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679089042"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">regex_execOptions</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">regex_execOptions</span><span> </span><a href="#local-6989586621679089042"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span class="hs-identifier">captureGroups</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-75"></a><span>  </span><a name="local-8214565720323793660"><span class="hs-identifier">matchTest</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.Regex.TDFA.NewDFA.Tester.html#matchTest"><span class="hs-identifier hs-var">Tester</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">matchTest</span></a><span>
</span><a name="line-76"></a><span>  </span><span class="hs-comment">-- matchOnceText</span><span>
</span><a name="line-77"></a><span>  </span><a name="local-8214565720323793659"><span class="hs-identifier">matchAllText</span></a><span> </span><a name="local-6989586621679089045"><a href="#local-6989586621679089045"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679089046"><a href="#local-6989586621679089046"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-78"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679089047"><a href="#local-6989586621679089047"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679089048"><a href="#local-6989586621679089048"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679089048"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-79"></a><span>        </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679089049"><a href="#local-6989586621679089049"><span class="hs-identifier">_i</span></a></a><span> </span><a name="local-6989586621679089050"><a href="#local-6989586621679089050"><span class="hs-identifier">_t</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-80"></a><span>        </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679089051"><a href="#local-6989586621679089051"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679089052"><a href="#local-6989586621679089052"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679089053"><a href="#local-6989586621679089053"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679089054"><a href="#local-6989586621679089054"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679089055"><a href="#local-6989586621679089055"><span class="hs-identifier">off0</span></a></a><span class="hs-special">,</span><a name="local-6989586621679089056"><a href="#local-6989586621679089056"><span class="hs-identifier">len0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679089053"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">!</span><span class="hs-number">0</span><span>
</span><a name="line-81"></a><span>                            </span><a name="local-6989586621679089057"><a href="#local-6989586621679089057"><span class="hs-identifier">trans</span></a></a><span> </span><a name="local-6989586621679089059"><a href="#local-6989586621679089059"><span class="hs-identifier">pair</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679089060"><a href="#local-6989586621679089060"><span class="hs-identifier">off</span></a></a><span class="hs-special">,</span><a name="local-6989586621679089061"><a href="#local-6989586621679089061"><span class="hs-identifier">len</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">take</span><span> </span><a href="#local-6989586621679089061"><span class="hs-identifier hs-var">len</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679089060"><span class="hs-identifier hs-var">off</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679089051"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679089052"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679089059"><span class="hs-identifier hs-var">pair</span></a><span class="hs-special">)</span><span>
</span><a name="line-82"></a><span>                            </span><a name="local-6989586621679089058"><a href="#local-6989586621679089058"><span class="hs-identifier">t'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679089055"><span class="hs-identifier hs-var">off0</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679089056"><span class="hs-identifier hs-var">len0</span></a><span class="hs-glyph">-</span><a href="#local-6989586621679089051"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679089052"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-83"></a><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">amap</span><span> </span><a href="#local-6989586621679089057"><span class="hs-identifier hs-var">trans</span></a><span> </span><a href="#local-6989586621679089053"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier hs-var">seq</span><span> </span><a href="#local-6989586621679089058"><span class="hs-identifier hs-var">t'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679089047"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679089055"><span class="hs-identifier hs-var">off0</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679089056"><span class="hs-identifier hs-var">len0</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679089058"><span class="hs-identifier hs-var">t'</span></a><span> </span><a href="#local-6989586621679089054"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>    </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679089047"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span> </span><a href="#local-6989586621679089046"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">matchAll</span><span> </span><a href="#local-6989586621679089045"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679089046"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">RegexContext</span><span> </span><a href="Text.Regex.TDFA.Common.html#Regex"><span class="hs-identifier hs-type">Regex</span></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-87"></a><span>  </span><a name="local-8214565720323793666"><span class="hs-identifier">match</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">polymatch</span><span>
</span><a name="line-88"></a><span>  </span><a name="local-8214565720323793665"><span class="hs-identifier">matchM</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">polymatchM</span><span>
</span><a name="line-89"></a></pre></body></html>