<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 701
</span><span class="hs-pragma">{-# LANGUAGE Trustworthy #-}</span><span>
</span><a name="line-3"></a><span class="hs-cpp">#endif
</span><span class="hs-comment">-------------------------</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- | </span><span>
</span><a name="line-6"></a><span class="hs-comment">-- Module      :  Control.Exception</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- Copyright   :  (c) The University of Glasgow 2001</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- License     :  BSD-style (see the file LICENSE)</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- </span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Maintainer  :  libraries@haskell.org</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- Portability :  non-portable (uses ExistentialQuantification and DeriveDataTypeable)</span><span>
</span><a name="line-13"></a><span class="hs-comment">--</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- This module provides the extensible exceptions API for raising and catching both</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- built-in and user-defined exceptions.</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- </span><span>
</span><a name="line-17"></a><span class="hs-comment">-- For newer versions of GHC (&gt;=6.9), this package re-exports 'Control.Exception'.  </span><span>
</span><a name="line-18"></a><span class="hs-comment">-- Otherwise, it provides a compatibility layer around the previous version of the </span><span>
</span><a name="line-19"></a><span class="hs-comment">-- extensions API.</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-cpp">#ifdef USE_NEW_EXCEPTIONS
</span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Exception.Extensible</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Exception</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Exception</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">blocked</span><span class="hs-special">)</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-cpp">#else
</span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Exception.Extensible</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-28"></a><span>    </span><span class="hs-comment">-- * The Exception type</span><span>
</span><a name="line-29"></a><span>    </span><span class="hs-identifier">SomeException</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>    </span><span class="hs-identifier">Exception</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>    </span><span class="hs-identifier">E.IOException</span><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>    </span><span class="hs-identifier">E.ArithException</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>    </span><span class="hs-identifier">E.ArrayException</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>    </span><span class="hs-identifier">AssertionFailed</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>    </span><span class="hs-identifier">E.AsyncException</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>    </span><span class="hs-identifier">NonTermination</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>    </span><span class="hs-identifier">NestedAtomically</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>    </span><span class="hs-identifier">ExitCode</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>    </span><span class="hs-identifier">BlockedOnDeadMVar</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>    </span><span class="hs-identifier">BlockedIndefinitely</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>    </span><span class="hs-identifier">Deadlock</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>    </span><span class="hs-identifier">NoMethodError</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>    </span><span class="hs-identifier">PatternMatchFail</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>    </span><span class="hs-identifier">RecConError</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>    </span><span class="hs-identifier">RecSelError</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>    </span><span class="hs-identifier">RecUpdError</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>    </span><span class="hs-identifier">ErrorCall</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span>    </span><span class="hs-comment">-- * Throwing exceptions</span><span>
</span><a name="line-50"></a><span>    </span><span class="hs-identifier">throwIO</span><span class="hs-special">,</span><span>
</span><a name="line-51"></a><span>    </span><span class="hs-identifier">throw</span><span class="hs-special">,</span><span>
</span><a name="line-52"></a><span>    </span><span class="hs-identifier">ioError</span><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>    </span><span class="hs-identifier">throwTo</span><span class="hs-special">,</span><span>
</span><a name="line-54"></a><span>    </span><span class="hs-comment">-- * Catching Exceptions</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span>    </span><span class="hs-comment">-- |There are several functions for catching and examining</span><span>
</span><a name="line-57"></a><span>    </span><span class="hs-comment">-- exceptions; all of them may only be used from within the</span><span>
</span><a name="line-58"></a><span>    </span><span class="hs-comment">-- 'IO' monad.</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span>    </span><span class="hs-comment">-- ** The @catch@ functions</span><span>
</span><a name="line-61"></a><span>    </span><span class="hs-identifier">catch</span><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- :: IO a -&gt; (Exception -&gt; IO a) -&gt; IO a</span><span>
</span><a name="line-62"></a><span>    </span><span class="hs-identifier">catches</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Handler</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-63"></a><span>    </span><span class="hs-identifier">catchJust</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- :: (Exception -&gt; Maybe b) -&gt; IO a -&gt; (b -&gt; IO a) -&gt; IO a</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span>    </span><span class="hs-comment">-- ** The @handle@ functions</span><span>
</span><a name="line-66"></a><span>    </span><span class="hs-identifier">handle</span><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- :: (Exception -&gt; IO a) -&gt; IO a -&gt; IO a</span><span>
</span><a name="line-67"></a><span>    </span><span class="hs-identifier">handleJust</span><span class="hs-special">,</span><span class="hs-comment">-- :: (Exception -&gt; Maybe b) -&gt; (b -&gt; IO a) -&gt; IO a -&gt; IO a</span><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span>    </span><span class="hs-comment">-- ** The @try@ functions</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-identifier">try</span><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- :: IO a -&gt; IO (Either Exception a)</span><span>
</span><a name="line-71"></a><span>    </span><span class="hs-identifier">tryJust</span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- :: (Exception -&gt; Maybe b) -&gt; a    -&gt; IO (Either b a)</span><span>
</span><a name="line-72"></a><span>    </span><span class="hs-identifier">onException</span><span class="hs-special">,</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span>    </span><span class="hs-comment">-- ** The @evaluate@ function</span><span>
</span><a name="line-75"></a><span>    </span><span class="hs-identifier">E.evaluate</span><span class="hs-special">,</span><span>  </span><span class="hs-comment">-- :: a -&gt; IO a</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span>    </span><span class="hs-comment">-- ** The @mapException@ function</span><span>
</span><a name="line-78"></a><span>    </span><span class="hs-identifier">mapException</span><span class="hs-special">,</span><span>           </span><span class="hs-comment">-- :: (Exception -&gt; Exception) -&gt; a -&gt; a</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span>    </span><span class="hs-comment">-- * Asynchronous Exceptions</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span>    </span><span class="hs-comment">-- $async</span><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span>    </span><span class="hs-comment">-- ** Asynchronous exception control</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span>    </span><span class="hs-comment">-- |The following two functions allow a thread to control delivery of</span><span>
</span><a name="line-87"></a><span>    </span><span class="hs-comment">-- asynchronous exceptions during a critical region.</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span>    </span><span class="hs-identifier">E.block</span><span class="hs-special">,</span><span>
</span><a name="line-90"></a><span>    </span><span class="hs-identifier">E.unblock</span><span class="hs-special">,</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span>    </span><span class="hs-comment">-- *** Applying @block@ to an exception handler</span><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span>    </span><span class="hs-comment">-- $block_handler</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span>    </span><span class="hs-comment">-- *** Interruptible operations</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span>    </span><span class="hs-comment">-- $interruptible</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span>    </span><span class="hs-comment">-- * Assertions</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span>    </span><span class="hs-identifier">assert</span><span class="hs-special">,</span><span>
</span><a name="line-103"></a><span>
</span><a name="line-104"></a><span>    </span><span class="hs-comment">-- * Utilities</span><span>
</span><a name="line-105"></a><span>    </span><span class="hs-identifier">bracket</span><span class="hs-special">,</span><span>
</span><a name="line-106"></a><span>    </span><span class="hs-identifier">bracket_</span><span class="hs-special">,</span><span>
</span><a name="line-107"></a><span>    </span><span class="hs-identifier">bracketOnError</span><span class="hs-special">,</span><span>
</span><a name="line-108"></a><span>    </span><span class="hs-identifier">finally</span><span>
</span><a name="line-109"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">catch</span><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control.Concurrent</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">throwTo</span><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control.Exception</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">E</span><span>
</span><a name="line-114"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Dynamic</span><span>
</span><a name="line-115"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Typeable</span><span>
</span><a name="line-116"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.Exit</span><span>
</span><a name="line-117"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.IO.Unsafe</span><span class="hs-special">(</span><span class="hs-identifier">unsafePerformIO</span><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-120"></a><span>    </span><span class="hs-identifier">toException</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">SomeException</span><span>
</span><a name="line-121"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">e</span><span>
</span><a name="line-122"></a><span>
</span><a name="line-123"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">SomeException</span><span>
</span><a name="line-124"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">e</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span>
</span><a name="line-127"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-130"></a><span>    </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">e</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-133"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-identifier">se</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">se</span><span>
</span><a name="line-134"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Just</span><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span class="hs-identifier">mkOldException</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">E.Exception</span><span>
</span><a name="line-137"></a><span class="hs-identifier">mkOldException</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">e'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toException</span><span> </span><span class="hs-identifier">e</span><span>
</span><a name="line-138"></a><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-identifier">e'</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-139"></a><span>             </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">e''</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- If the exception is actually a legacy exception</span><span>
</span><a name="line-140"></a><span>                         </span><span class="hs-comment">-- then throw it directly so the legacy functions</span><span>
</span><a name="line-141"></a><span>                         </span><span class="hs-comment">-- catch it as they expect</span><span>
</span><a name="line-142"></a><span>                         </span><span class="hs-identifier">e''</span><span>
</span><a name="line-143"></a><span>             </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-comment">-- Otherwise, throw it as a dynamic</span><span>
</span><a name="line-144"></a><span>                        </span><span class="hs-identifier">E.DynException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">toDyn</span><span> </span><span class="hs-identifier">e'</span><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-identifier">throw</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-147"></a><span class="hs-identifier">throw</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">E.throw</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkOldException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-identifier">throwIO</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-150"></a><span class="hs-identifier">throwIO</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">E.throwIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkOldException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-identifier">throwTo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">ThreadId</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span class="hs-identifier">throwTo</span><span> </span><span class="hs-identifier">tid</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">E.throwTo</span><span> </span><span class="hs-identifier">tid</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkOldException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-156"></a><span class="hs-comment">-- Catching exceptions</span><span>
</span><a name="line-157"></a><span>
</span><a name="line-158"></a><span class="hs-comment">-- |This is the simplest of the exception-catching functions.  It</span><span>
</span><a name="line-159"></a><span class="hs-comment">-- takes a single argument, runs it, and if an exception is raised</span><span>
</span><a name="line-160"></a><span class="hs-comment">-- the \&quot;handler\&quot; is executed, with the value of the exception passed as an</span><span>
</span><a name="line-161"></a><span class="hs-comment">-- argument.  Otherwise, the result is returned as normal.  For example:</span><span>
</span><a name="line-162"></a><span class="hs-comment">--</span><span>
</span><a name="line-163"></a><span class="hs-comment">-- &gt;   catch (openFile f ReadMode)</span><span>
</span><a name="line-164"></a><span class="hs-comment">-- &gt;       (\e -&gt; hPutStr stderr (&quot;Couldn't open &quot;++f++&quot;: &quot; ++ show e))</span><span>
</span><a name="line-165"></a><span class="hs-comment">--</span><span>
</span><a name="line-166"></a><span class="hs-comment">-- For catching exceptions in pure (non-'IO') expressions, see the</span><span>
</span><a name="line-167"></a><span class="hs-comment">-- function 'evaluate'.</span><span>
</span><a name="line-168"></a><span class="hs-comment">--</span><span>
</span><a name="line-169"></a><span class="hs-comment">-- Note that due to Haskell\'s unspecified evaluation order, an</span><span>
</span><a name="line-170"></a><span class="hs-comment">-- expression may return one of several possible exceptions: consider</span><span>
</span><a name="line-171"></a><span class="hs-comment">-- the expression @error \&quot;urk\&quot; + 1 \`div\` 0@.  Does</span><span>
</span><a name="line-172"></a><span class="hs-comment">-- 'catch' execute the handler passing</span><span>
</span><a name="line-173"></a><span class="hs-comment">-- @ErrorCall \&quot;urk\&quot;@, or @ArithError DivideByZero@?</span><span>
</span><a name="line-174"></a><span class="hs-comment">--</span><span>
</span><a name="line-175"></a><span class="hs-comment">-- The answer is \&quot;either\&quot;: 'catch' makes a</span><span>
</span><a name="line-176"></a><span class="hs-comment">-- non-deterministic choice about which exception to catch.  If you</span><span>
</span><a name="line-177"></a><span class="hs-comment">-- call it again, you might get a different exception back.  This is</span><span>
</span><a name="line-178"></a><span class="hs-comment">-- ok, because 'catch' is an 'IO' computation.</span><span>
</span><a name="line-179"></a><span class="hs-comment">--</span><span>
</span><a name="line-180"></a><span class="hs-comment">-- Note that 'catch' catches all types of exceptions, and is generally</span><span>
</span><a name="line-181"></a><span class="hs-comment">-- used for \&quot;cleaning up\&quot; before passing on the exception using</span><span>
</span><a name="line-182"></a><span class="hs-comment">-- 'throwIO'.  It is not good practice to discard the exception and</span><span>
</span><a name="line-183"></a><span class="hs-comment">-- continue, without first checking the type of the exception (it</span><span>
</span><a name="line-184"></a><span class="hs-comment">-- might be a 'ThreadKilled', for example).  In this case it is usually better</span><span>
</span><a name="line-185"></a><span class="hs-comment">-- to use 'catchJust' and select the kinds of exceptions to catch.</span><span>
</span><a name="line-186"></a><span class="hs-comment">--</span><span>
</span><a name="line-187"></a><span class="hs-comment">-- Also note that the &quot;Prelude&quot; also exports a function called</span><span>
</span><a name="line-188"></a><span class="hs-comment">-- 'Prelude.catch' with a similar type to 'Control.Exception.catch',</span><span>
</span><a name="line-189"></a><span class="hs-comment">-- except that the &quot;Prelude&quot; version only catches the IO and user</span><span>
</span><a name="line-190"></a><span class="hs-comment">-- families of exceptions (as required by Haskell 98).</span><span>
</span><a name="line-191"></a><span class="hs-comment">--</span><span>
</span><a name="line-192"></a><span class="hs-comment">-- We recommend either hiding the &quot;Prelude&quot; version of 'Prelude.catch'</span><span>
</span><a name="line-193"></a><span class="hs-comment">-- when importing &quot;Control.Exception&quot;:</span><span>
</span><a name="line-194"></a><span class="hs-comment">--</span><span>
</span><a name="line-195"></a><span class="hs-comment">-- &gt; import Prelude hiding (catch)</span><span>
</span><a name="line-196"></a><span class="hs-comment">--</span><span>
</span><a name="line-197"></a><span class="hs-comment">-- or importing &quot;Control.Exception&quot; qualified, to avoid name-clashes:</span><span>
</span><a name="line-198"></a><span class="hs-comment">--</span><span>
</span><a name="line-199"></a><span class="hs-comment">-- &gt; import qualified Control.Exception as C</span><span>
</span><a name="line-200"></a><span class="hs-comment">--</span><span>
</span><a name="line-201"></a><span class="hs-comment">-- and then using @C.catch@</span><span>
</span><a name="line-202"></a><span class="hs-comment">--</span><span>
</span><a name="line-203"></a><span class="hs-identifier">catch</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">e</span><span>
</span><a name="line-204"></a><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span>         </span><span class="hs-comment">-- ^ The computation to run</span><span>
</span><a name="line-205"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Handler to invoke if an exception is raised</span><span>
</span><a name="line-206"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-207"></a><span class="hs-identifier">catch</span><span> </span><span class="hs-identifier">io</span><span> </span><span class="hs-identifier">poly_handler</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">io</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">E.catch</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">handler'</span><span>
</span><a name="line-208"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-209"></a><span>          </span><span class="hs-comment">-- First look for &quot;new style&quot; exceptions, which are thrown</span><span>
</span><a name="line-210"></a><span>          </span><span class="hs-comment">-- as E.DynException (SomeException e)</span><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span>          </span><span class="hs-comment">-- needs scoped TVs: handler' :: E.Exception -&gt; IO a          </span><span>
</span><a name="line-213"></a><span>          </span><span class="hs-identifier">handler'</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-214"></a><span>                           </span><span class="hs-identifier">E.DynException</span><span> </span><span class="hs-identifier">dyn</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-215"></a><span>                               </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">fromDynamic</span><span> </span><span class="hs-identifier">dyn</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-216"></a><span>                               </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">se</span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-217"></a><span>                                   </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-identifier">se</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-218"></a><span>                                     </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">e'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">poly_handler</span><span> </span><span class="hs-identifier">e'</span><span>
</span><a name="line-219"></a><span>                                     </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">E.throw</span><span> </span><span class="hs-identifier">e</span><span>
</span><a name="line-220"></a><span>                               </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">try_old</span><span> </span><span class="hs-identifier">e</span><span>
</span><a name="line-221"></a><span>                           </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">try_old</span><span> </span><span class="hs-identifier">e</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span>          </span><span class="hs-comment">-- If it's a legacy exception (E.Exception or one of the</span><span>
</span><a name="line-224"></a><span>          </span><span class="hs-comment">-- types that make up E.Exception), check for a handler than</span><span>
</span><a name="line-225"></a><span>          </span><span class="hs-comment">-- can handle them:</span><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span>          </span><span class="hs-comment">-- needs scoped TVs: try_old :: E.Exception -&gt; IO a</span><span>
</span><a name="line-228"></a><span>          </span><span class="hs-identifier">try_old</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">toException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-229"></a><span>                       </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">e'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">poly_handler</span><span> </span><span class="hs-identifier">e'</span><span>
</span><a name="line-230"></a><span>                       </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">E.throw</span><span> </span><span class="hs-identifier">e</span><span>
</span><a name="line-231"></a><span>
</span><a name="line-232"></a><span>
</span><a name="line-233"></a><span class="hs-comment">-- | When you want to acquire a resource, do some work with it, and</span><span>
</span><a name="line-234"></a><span class="hs-comment">-- then release the resource, it is a good idea to use 'bracket',</span><span>
</span><a name="line-235"></a><span class="hs-comment">-- because 'bracket' will install the necessary exception handler to</span><span>
</span><a name="line-236"></a><span class="hs-comment">-- release the resource in the event that an exception is raised</span><span>
</span><a name="line-237"></a><span class="hs-comment">-- during the computation.  If an exception is raised, then 'bracket' will</span><span>
</span><a name="line-238"></a><span class="hs-comment">-- re-raise the exception (after performing the release).</span><span>
</span><a name="line-239"></a><span class="hs-comment">--</span><span>
</span><a name="line-240"></a><span class="hs-comment">-- A common example is opening a file:</span><span>
</span><a name="line-241"></a><span class="hs-comment">--</span><span>
</span><a name="line-242"></a><span class="hs-comment">-- &gt; bracket</span><span>
</span><a name="line-243"></a><span class="hs-comment">-- &gt;   (openFile &quot;filename&quot; ReadMode)</span><span>
</span><a name="line-244"></a><span class="hs-comment">-- &gt;   (hClose)</span><span>
</span><a name="line-245"></a><span class="hs-comment">-- &gt;   (\handle -&gt; do { ... })</span><span>
</span><a name="line-246"></a><span class="hs-comment">--</span><span>
</span><a name="line-247"></a><span class="hs-comment">-- The arguments to 'bracket' are in this order so that we can partially apply</span><span>
</span><a name="line-248"></a><span class="hs-comment">-- it, e.g.:</span><span>
</span><a name="line-249"></a><span class="hs-comment">--</span><span>
</span><a name="line-250"></a><span class="hs-comment">-- &gt; withFile name mode = bracket (openFile name mode) hClose</span><span>
</span><a name="line-251"></a><span class="hs-comment">--</span><span>
</span><a name="line-252"></a><span class="hs-identifier">bracket</span><span>
</span><a name="line-253"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span>         </span><span class="hs-comment">-- ^ computation to run first (\&quot;acquire resource\&quot;)</span><span>
</span><a name="line-254"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ computation to run last (\&quot;release resource\&quot;)</span><span>
</span><a name="line-255"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ computation to run in-between</span><span>
</span><a name="line-256"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">c</span><span>         </span><span class="hs-comment">-- returns the value from the in-between computation</span><span>
</span><a name="line-257"></a><span class="hs-identifier">bracket</span><span> </span><span class="hs-identifier">before</span><span> </span><span class="hs-identifier">after</span><span> </span><span class="hs-identifier">thing</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-258"></a><span>  </span><span class="hs-identifier">E.block</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><a name="line-259"></a><span>    </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">before</span><span>
</span><a name="line-260"></a><span>    </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">E.unblock</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">thing</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">onException</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">after</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-261"></a><span>    </span><span class="hs-identifier">after</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-262"></a><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-263"></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span class="hs-identifier">onException</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-266"></a><span class="hs-identifier">onException</span><span> </span><span class="hs-identifier">io</span><span> </span><span class="hs-identifier">what</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">io</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">catch</span><span class="hs-special">`</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">what</span><span>
</span><a name="line-267"></a><span>                                          </span><span class="hs-identifier">throw</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">SomeException</span><span class="hs-special">)</span><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span class="hs-identifier">block</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">unblock</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-270"></a><span class="hs-identifier">block</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">E.block</span><span>
</span><a name="line-271"></a><span class="hs-identifier">unblock</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">E.unblock</span><span>
</span><a name="line-272"></a><span>
</span><a name="line-273"></a><span class="hs-comment">-- | A specialised variant of 'bracket' with just a computation to run</span><span>
</span><a name="line-274"></a><span class="hs-comment">-- afterward.</span><span>
</span><a name="line-275"></a><span class="hs-comment">--</span><span>
</span><a name="line-276"></a><span class="hs-identifier">finally</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span>         </span><span class="hs-comment">-- ^ computation to run first</span><span>
</span><a name="line-277"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">b</span><span>         </span><span class="hs-comment">-- ^ computation to run afterward (even if an exception</span><span>
</span><a name="line-278"></a><span>                        </span><span class="hs-comment">-- was raised)</span><span>
</span><a name="line-279"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span>         </span><span class="hs-comment">-- returns the value from the first computation</span><span>
</span><a name="line-280"></a><span class="hs-identifier">a</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">finally</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">sequel</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-281"></a><span>  </span><span class="hs-identifier">E.block</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><a name="line-282"></a><span>    </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">E.unblock</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">onException</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">sequel</span><span>
</span><a name="line-283"></a><span>    </span><span class="hs-identifier">sequel</span><span>
</span><a name="line-284"></a><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-285"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><span class="hs-comment">-- | A variant of 'bracket' where the return value from the first computation</span><span>
</span><a name="line-288"></a><span class="hs-comment">-- is not required.</span><span>
</span><a name="line-289"></a><span class="hs-identifier">bracket_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">c</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">c</span><span>
</span><a name="line-290"></a><span class="hs-identifier">bracket_</span><span> </span><span class="hs-identifier">before</span><span> </span><span class="hs-identifier">after</span><span> </span><span class="hs-identifier">thing</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">bracket</span><span> </span><span class="hs-identifier">before</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">const</span><span> </span><span class="hs-identifier">after</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">const</span><span> </span><span class="hs-identifier">thing</span><span class="hs-special">)</span><span>
</span><a name="line-291"></a><span>
</span><a name="line-292"></a><span class="hs-comment">-- | Like bracket, but only performs the final action if there was an</span><span>
</span><a name="line-293"></a><span class="hs-comment">-- exception raised by the in-between computation.</span><span>
</span><a name="line-294"></a><span class="hs-identifier">bracketOnError</span><span>
</span><a name="line-295"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span>         </span><span class="hs-comment">-- ^ computation to run first (\&quot;acquire resource\&quot;)</span><span>
</span><a name="line-296"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ computation to run last (\&quot;release resource\&quot;)</span><span>
</span><a name="line-297"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">c</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ computation to run in-between</span><span>
</span><a name="line-298"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">c</span><span>         </span><span class="hs-comment">-- returns the value from the in-between computation</span><span>
</span><a name="line-299"></a><span class="hs-identifier">bracketOnError</span><span> </span><span class="hs-identifier">before</span><span> </span><span class="hs-identifier">after</span><span> </span><span class="hs-identifier">thing</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-300"></a><span>  </span><span class="hs-identifier">block</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><a name="line-301"></a><span>    </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">before</span><span>
</span><a name="line-302"></a><span>    </span><span class="hs-identifier">unblock</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">thing</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">onException</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">after</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-303"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span class="hs-identifier">assert</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Bool</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-306"></a><span class="hs-identifier">assert</span><span> </span><span class="hs-identifier">True</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">x</span><span>
</span><a name="line-307"></a><span class="hs-identifier">assert</span><span> </span><span class="hs-identifier">False</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">throw</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AssertionFailed</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-308"></a><span>
</span><a name="line-309"></a><span class="hs-comment">-- | The function 'catchJust' is like 'catch', but it takes an extra</span><span>
</span><a name="line-310"></a><span class="hs-comment">-- argument which is an /exception predicate/, a function which</span><span>
</span><a name="line-311"></a><span class="hs-comment">-- selects which type of exceptions we\'re interested in.</span><span>
</span><a name="line-312"></a><span class="hs-comment">--</span><span>
</span><a name="line-313"></a><span class="hs-comment">-- &gt;   result &lt;- catchJust errorCalls thing_to_try handler</span><span>
</span><a name="line-314"></a><span class="hs-comment">--</span><span>
</span><a name="line-315"></a><span class="hs-comment">-- Any other exceptions which are not matched by the predicate</span><span>
</span><a name="line-316"></a><span class="hs-comment">-- are re-raised, and may be caught by an enclosing</span><span>
</span><a name="line-317"></a><span class="hs-comment">-- 'catch' or 'catchJust'.</span><span>
</span><a name="line-318"></a><span class="hs-identifier">catchJust</span><span>
</span><a name="line-319"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">e</span><span>
</span><a name="line-320"></a><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>         </span><span class="hs-comment">-- ^ Predicate to select exceptions</span><span>
</span><a name="line-321"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span>                   </span><span class="hs-comment">-- ^ Computation to run</span><span>
</span><a name="line-322"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>            </span><span class="hs-comment">-- ^ Handler</span><span>
</span><a name="line-323"></a><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-324"></a><span class="hs-identifier">catchJust</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">handler</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">catch</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-identifier">handler'</span><span>
</span><a name="line-325"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">handler'</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-326"></a><span>                        </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">throw</span><span> </span><span class="hs-identifier">e</span><span>
</span><a name="line-327"></a><span>                        </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">b</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">handler</span><span> </span><span class="hs-identifier">b</span><span>
</span><a name="line-328"></a><span>
</span><a name="line-329"></a><span class="hs-comment">-- | A version of 'catch' with the arguments swapped around; useful in</span><span>
</span><a name="line-330"></a><span class="hs-comment">-- situations where the code for the handler is shorter.  For example:</span><span>
</span><a name="line-331"></a><span class="hs-comment">--</span><span>
</span><a name="line-332"></a><span class="hs-comment">-- &gt;   do handle (\e -&gt; exitWith (ExitFailure 1)) $</span><span>
</span><a name="line-333"></a><span class="hs-comment">-- &gt;      ...</span><span>
</span><a name="line-334"></a><span class="hs-identifier">handle</span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-335"></a><span class="hs-identifier">handle</span><span>     </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">flip</span><span> </span><span class="hs-identifier">catch</span><span>
</span><a name="line-336"></a><span>
</span><a name="line-337"></a><span class="hs-comment">-- | A version of 'catchJust' with the arguments swapped around (see</span><span>
</span><a name="line-338"></a><span class="hs-comment">-- 'handle').</span><span>
</span><a name="line-339"></a><span class="hs-identifier">handleJust</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">b</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-340"></a><span class="hs-identifier">handleJust</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier">flip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">catchJust</span><span> </span><span class="hs-identifier">p</span><span class="hs-special">)</span><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-343"></a><span class="hs-comment">-- 'mapException'</span><span>
</span><a name="line-344"></a><span>
</span><a name="line-345"></a><span class="hs-comment">-- | This function maps one exception into another as proposed in the</span><span>
</span><a name="line-346"></a><span class="hs-comment">-- paper \&quot;A semantics for imprecise exceptions\&quot;.</span><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span class="hs-comment">-- Notice that the usage of 'unsafePerformIO' is safe here.</span><span>
</span><a name="line-349"></a><span>
</span><a name="line-350"></a><span class="hs-identifier">mapException</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">e1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">e2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">e1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">e2</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-351"></a><span class="hs-identifier">mapException</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unsafePerformIO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">catch</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.evaluate</span><span> </span><span class="hs-identifier">v</span><span class="hs-special">)</span><span>
</span><a name="line-352"></a><span>                                          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">x</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">throw</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">f</span><span> </span><span class="hs-identifier">x</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-353"></a><span>
</span><a name="line-354"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-355"></a><span class="hs-comment">-- 'try' and variations.</span><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span class="hs-comment">-- | Similar to 'catch', but returns an 'Either' result which is</span><span>
</span><a name="line-358"></a><span class="hs-comment">-- @('Right' a)@ if no exception was raised, or @('Left' e)@ if an</span><span>
</span><a name="line-359"></a><span class="hs-comment">-- exception was raised and its value is @e@.</span><span>
</span><a name="line-360"></a><span class="hs-comment">--</span><span>
</span><a name="line-361"></a><span class="hs-comment">-- &gt;  try a = catch (Right `liftM` a) (return . Left)</span><span>
</span><a name="line-362"></a><span class="hs-comment">--</span><span>
</span><a name="line-363"></a><span class="hs-comment">-- Note: as with 'catch', it is only polite to use this variant if you intend</span><span>
</span><a name="line-364"></a><span class="hs-comment">-- to re-throw the exception after performing whatever cleanup is needed.</span><span>
</span><a name="line-365"></a><span class="hs-comment">-- Otherwise, 'tryJust' is generally considered to be better.</span><span>
</span><a name="line-366"></a><span class="hs-comment">--</span><span>
</span><a name="line-367"></a><span class="hs-comment">-- Also note that &quot;System.IO.Error&quot; also exports a function called</span><span>
</span><a name="line-368"></a><span class="hs-comment">-- 'System.IO.Error.try' with a similar type to 'Control.Exception.try',</span><span>
</span><a name="line-369"></a><span class="hs-comment">-- except that it catches only the IO and user families of exceptions</span><span>
</span><a name="line-370"></a><span class="hs-comment">-- (as required by the Haskell 98 @IO@ module).</span><span>
</span><a name="line-371"></a><span>
</span><a name="line-372"></a><span class="hs-identifier">try</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Either</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-373"></a><span class="hs-identifier">try</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">catch</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-operator">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Right</span><span> </span><span class="hs-identifier">v</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Left</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-374"></a><span>
</span><a name="line-375"></a><span class="hs-comment">-- | A variant of 'try' that takes an exception predicate to select</span><span>
</span><a name="line-376"></a><span class="hs-comment">-- which exceptions are caught (c.f. 'catchJust').  If the exception</span><span>
</span><a name="line-377"></a><span class="hs-comment">-- does not match the predicate, it is re-thrown.</span><span>
</span><a name="line-378"></a><span class="hs-identifier">tryJust</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Either</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-379"></a><span class="hs-identifier">tryJust</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-380"></a><span>  </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">try</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-381"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-382"></a><span>        </span><span class="hs-identifier">Right</span><span> </span><span class="hs-identifier">v</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Right</span><span> </span><span class="hs-identifier">v</span><span class="hs-special">)</span><span>
</span><a name="line-383"></a><span>        </span><span class="hs-identifier">Left</span><span>  </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-384"></a><span>                        </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">throw</span><span> </span><span class="hs-identifier">e</span><span>
</span><a name="line-385"></a><span>                        </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">b</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Left</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><a name="line-386"></a><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span class="hs-comment">-------------</span><span>
</span><a name="line-389"></a><span>
</span><a name="line-390"></a><span>
</span><a name="line-391"></a><span>
</span><a name="line-392"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Handler</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier">Handler</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">)</span><span>
</span><a name="line-393"></a><span>
</span><a name="line-394"></a><span class="hs-identifier">catches</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Handler</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-395"></a><span class="hs-identifier">catches</span><span> </span><span class="hs-identifier">io</span><span> </span><span class="hs-identifier">handlers</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">io</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">catch</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">catchesHandler</span><span> </span><span class="hs-identifier">handlers</span><span>
</span><a name="line-396"></a><span>
</span><a name="line-397"></a><span class="hs-identifier">catchesHandler</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Handler</span><span> </span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">a</span><span>
</span><a name="line-398"></a><span class="hs-identifier">catchesHandler</span><span> </span><span class="hs-identifier">handlers</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">foldr</span><span> </span><span class="hs-identifier">tryHandler</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">throw</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">handlers</span><span>
</span><a name="line-399"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">tryHandler</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Handler</span><span> </span><span class="hs-identifier">handler</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">res</span><span>
</span><a name="line-400"></a><span>              </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-401"></a><span>                </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">e'</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">handler</span><span> </span><span class="hs-identifier">e'</span><span>
</span><a name="line-402"></a><span>                </span><span class="hs-identifier">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">res</span><span>
</span><a name="line-403"></a><span>
</span><a name="line-404"></a><span>
</span><a name="line-405"></a><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><a name="line-406"></a><span class="hs-comment">-- Asynchronous exceptions</span><span>
</span><a name="line-407"></a><span>
</span><a name="line-408"></a><span class="hs-comment">{- $async

 #AsynchronousExceptions# Asynchronous exceptions are so-called because they arise due to
external influences, and can be raised at any point during execution.
'StackOverflow' and 'HeapOverflow' are two examples of
system-generated asynchronous exceptions.

The primary source of asynchronous exceptions, however, is
'throwTo':

&gt;  throwTo :: ThreadId -&gt; Exception -&gt; IO ()

'throwTo' (also 'throwDynTo' and 'Control.Concurrent.killThread') allows one
running thread to raise an arbitrary exception in another thread.  The
exception is therefore asynchronous with respect to the target thread,
which could be doing anything at the time it receives the exception.
Great care should be taken with asynchronous exceptions; it is all too
easy to introduce race conditions by the over zealous use of
'throwTo'.
-}</span><span>
</span><a name="line-428"></a><span>
</span><a name="line-429"></a><span class="hs-comment">{- $block_handler
There\'s an implied 'block' around every exception handler in a call
to one of the 'catch' family of functions.  This is because that is
what you want most of the time - it eliminates a common race condition
in starting an exception handler, because there may be no exception
handler on the stack to handle another exception if one arrives
immediately.  If asynchronous exceptions are blocked on entering the
handler, though, we have time to install a new exception handler
before being interrupted.  If this weren\'t the default, one would have
to write something like

&gt;      block (
&gt;           catch (unblock (...))
&gt;                      (\e -&gt; handler)
&gt;      )

If you need to unblock asynchronous exceptions again in the exception
handler, just use 'unblock' as normal.

Note that 'try' and friends /do not/ have a similar default, because
there is no exception handler in this case.  If you want to use 'try'
in an asynchronous-exception-safe way, you will need to use
'block'.
-}</span><span>
</span><a name="line-453"></a><span>
</span><a name="line-454"></a><span class="hs-comment">{- $interruptible

Some operations are /interruptible/, which means that they can receive
asynchronous exceptions even in the scope of a 'block'.  Any function
which may itself block is defined as interruptible; this includes
'Control.Concurrent.MVar.takeMVar'
(but not 'Control.Concurrent.MVar.tryTakeMVar'),
and most operations which perform
some I\/O with the outside world.  The reason for having
interruptible operations is so that we can write things like

&gt;      block (
&gt;         a &lt;- takeMVar m
&gt;         catch (unblock (...))
&gt;               (\e -&gt; ...)
&gt;      )

if the 'Control.Concurrent.MVar.takeMVar' was not interruptible,
then this particular
combination could lead to deadlock, because the thread itself would be
blocked in a state where it can\'t receive any asynchronous exceptions.
With 'Control.Concurrent.MVar.takeMVar' interruptible, however, we can be
safe in the knowledge that the thread can receive exceptions right up
until the point when the 'Control.Concurrent.MVar.takeMVar' succeeds.
Similar arguments apply for other interruptible operations like
'System.IO.openFile'.
-}</span><span>
</span><a name="line-481"></a><span>
</span><a name="line-482"></a><span>
</span><a name="line-483"></a><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><a name="line-484"></a><span class="hs-comment">-- Exception instance for the legacy Exception type</span><span>
</span><a name="line-485"></a><span>
</span><a name="line-486"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">E.Exception</span><span>
</span><a name="line-487"></a><span>
</span><a name="line-488"></a><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><a name="line-489"></a><span class="hs-comment">-- The new Exception types. These need to map to/from E.Exception so</span><span>
</span><a name="line-490"></a><span class="hs-comment">-- that uses of legacy catch/throw functions work.</span><span>
</span><a name="line-491"></a><span>
</span><a name="line-492"></a><span class="hs-comment">----</span><span>
</span><a name="line-493"></a><span>
</span><a name="line-494"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">E.ArithException</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-495"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-identifier">ae</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.ArithException</span><span> </span><span class="hs-identifier">ae</span><span class="hs-special">)</span><span>
</span><a name="line-496"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-497"></a><span>                                      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.ArithException</span><span> </span><span class="hs-identifier">ae</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-498"></a><span>                                         </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">ae</span><span>
</span><a name="line-499"></a><span>                                      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-500"></a><span class="hs-comment">----</span><span>
</span><a name="line-501"></a><span>
</span><a name="line-502"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">E.ArrayException</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-503"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-identifier">ae</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.ArrayException</span><span> </span><span class="hs-identifier">ae</span><span class="hs-special">)</span><span>
</span><a name="line-504"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-505"></a><span>                                      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.ArrayException</span><span> </span><span class="hs-identifier">ae</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-506"></a><span>                                          </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">ae</span><span>
</span><a name="line-507"></a><span>                                      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-508"></a><span>
</span><a name="line-509"></a><span class="hs-comment">----</span><span>
</span><a name="line-510"></a><span>
</span><a name="line-511"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">AssertionFailed</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">AssertionFailed</span><span> </span><span class="hs-identifier">String</span><span>
</span><a name="line-512"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-513"></a><span>
</span><a name="line-514"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">AssertionFailed</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-515"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AssertionFailed</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.AssertionFailed</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span>
</span><a name="line-516"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-517"></a><span>                                      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.AssertionFailed</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-518"></a><span>                                          </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AssertionFailed</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span>
</span><a name="line-519"></a><span>                                      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-520"></a><span>
</span><a name="line-521"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">AssertionFailed</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-522"></a><span>    </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">AssertionFailed</span><span> </span><span class="hs-identifier">err</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showString</span><span> </span><span class="hs-identifier">err</span><span>
</span><a name="line-523"></a><span>
</span><a name="line-524"></a><span class="hs-comment">-----</span><span>
</span><a name="line-525"></a><span>
</span><a name="line-526"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">E.AsyncException</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-527"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-identifier">ae</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.AsyncException</span><span> </span><span class="hs-identifier">ae</span><span class="hs-special">)</span><span>
</span><a name="line-528"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-529"></a><span>                                      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.AsyncException</span><span> </span><span class="hs-identifier">ae</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-530"></a><span>                                          </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">ae</span><span>
</span><a name="line-531"></a><span>                                      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-532"></a><span>
</span><a name="line-533"></a><span class="hs-comment">----</span><span>
</span><a name="line-534"></a><span>
</span><a name="line-535"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">BlockedOnDeadMVar</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">BlockedOnDeadMVar</span><span>
</span><a name="line-536"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-537"></a><span>
</span><a name="line-538"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">BlockedOnDeadMVar</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-539"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-identifier">BlockedOnDeadMVar</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.BlockedOnDeadMVar</span><span class="hs-special">)</span><span>
</span><a name="line-540"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-541"></a><span>                                      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">E.BlockedOnDeadMVar</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-542"></a><span>                                          </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">BlockedOnDeadMVar</span><span>
</span><a name="line-543"></a><span>                                      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-544"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">BlockedOnDeadMVar</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-545"></a><span>    </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">BlockedOnDeadMVar</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">E.BlockedOnDeadMVar</span><span>
</span><a name="line-546"></a><span>
</span><a name="line-547"></a><span class="hs-comment">----</span><span>
</span><a name="line-548"></a><span>
</span><a name="line-549"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">BlockedIndefinitely</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">BlockedIndefinitely</span><span>
</span><a name="line-550"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-551"></a><span>
</span><a name="line-552"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">BlockedIndefinitely</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-553"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-identifier">BlockedIndefinitely</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toException</span><span> </span><span class="hs-identifier">E.BlockedIndefinitely</span><span>
</span><a name="line-554"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-555"></a><span>                                      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">E.BlockedIndefinitely</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-556"></a><span>                                          </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">BlockedIndefinitely</span><span>
</span><a name="line-557"></a><span>                                      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-558"></a><span>
</span><a name="line-559"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">BlockedIndefinitely</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-560"></a><span>    </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">BlockedIndefinitely</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">E.BlockedIndefinitely</span><span>
</span><a name="line-561"></a><span>
</span><a name="line-562"></a><span class="hs-comment">----</span><span>
</span><a name="line-563"></a><span>
</span><a name="line-564"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">NestedAtomically</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">NestedAtomically</span><span>
</span><a name="line-565"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-566"></a><span>
</span><a name="line-567"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">NestedAtomically</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-568"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-identifier">NestedAtomically</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toException</span><span> </span><span class="hs-identifier">E.NestedAtomically</span><span>
</span><a name="line-569"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-570"></a><span>                                    </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">E.NestedAtomically</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-571"></a><span>                                        </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">NestedAtomically</span><span>
</span><a name="line-572"></a><span>                                    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-573"></a><span>
</span><a name="line-574"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">NestedAtomically</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-575"></a><span>    </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">NestedAtomically</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">E.NestedAtomically</span><span>
</span><a name="line-576"></a><span>
</span><a name="line-577"></a><span class="hs-comment">----</span><span>
</span><a name="line-578"></a><span>
</span><a name="line-579"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">Deadlock</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">Deadlock</span><span>
</span><a name="line-580"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-581"></a><span>
</span><a name="line-582"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">Deadlock</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-583"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-identifier">Deadlock</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toException</span><span> </span><span class="hs-identifier">E.Deadlock</span><span>
</span><a name="line-584"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-585"></a><span>                                      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">E.Deadlock</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-586"></a><span>                                          </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">Deadlock</span><span>
</span><a name="line-587"></a><span>                                      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-588"></a><span>
</span><a name="line-589"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">Deadlock</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-590"></a><span>    </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">Deadlock</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">E.Deadlock</span><span>
</span><a name="line-591"></a><span>
</span><a name="line-592"></a><span class="hs-comment">-----</span><span>
</span><a name="line-593"></a><span>
</span><a name="line-594"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">ErrorCall</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ErrorCall</span><span> </span><span class="hs-identifier">String</span><span>
</span><a name="line-595"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-596"></a><span>
</span><a name="line-597"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">ErrorCall</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-598"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ErrorCall</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.ErrorCall</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span>
</span><a name="line-599"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-600"></a><span>                                      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.ErrorCall</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-601"></a><span>                                          </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ErrorCall</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span>
</span><a name="line-602"></a><span>                                      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-603"></a><span>
</span><a name="line-604"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">ErrorCall</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-605"></a><span>    </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">ErrorCall</span><span> </span><span class="hs-identifier">err</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showString</span><span> </span><span class="hs-identifier">err</span><span>
</span><a name="line-606"></a><span>
</span><a name="line-607"></a><span class="hs-comment">-----</span><span>
</span><a name="line-608"></a><span>
</span><a name="line-609"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Typeable</span><span> </span><span class="hs-identifier">ExitCode</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-610"></a><span>    </span><span class="hs-identifier">typeOf</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">mkTyConApp</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkTyCon</span><span> </span><span class="hs-string">&quot;ExitCode&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-611"></a><span>
</span><a name="line-612"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">ExitCode</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-613"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-identifier">ee</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.ExitException</span><span> </span><span class="hs-identifier">ee</span><span class="hs-special">)</span><span>
</span><a name="line-614"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-615"></a><span>                                      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.ExitException</span><span> </span><span class="hs-identifier">ee</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-616"></a><span>                                          </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">ee</span><span>
</span><a name="line-617"></a><span>                                      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-618"></a><span class="hs-comment">-----</span><span>
</span><a name="line-619"></a><span>
</span><a name="line-620"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">E.IOException</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-621"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-identifier">ioe</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.IOException</span><span> </span><span class="hs-identifier">ioe</span><span class="hs-special">)</span><span>
</span><a name="line-622"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-623"></a><span>                                      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.IOException</span><span> </span><span class="hs-identifier">ioe</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-624"></a><span>                                          </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">ioe</span><span>
</span><a name="line-625"></a><span>                                      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-626"></a><span>
</span><a name="line-627"></a><span class="hs-comment">----</span><span>
</span><a name="line-628"></a><span>
</span><a name="line-629"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">NoMethodError</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">NoMethodError</span><span> </span><span class="hs-identifier">String</span><span>
</span><a name="line-630"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-631"></a><span>
</span><a name="line-632"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">NoMethodError</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-633"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NoMethodError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.NoMethodError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span>
</span><a name="line-634"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-635"></a><span>                                      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.NoMethodError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-636"></a><span>                                          </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NoMethodError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span>
</span><a name="line-637"></a><span>                                      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-638"></a><span>
</span><a name="line-639"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">NoMethodError</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-640"></a><span>    </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NoMethodError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showString</span><span> </span><span class="hs-identifier">str</span><span>
</span><a name="line-641"></a><span>
</span><a name="line-642"></a><span class="hs-comment">----</span><span>
</span><a name="line-643"></a><span>
</span><a name="line-644"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">NonTermination</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">NonTermination</span><span>
</span><a name="line-645"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-646"></a><span>
</span><a name="line-647"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">NonTermination</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-648"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-identifier">NonTermination</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toException</span><span> </span><span class="hs-identifier">E.NonTermination</span><span>
</span><a name="line-649"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-650"></a><span>                                      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">E.NonTermination</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-651"></a><span>                                          </span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">NonTermination</span><span>
</span><a name="line-652"></a><span>                                      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-653"></a><span>
</span><a name="line-654"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">NonTermination</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-655"></a><span>    </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">NonTermination</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">n</span><span> </span><span class="hs-identifier">E.NonTermination</span><span>
</span><a name="line-656"></a><span>
</span><a name="line-657"></a><span class="hs-comment">----</span><span>
</span><a name="line-658"></a><span>
</span><a name="line-659"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">PatternMatchFail</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">PatternMatchFail</span><span> </span><span class="hs-identifier">String</span><span>
</span><a name="line-660"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-661"></a><span>
</span><a name="line-662"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">PatternMatchFail</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-663"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PatternMatchFail</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.PatternMatchFail</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span>
</span><a name="line-664"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-665"></a><span>                                      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.PatternMatchFail</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-666"></a><span>                                          </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PatternMatchFail</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span>
</span><a name="line-667"></a><span>                                      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-668"></a><span>
</span><a name="line-669"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">PatternMatchFail</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-670"></a><span>    </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">PatternMatchFail</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showString</span><span> </span><span class="hs-identifier">str</span><span>
</span><a name="line-671"></a><span>
</span><a name="line-672"></a><span>
</span><a name="line-673"></a><span class="hs-comment">----</span><span>
</span><a name="line-674"></a><span>
</span><a name="line-675"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">RecConError</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">RecConError</span><span> </span><span class="hs-identifier">String</span><span>
</span><a name="line-676"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-677"></a><span>
</span><a name="line-678"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">RecConError</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-679"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RecConError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.RecConError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span>
</span><a name="line-680"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-681"></a><span>                                      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.RecConError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-682"></a><span>                                          </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RecConError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span>
</span><a name="line-683"></a><span>                                      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-684"></a><span>
</span><a name="line-685"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">RecConError</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-686"></a><span>    </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RecConError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showString</span><span> </span><span class="hs-identifier">str</span><span>
</span><a name="line-687"></a><span>
</span><a name="line-688"></a><span>
</span><a name="line-689"></a><span>
</span><a name="line-690"></a><span class="hs-comment">----</span><span>
</span><a name="line-691"></a><span>
</span><a name="line-692"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">RecSelError</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">RecSelError</span><span> </span><span class="hs-identifier">String</span><span>
</span><a name="line-693"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-694"></a><span>
</span><a name="line-695"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">RecSelError</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-696"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RecSelError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.RecSelError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span>
</span><a name="line-697"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-698"></a><span>                                      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.RecSelError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-699"></a><span>                                          </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RecSelError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span>
</span><a name="line-700"></a><span>                                      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-701"></a><span>
</span><a name="line-702"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">RecSelError</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-703"></a><span>    </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RecSelError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showString</span><span> </span><span class="hs-identifier">str</span><span>
</span><a name="line-704"></a><span>
</span><a name="line-705"></a><span class="hs-comment">----</span><span>
</span><a name="line-706"></a><span>
</span><a name="line-707"></a><span class="hs-keyword">data</span><span> </span><span class="hs-identifier">RecUpdError</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">RecUpdError</span><span> </span><span class="hs-identifier">String</span><span>
</span><a name="line-708"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier">Typeable</span><span>
</span><a name="line-709"></a><span>
</span><a name="line-710"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Exception</span><span> </span><span class="hs-identifier">RecUpdError</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-711"></a><span>    </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RecUpdError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.RecUpdError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span>
</span><a name="line-712"></a><span>    </span><span class="hs-identifier">fromException</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">SomeException</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">cast</span><span> </span><span class="hs-identifier">e</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-713"></a><span>                                      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">E.RecUpdError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-714"></a><span>                                          </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RecUpdError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span>
</span><a name="line-715"></a><span>                                      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><a name="line-716"></a><span>
</span><a name="line-717"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier">Show</span><span> </span><span class="hs-identifier">RecUpdError</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-718"></a><span>    </span><span class="hs-identifier">showsPrec</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">RecUpdError</span><span> </span><span class="hs-identifier">str</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">showString</span><span> </span><span class="hs-identifier">str</span><span>
</span><a name="line-719"></a><span>
</span><a name="line-720"></a><span>
</span><a name="line-721"></a><span class="hs-cpp">#endif
</span><span>
</span><a name="line-723"></a></pre></body></html>